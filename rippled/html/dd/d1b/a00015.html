<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>rippled: Bootstrap Strategy</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">rippled
   &#160;<span id="projectnumber">0.24.0-rc1</span>
   </div>
   <div id="projectbrief">Reference implementation of the Ripple Protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dd/d1b/a00015.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Bootstrap Strategy </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Fresh endpoints are ones we have seen recently via mtENDPOINTS. These are best to give out to someone who needs additional connections as quickly as possible, since it is very likely that the fresh endpoints have open incoming slots.</p>
<p>Reliable endpoints are ones which are highly likely to be connectible over long periods of time. They might not necessarily have an incoming slot, but they are good for bootstrapping when there are no peers yet. Typically these are what we would want to store in a database or local config file for a future launch.</p>
<p>Nouns: </p>
<pre class="fragment">bootstrap_ip
    numeric IPAddress

bootstrap_domain
    domain name / port combinations, resolution only

bootstrap_url
    URL leading to a text file, with a series of entries.

ripple.txt
    Separately parsed entity outside of PeerFinder that can provide
    bootstrap_ip, bootstrap_domain, and bootstrap_url items.
</pre><p>The process of obtaining the initial peer connections for accessing the Ripple peer to peer network, when there are no current connections, is called "bootstrapping." The algorithm is as follows:</p>
<ol type="1">
<li>If ( unusedLiveEndpoints.count() &gt; 0 OR activeConnectionAttempts.count() &gt; 0) Try addresses from unusedLiveEndpoints return;</li>
<li>If ( domainNames.count() &gt; 0 AND ( unusedBootstrapIPs.count() == 0 OR activeNameResolutions.count() &gt; 0) ) ForOneOrMore (DomainName that hasn't been resolved recently) Contact DomainName and add entries to the unusedBootstrapIPs return;</li>
<li>If (unusedBootstrapIPs.count() &gt; 0) Try addresses from unusedBootstrapIPs return;</li>
<li>Try entries from [ips]</li>
<li>Try entries from [ips_urls]</li>
<li>Increment generation number and go to 1<ul>
<li>Keep a map of all current outgoing connection attempts</li>
</ul>
</li>
</ol>
<h2>"Connection Strategy" </h2>
<p>This is the overall strategy a peer uses to maintain its position in the Ripple network graph</p>
<p>We define these values: </p>
<pre class="fragment">peerCount (calculated)
    The number of currently connected and established peers

outCount (calculated)
    The number of peers in PeerCount that are outbound connections.

MinOutCount (hard-coded constant)
    The minimum number of OutCount we want. This also puts a floor
    on PeerCount. This protects against sybil attacks and makes
    sure that ledgers can get retrieved reliably.
    10 is the proposed value.

MaxPeerCount (a constant set in the rippled.cfg)
    The maximum number of peer connections, inbound or outbound,
    that a peer wishes to maintain. Setting MaxPeerCount equal to
    or below MinOutCount would disallow incoming connections.

OutPercent (a baked-in program constant for now)
    The peer's target value for OutCount. When the value of OutCount
    is below this number, the peer will employ the Outgoing Strategy
    to raise its value of OutCount. This value is initially a constant
    in the program, defined by the developers. However, it
    may be changed through the consensus process.
    15% is a proposed value.
</pre><p>However, lets consider the case where OutDesired is exactly equal to MaxPeerCount / 2. In this case, a stable state will be reached when every peer is full, and has exactly the same number of inbound and outbound connections. The problem here is that there are now no available incoming connection slots. No new peers can enter the network.</p>
<p>Lets consider the case where OutDesired is exactly equal to (MaxPeerCount / 2) - 1. The stable state for this network (assuming all peers can accept incoming) will leave us with network degree equal to MaxPeerCount - 2, with all peers having two available incoming connection slots. The global number of incoming connection slots will be equal to twice the number of nodes on the network. While this might seem to be a desirable outcome, note that the connectedness (degree of the overlay) plays a large part in determining the levels of traffic and ability to receive validations from desired nodes. Having every node with available incoming connections also means that entries in pong caches will continually fall out with new values and information will become less useful.</p>
<p>For this reason, we advise that the value of OutDesired be fractional. Upon startup, a node will use its node ID (its 160 bit unique ID) to decide whether to round the value of OutDesired up or down. Using this method, we can precisely control the global number of available incoming connection slots.</p>
<h2>"Outgoing Strategy" </h2>
<p>This is the method a peer uses to establish outgoing connections into the Ripple network.</p>
<p>A peer whose PeerCount is zero will use these steps:</p>
<ol type="1">
<li>Attempt addresses from a local database of addresses</li>
<li>Attempt addresses from a set of "well known" domains in rippled.cfg</li>
</ol>
<p>This is the method used by a peer that is already connected to the Ripple network, to adjust the number of outgoing connections it is maintaining.</p>
<h2>"Incoming Strategy" </h2>
<p>This is the method used by a peer to announce its ability and desire to receive incoming connections both for the purpose of obtaining additional peer connections and also for receiving requests from clients. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri May 2 2014 05:29:01 for rippled by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
