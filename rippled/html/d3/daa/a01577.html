<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>rippled: rocksdb::StressTest Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">rippled
   &#160;<span id="projectnumber">0.24.0-rc1</span>
   </div>
   <div id="projectbrief">Reference implementation of the Ripple Protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d3/daa/a01577.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../da/d48/a08878.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">rocksdb::StressTest Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for rocksdb::StressTest:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d83/a08879.png" border="0" usemap="#rocksdb_1_1_stress_test_coll__map" alt="Collaboration graph"/></div>
<map name="rocksdb_1_1_stress_test_coll__map" id="rocksdb_1_1_stress_test_coll__map">
<area shape="rect" id="node4" href="../../dd/de9/a00552.html" title="rocksdb::FilterPolicy" alt="" coords="164,75,305,104"/><area shape="rect" id="node6" href="../../d0/d7d/a01419.html" title="rocksdb::SliceTransform" alt="" coords="153,128,316,157"/><area shape="rect" id="node8" href="../../d8/ddd/a00380.html" title="rocksdb::DB" alt="" coords="7,219,100,248"/><area shape="rect" id="node10" href="../../d7/d03/a01491.html" title="rocksdb::StackableDB" alt="" coords="159,288,311,317"/></map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a777cab43ac4430c8add29fe3f058a13a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a777cab43ac4430c8add29fe3f058a13a">StressTest</a> ()</td></tr>
<tr class="separator:a777cab43ac4430c8add29fe3f058a13a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57bad075e6d23b77af7c22821ee83e1d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a57bad075e6d23b77af7c22821ee83e1d">~StressTest</a> ()</td></tr>
<tr class="separator:a57bad075e6d23b77af7c22821ee83e1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7e726bf27e216787e7c331834ec6075"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#af7e726bf27e216787e7c331834ec6075">Run</a> ()</td></tr>
<tr class="separator:af7e726bf27e216787e7c331834ec6075"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a2bdd8a9595b621c43bb200a88383ce14"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db9/a01552.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a2bdd8a9595b621c43bb200a88383ce14">MultiPut</a> (<a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *thread, const <a class="el" href="../../da/d4b/a01848.html">WriteOptions</a> &amp;writeoptions, const <a class="el" href="../../de/daf/a01417.html">Slice</a> &amp;key, const <a class="el" href="../../de/daf/a01417.html">Slice</a> &amp;<a class="el" href="../../d5/d95/a02720.html#a0f61d63b009d0880a89c843bd50d8d76">value</a>, size_t sz)</td></tr>
<tr class="separator:a2bdd8a9595b621c43bb200a88383ce14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66ead39d0fcb2a275ade836e56c3f7f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db9/a01552.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a66ead39d0fcb2a275ade836e56c3f7f1">MultiDelete</a> (<a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *thread, const <a class="el" href="../../da/d4b/a01848.html">WriteOptions</a> &amp;writeoptions, const <a class="el" href="../../de/daf/a01417.html">Slice</a> &amp;key)</td></tr>
<tr class="separator:a66ead39d0fcb2a275ade836e56c3f7f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b6a25d452fda380f8ece74068bdcf76"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db9/a01552.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a0b6a25d452fda380f8ece74068bdcf76">MultiGet</a> (<a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *thread, const <a class="el" href="../../da/d3f/a01215.html">ReadOptions</a> &amp;readoptions, const <a class="el" href="../../de/daf/a01417.html">Slice</a> &amp;key, std::string *<a class="el" href="../../d5/d95/a02720.html#a0f61d63b009d0880a89c843bd50d8d76">value</a>)</td></tr>
<tr class="separator:a0b6a25d452fda380f8ece74068bdcf76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ef3595857efa0c84b56dd69ac220abe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db9/a01552.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a2ef3595857efa0c84b56dd69ac220abe">MultiPrefixScan</a> (<a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *thread, const <a class="el" href="../../da/d3f/a01215.html">ReadOptions</a> &amp;readoptions, const <a class="el" href="../../de/daf/a01417.html">Slice</a> &amp;prefix)</td></tr>
<tr class="separator:a2ef3595857efa0c84b56dd69ac220abe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc885688cb75cceb53fcf6c0eccfa956"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db9/a01552.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#adc885688cb75cceb53fcf6c0eccfa956">MultiIterate</a> (<a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *thread, const <a class="el" href="../../da/d3f/a01215.html">ReadOptions</a> &amp;readoptions, const <a class="el" href="../../de/daf/a01417.html">Slice</a> &amp;key)</td></tr>
<tr class="separator:adc885688cb75cceb53fcf6c0eccfa956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af55a36a036e7348d3442400c050df2ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#af55a36a036e7348d3442400c050df2ee">OperateDb</a> (<a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *thread)</td></tr>
<tr class="separator:af55a36a036e7348d3442400c050df2ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6de00ffdf29abe06157c824d53060f84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a6de00ffdf29abe06157c824d53060f84">VerifyDb</a> (<a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *thread) const </td></tr>
<tr class="separator:a6de00ffdf29abe06157c824d53060f84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7de186dfcaa8d7d09adc0661a9d685e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a7de186dfcaa8d7d09adc0661a9d685e7">VerificationAbort</a> (std::string msg, long key) const </td></tr>
<tr class="separator:a7de186dfcaa8d7d09adc0661a9d685e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa92ae3301b0fccf66dfc272634c09a4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#aa92ae3301b0fccf66dfc272634c09a4d">VerifyValue</a> (long key, const <a class="el" href="../../da/d3f/a01215.html">ReadOptions</a> &amp;opts, const <a class="el" href="../../d5/d8e/a01390.html">SharedState</a> &amp;<a class="el" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>, const std::string &amp;value_from_db, <a class="el" href="../../d0/db9/a01552.html">Status</a> s, bool strict=false) const </td></tr>
<tr class="separator:aa92ae3301b0fccf66dfc272634c09a4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e528c3bd9f2a38f3e3e83e51d1cb9ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a9e528c3bd9f2a38f3e3e83e51d1cb9ea">PrintEnv</a> () const </td></tr>
<tr class="separator:a9e528c3bd9f2a38f3e3e83e51d1cb9ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd8a7f61f0b14b85acd87a4d77a6e394"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#abd8a7f61f0b14b85acd87a4d77a6e394">Open</a> ()</td></tr>
<tr class="separator:abd8a7f61f0b14b85acd87a4d77a6e394"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac9f55bde5a11da0fcc2c88465de0c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#aeac9f55bde5a11da0fcc2c88465de0c6">Reopen</a> ()</td></tr>
<tr class="separator:aeac9f55bde5a11da0fcc2c88465de0c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84f4aa2eb69053e5e7332d3d27fa9742"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a84f4aa2eb69053e5e7332d3d27fa9742">PrintStatistics</a> ()</td></tr>
<tr class="separator:a84f4aa2eb69053e5e7332d3d27fa9742"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:ad15a841e44071e594e280bebb7045d08"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#ad15a841e44071e594e280bebb7045d08">ThreadBody</a> (void *v)</td></tr>
<tr class="separator:ad15a841e44071e594e280bebb7045d08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f06d21c3db820737ee52e79cc320896"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a2f06d21c3db820737ee52e79cc320896">PrintKeyValue</a> (<a class="el" href="../../db/d86/a02663.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> key, const char *<a class="el" href="../../d5/d95/a02720.html#a0f61d63b009d0880a89c843bd50d8d76">value</a>, size_t sz)</td></tr>
<tr class="separator:a2f06d21c3db820737ee52e79cc320896"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a1d745ffde52899ed449cfc8eb5c177"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a3a1d745ffde52899ed449cfc8eb5c177">GenerateValue</a> (<a class="el" href="../../db/d86/a02663.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="../../d6/d50/a02694.html#a2391b9dab13f09bae65ae349c8d4c271">rand</a>, char *v, size_t max_sz)</td></tr>
<tr class="separator:a3a1d745ffde52899ed449cfc8eb5c177"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aaf65c1865167c51f2243f5db7afbeac2"><td class="memItemLeft" align="right" valign="top">shared_ptr&lt; <a class="el" href="../../d4/d9a/a00246.html">Cache</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#aaf65c1865167c51f2243f5db7afbeac2">cache_</a></td></tr>
<tr class="separator:aaf65c1865167c51f2243f5db7afbeac2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad11df1e28fafa7a1c8a83eb3a0ac8430"><td class="memItemLeft" align="right" valign="top">shared_ptr&lt; <a class="el" href="../../d4/d9a/a00246.html">Cache</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#ad11df1e28fafa7a1c8a83eb3a0ac8430">compressed_cache_</a></td></tr>
<tr class="separator:ad11df1e28fafa7a1c8a83eb3a0ac8430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2fa51ee1d1aeee82f60d94773decf5d"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../dd/de9/a00552.html">FilterPolicy</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#af2fa51ee1d1aeee82f60d94773decf5d">filter_policy_</a></td></tr>
<tr class="separator:af2fa51ee1d1aeee82f60d94773decf5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997c0fe78e2af6cbb86f71a3c2b0a3ae"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d0/d7d/a01419.html">SliceTransform</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a997c0fe78e2af6cbb86f71a3c2b0a3ae">prefix_extractor_</a></td></tr>
<tr class="separator:a997c0fe78e2af6cbb86f71a3c2b0a3ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c94ae9cdf0828a5212a6949514eaf1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/ddd/a00380.html">DB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a></td></tr>
<tr class="separator:a2c94ae9cdf0828a5212a6949514eaf1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bc0db0055b9a7059c2c42ac478e2713"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d03/a01491.html">StackableDB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a8bc0db0055b9a7059c2c42ac478e2713">sdb_</a></td></tr>
<tr class="separator:a8bc0db0055b9a7059c2c42ac478e2713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92d72a91fe1e5e44c9914d60d6318719"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/a01577.html#a92d72a91fe1e5e44c9914d60d6318719">num_times_reopened_</a></td></tr>
<tr class="separator:a92d72a91fe1e5e44c9914d60d6318719"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l00678">678</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a777cab43ac4430c8add29fe3f058a13a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">rocksdb::StressTest::StressTest </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l00680">680</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../db/db1/a00460.html#a0d75747a2a64c041d106b85202848fe8">rocksdb::Env::DeleteFile()</a>, <a class="el" href="../../db/d44/a02564_source.html#l03524">rocksdb::DestroyDB()</a>, <a class="el" href="../../db/db1/a00460.html#aebd6a4aac30704da29fecf45a9da21d6">rocksdb::Env::GetChildren()</a>, and <a class="el" href="../../dd/d75/a02639_source.html#l00093">rocksdb::Slice::starts_with()</a>.</p>
<div class="fragment"><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      : <a class="code" href="../../d3/daa/a01577.html#aaf65c1865167c51f2243f5db7afbeac2">cache_</a>(<a class="code" href="../../d4/d87/a03436.html#a35a0923808914c8ecd0c78fc5d36fc31">NewLRUCache</a>(FLAGS_cache_size)),</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <a class="code" href="../../d3/daa/a01577.html#ad11df1e28fafa7a1c8a83eb3a0ac8430">compressed_cache_</a>(FLAGS_compressed_cache_size &gt;= 0 ?</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                          <a class="code" href="../../d4/d87/a03436.html#a35a0923808914c8ecd0c78fc5d36fc31">NewLRUCache</a>(FLAGS_compressed_cache_size) :</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                          <span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <a class="code" href="../../d3/daa/a01577.html#af2fa51ee1d1aeee82f60d94773decf5d">filter_policy_</a>(FLAGS_bloom_bits &gt;= 0</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                       ? <a class="code" href="../../d4/d87/a03436.html#ac1e4f201260f0ef566953a6817cfe713">NewBloomFilterPolicy</a>(FLAGS_bloom_bits)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                       : <span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <a class="code" href="../../d3/daa/a01577.html#a997c0fe78e2af6cbb86f71a3c2b0a3ae">prefix_extractor_</a>(<a class="code" href="../../d4/d87/a03436.html#a827f732f23df3c1faf2427a0288b40a4">NewFixedPrefixTransform</a>(</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                          FLAGS_test_batches_snapshots ?</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                          <span class="keyword">sizeof</span>(<span class="keywordtype">long</span>) : <span class="keyword">sizeof</span>(<span class="keywordtype">long</span>)-1)),</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <a class="code" href="../../d3/daa/a01577.html#a92d72a91fe1e5e44c9914d60d6318719">num_times_reopened_</a>(0) {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">if</span> (FLAGS_destroy_db_initially) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      std::vector&lt;std::string&gt; files;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <a class="code" href="../../d6/d50/a02694.html#a1217d1ecddbf658a860dcc8d313b2381">FLAGS_env</a>-&gt;<a class="code" href="../../db/db1/a00460.html#aebd6a4aac30704da29fecf45a9da21d6">GetChildren</a>(FLAGS_db, &amp;files);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; files.size(); i++) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keywordflow">if</span> (Slice(files[i]).starts_with(<span class="stringliteral">&quot;heap-&quot;</span>)) {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;          <a class="code" href="../../d6/d50/a02694.html#a1217d1ecddbf658a860dcc8d313b2381">FLAGS_env</a>-&gt;<a class="code" href="../../db/db1/a00460.html#a0d75747a2a64c041d106b85202848fe8">DeleteFile</a>(FLAGS_db + <span class="stringliteral">&quot;/&quot;</span> + files[i]);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <a class="code" href="../../d4/d87/a03436.html#a06a3e5fcc25436293e1177a93061b889">DestroyDB</a>(FLAGS_db, Options());</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a777cab43ac4430c8add29fe3f058a13a_cgraph.png" border="0" usemap="#d3/daa/a01577_a777cab43ac4430c8add29fe3f058a13a_cgraph" alt=""/></div>
<map name="d3/daa/a01577_a777cab43ac4430c8add29fe3f058a13a_cgraph" id="d3/daa/a01577_a777cab43ac4430c8add29fe3f058a13a_cgraph">
<area shape="rect" id="node3" href="../../db/db1/a00460.html#a0d75747a2a64c041d106b85202848fe8" title="rocksdb::Env::DeleteFile" alt="" coords="389,95,555,124"/><area shape="rect" id="node5" href="../../d4/d87/a03436.html#a06a3e5fcc25436293e1177a93061b889" title="rocksdb::DestroyDB" alt="" coords="195,651,336,680"/><area shape="rect" id="node12" href="../../db/db1/a00460.html#aebd6a4aac30704da29fecf45a9da21d6" title="rocksdb::Env::GetChildren" alt="" coords="384,148,560,177"/><area shape="rect" id="node37" href="../../de/daf/a01417.html#a5b27053d7804f8ba4a6430e001ce1c22" title="rocksdb::Slice::starts_with" alt="" coords="633,5,809,35"/><area shape="rect" id="node7" href="../../d4/d87/a03436.html#a546d3e2e5c3b4aa8ee9828c7b519d501" title="rocksdb::ArchivalDirectory" alt="" coords="384,784,560,813"/><area shape="rect" id="node9" href="../../db/db1/a00460.html#a4dc62f49ff743af36746fb9c49edadda" title="rocksdb::Env::DeleteDir" alt="" coords="391,837,553,867"/><area shape="rect" id="node14" href="../../db/db1/a00460.html#a680d05d86580d65e4c1cfe16dd099385" title="rocksdb::Env::LockFile" alt="" coords="395,891,549,920"/><area shape="rect" id="node16" href="../../d4/d87/a03436.html#a820e85c65a3dad99ec67d4414c1b8ccb" title="rocksdb::LockFileName" alt="" coords="392,944,552,973"/><area shape="rect" id="node18" href="../../d0/db9/a01552.html#aceb84d55ae3b6bccf2a925433ca1ae00" title="rocksdb::Status::OK" alt="" coords="401,677,543,707"/><area shape="rect" id="node22" href="../../d0/db9/a01552.html#a63cba37f62403ccc2f3e8b0b8ee04425" title="rocksdb::Status::ok" alt="" coords="919,675,1055,704"/><area shape="rect" id="node24" href="../../d4/d87/a03436.html#ad3fcb7354969b5ea357d56b2d02362fc" title="rocksdb::ParseFileName" alt="" coords="389,201,555,231"/><area shape="rect" id="node39" href="../../d4/d87/a03436.html#abff772f829522cce816cd5540350b445" title="rocksdb::SanitizeOptions" alt="" coords="388,520,556,549"/><area shape="rect" id="node72" href="../../db/db1/a00460.html#a802631b298800f1ee47b75f3d8c9594d" title="rocksdb::Env::UnlockFile" alt="" coords="388,731,556,760"/><area shape="rect" id="node20" href="../../d0/db9/a01552.html#afcc875b53756534a635212b3d8f43864" title="rocksdb::Status::Status" alt="" coords="641,731,801,760"/><area shape="rect" id="node26" href="../../d4/d87/a03436.html#a7d0cd6e6e390a2d44d90571ec29cd8f5" title="rocksdb::ConsumeDecimalNumber" alt="" coords="608,161,835,191"/><area shape="rect" id="node28" href="../../de/daf/a01417.html#a39ca9716c2bcda2ba2261d9c5f108121" title="rocksdb::Slice::empty" alt="" coords="912,109,1061,139"/><area shape="rect" id="node30" href="../../de/daf/a01417.html#ac03632091b9078ec551ffd58d3372f6b" title="rocksdb::Slice::remove\l_prefix" alt="" coords="909,162,1064,209"/><area shape="rect" id="node32" href="../../de/daf/a01417.html#aeb3a4a3ede98a163cc3796ef0d4a759d" title="rocksdb::Slice::size" alt="" coords="1143,115,1279,144"/><area shape="rect" id="node41" href="../../d4/d87/a03436.html#af81d16f56b9066a68bf6315b35f1129f" title="rocksdb::ClipToRange" alt="" coords="645,627,797,656"/><area shape="rect" id="node43" href="../../d4/d87/a03436.html#abf1a86e8c774d69a4b96ef44c5ca19c0" title="rocksdb::CreateLoggerFrom\lOptions" alt="" coords="629,346,813,393"/><area shape="rect" id="node65" href="../../d4/d87/a03436.html#a437c68f3299fa632d4a1694059fd6ddb" title="rocksdb::Log" alt="" coords="673,467,769,496"/><area shape="rect" id="node67" href="../../d9/d9d/a03417.html#aa3091bec2c625018fadb6aefef12b9ff" title="ripple::min" alt="" coords="680,520,763,549"/><area shape="rect" id="node69" href="../../d4/d87/a03436.html#a35a0923808914c8ecd0c78fc5d36fc31" title="rocksdb::NewLRUCache" alt="" coords="637,573,805,603"/><area shape="rect" id="node45" href="../../db/db1/a00460.html#abb8c5907cacfd71bb223be17c4741a47" title="rocksdb::Env::CreateDir" alt="" coords="905,568,1068,597"/><area shape="rect" id="node47" href="../../db/db1/a00460.html#a85e9d22dff053a1ada591614b4ae2994" title="rocksdb::Env::GetAbsolutePath" alt="" coords="884,621,1089,651"/><area shape="rect" id="node49" href="../../d4/ddd/a00138.html#aead46bb2ddf6612f13d795d9567eeac8" title="rocksdb::AutoRollLogger\l::GetStatus" alt="" coords="904,231,1069,278"/><area shape="rect" id="node51" href="../../d4/d87/a03436.html#a66013ddb5a08a0535b9b77571ef21800" title="rocksdb::InfoLogFileName" alt="" coords="900,301,1073,331"/><area shape="rect" id="node55" href="../../db/db1/a00460.html#aa95f36590fd6a28f78fcd419fc3692c9" title="rocksdb::Env::NewLogger" alt="" coords="900,408,1073,437"/><area shape="rect" id="node57" href="../../db/db1/a00460.html#a20e69bbefe7d92b92a2f33100cf251b7" title="rocksdb::Env::NowMicros" alt="" coords="900,461,1073,491"/><area shape="rect" id="node60" href="../../d4/d87/a03436.html#adc2e965ec8cbd712595feeea5a662f7a" title="rocksdb::OldInfoLogFileName" alt="" coords="889,355,1084,384"/><area shape="rect" id="node63" href="../../db/db1/a00460.html#a8dc0848695f4b55193ee01ffb9ad24b8" title="rocksdb::Env::RenameFile" alt="" coords="899,515,1075,544"/><area shape="rect" id="node53" href="../../d4/d87/a03436.html#a6fee7f5c78b001613702bc29ad22e0df" title="rocksdb::FlattenPath" alt="" coords="1140,328,1281,357"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a57bad075e6d23b77af7c22821ee83e1d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">rocksdb::StressTest::~StressTest </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l00705">705</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../d6/d50/a02694_source.html#l01493">db_</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01491">filter_policy_</a>, and <a class="el" href="../../d6/d50/a02694_source.html#l01492">prefix_extractor_</a>.</p>
<div class="fragment"><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keyword">delete</span> <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keyword">delete</span> <a class="code" href="../../d3/daa/a01577.html#af2fa51ee1d1aeee82f60d94773decf5d">filter_policy_</a>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keyword">delete</span> <a class="code" href="../../d3/daa/a01577.html#a997c0fe78e2af6cbb86f71a3c2b0a3ae">prefix_extractor_</a>;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a3a1d745ffde52899ed449cfc8eb5c177"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t rocksdb::StressTest::GenerateValue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d86/a02663.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>rand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01271">1271</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../d6/d50/a02694_source.html#l00665">rand</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01042">OperateDb()</a>, and <a class="el" href="../../d6/d50/a02694_source.html#l01231">VerifyValue()</a>.</p>
<div class="fragment"><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                                                                     {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keywordtype">size_t</span> value_sz = ((<a class="code" href="../../d6/d50/a02694.html#a2391b9dab13f09bae65ae349c8d4c271">rand</a> % 3) + 1) * FLAGS_value_size_mult;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    assert(value_sz &lt;= max_sz &amp;&amp; value_sz &gt;= <span class="keyword">sizeof</span>(<a class="code" href="../../db/d86/a02663.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>));</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    *((<a class="code" href="../../db/d86/a02663.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>*)v) = <a class="code" href="../../d6/d50/a02694.html#a2391b9dab13f09bae65ae349c8d4c271">rand</a>;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=<span class="keyword">sizeof</span>(<a class="code" href="../../db/d86/a02663.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>); i &lt; value_sz; i++) {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      v[i] = (char)(<a class="code" href="../../d6/d50/a02694.html#a2391b9dab13f09bae65ae349c8d4c271">rand</a> ^ i);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    }</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    v[value_sz] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordflow">return</span> value_sz; <span class="comment">// the size of the value set.</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a3a1d745ffde52899ed449cfc8eb5c177_icgraph.png" border="0" usemap="#d3/daa/a01577_a3a1d745ffde52899ed449cfc8eb5c177_icgraph" alt=""/></div>
<map name="d3/daa/a01577_a3a1d745ffde52899ed449cfc8eb5c177_icgraph" id="d3/daa/a01577_a3a1d745ffde52899ed449cfc8eb5c177_icgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#af55a36a036e7348d3442400c050df2ee" title="rocksdb::StressTest\l::OperateDb" alt="" coords="385,5,524,51"/><area shape="rect" id="node5" href="../../d3/daa/a01577.html#aa92ae3301b0fccf66dfc272634c09a4d" title="rocksdb::StressTest\l::VerifyValue" alt="" coords="196,65,335,111"/><area shape="rect" id="node8" href="../../d3/daa/a01577.html#a6de00ffdf29abe06157c824d53060f84" title="rocksdb::StressTest\l::VerifyDb" alt="" coords="385,74,524,121"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a66ead39d0fcb2a275ade836e56c3f7f1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db9/a01552.html">Status</a> rocksdb::StressTest::MultiDelete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *&#160;</td>
          <td class="paramname"><em>thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d4b/a01848.html">WriteOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>writeoptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/daf/a01417.html">Slice</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l00856">856</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../d6/d50/a02694_source.html#l01493">db_</a>, <a class="el" href="../../d6/dca/a02616_source.html#l00156">rocksdb::WriteBatch::Delete()</a>, <a class="el" href="../../d5/d96/a02642_source.html#l00062">rocksdb::Status::ok()</a>, <a class="el" href="../../dd/d75/a02639_source.html#l00072">rocksdb::Slice::ToString()</a>, <a class="el" href="../../de/d8e/a02762_source.html#l00041">rocksdb::Status::ToString()</a>, and <a class="el" href="../../d8/ddd/a00380.html#ad5d37a09e90d0c22c9a0adca87267ebc">rocksdb::DB::Write()</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01042">OperateDb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                                       {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    std::string keys[10] = {<span class="stringliteral">&quot;9&quot;</span>, <span class="stringliteral">&quot;7&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>, <span class="stringliteral">&quot;3&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>,</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                            <span class="stringliteral">&quot;8&quot;</span>, <span class="stringliteral">&quot;6&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>};</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    WriteBatch batch;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="../../d9/d2c/a03421.html#af127c2e4fc73b5d35647147ef45b350c">Status</a> s;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      keys[i] += key.ToString();</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      batch.Delete(keys[i]);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    s = <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#ad5d37a09e90d0c22c9a0adca87267ebc">Write</a>(writeoptions, &amp;batch);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">if</span> (!s.ok()) {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;multidelete error: %s\n&quot;</span>, s.ToString().c_str());</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      thread-&gt;stats.AddErrors(1);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      thread-&gt;stats.AddDeletes(10);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">return</span> s;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a66ead39d0fcb2a275ade836e56c3f7f1_cgraph.png" border="0" usemap="#d3/daa/a01577_a66ead39d0fcb2a275ade836e56c3f7f1_cgraph" alt=""/></div>
<map name="d3/daa/a01577_a66ead39d0fcb2a275ade836e56c3f7f1_cgraph" id="d3/daa/a01577_a66ead39d0fcb2a275ade836e56c3f7f1_cgraph">
<area shape="rect" id="node3" href="../../d2/dbd/a01844.html#a17803ddbf9875d6b0bbac1b310ae3846" title="rocksdb::WriteBatch\l::Delete" alt="" coords="209,103,351,150"/><area shape="rect" id="node23" href="../../d0/db9/a01552.html#a63cba37f62403ccc2f3e8b0b8ee04425" title="rocksdb::Status::ok" alt="" coords="212,173,348,203"/><area shape="rect" id="node25" href="../../de/daf/a01417.html#ac5faa24d39a613c0ce7965d2bd9cf958" title="rocksdb::Slice::ToString" alt="" coords="199,227,361,256"/><area shape="rect" id="node27" href="../../d0/db9/a01552.html#ac02bdc6723705072a10111a99b4ca17c" title="rocksdb::Status::ToString" alt="" coords="195,280,365,309"/><area shape="rect" id="node31" href="../../d8/ddd/a00380.html#ad5d37a09e90d0c22c9a0adca87267ebc" title="rocksdb::DB::Write" alt="" coords="213,333,347,363"/><area shape="rect" id="node5" href="../../da/d8c/a01845.html#a3a404e8b1f29c53fc2d3b2a70dfb8478" title="rocksdb::WriteBatchInternal\l::Count" alt="" coords="413,15,597,62"/><area shape="rect" id="node9" href="../../d4/d87/a03436.html#af1cdcde94bcaeced42cd5925a5827232" title="rocksdb::PutLengthPrefixed\lSlice" alt="" coords="415,103,596,150"/><area shape="rect" id="node19" href="../../da/d8c/a01845.html#a5d61953d919f082c48c4d4aada512004" title="rocksdb::WriteBatchInternal\l::SetCount" alt="" coords="413,191,597,238"/><area shape="rect" id="node7" href="../../d4/d87/a03436.html#a5eb46c01bbc65cc301b2648e655dbe15" title="rocksdb::DecodeFixed32" alt="" coords="647,5,812,35"/><area shape="rect" id="node11" href="../../de/daf/a01417.html#abed770f35075076510897c3fbbc10923" title="rocksdb::Slice::data" alt="" coords="660,59,799,88"/><area shape="rect" id="node13" href="../../d4/d87/a03436.html#afe24fa7da1cd551af92134aa66f96183" title="rocksdb::PutVarint32" alt="" coords="657,112,801,141"/><area shape="rect" id="node17" href="../../de/daf/a01417.html#aeb3a4a3ede98a163cc3796ef0d4a759d" title="rocksdb::Slice::size" alt="" coords="661,165,797,195"/><area shape="rect" id="node15" href="../../d4/d87/a03436.html#a94c48680211f25845f5c35acd4b54ebb" title="rocksdb::EncodeVarint32" alt="" coords="861,112,1029,141"/><area shape="rect" id="node21" href="../../d4/d87/a03436.html#aabc7ce45ae48e15b24a6756f9b4fd694" title="rocksdb::EncodeFixed32" alt="" coords="647,219,812,248"/><area shape="rect" id="node29" href="../../d0/db9/a01552.html#a6679d2e36279094844a67acbb3cc3e5c" title="rocksdb::Status::code" alt="" coords="431,280,580,309"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a66ead39d0fcb2a275ade836e56c3f7f1_icgraph.png" border="0" usemap="#d3/daa/a01577_a66ead39d0fcb2a275ade836e56c3f7f1_icgraph" alt=""/></div>
<map name="d3/daa/a01577_a66ead39d0fcb2a275ade836e56c3f7f1_icgraph" id="d3/daa/a01577_a66ead39d0fcb2a275ade836e56c3f7f1_icgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#af55a36a036e7348d3442400c050df2ee" title="rocksdb::StressTest\l::OperateDb" alt="" coords="196,5,335,51"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0b6a25d452fda380f8ece74068bdcf76"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db9/a01552.html">Status</a> rocksdb::StressTest::MultiGet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *&#160;</td>
          <td class="paramname"><em>thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d3f/a01215.html">ReadOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>readoptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/daf/a01417.html">Slice</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l00884">884</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../d6/d50/a02694_source.html#l01493">db_</a>, <a class="el" href="../../d8/ddd/a00380.html#ae6350a924ad1ac1129726e384a487da3">rocksdb::DB::Get()</a>, <a class="el" href="../../d8/ddd/a00380.html#a09ad7c62dfe7e8739732d37041d058f9">rocksdb::DB::GetSnapshot()</a>, <a class="el" href="../../d5/d96/a02642_source.html#l00065">rocksdb::Status::IsNotFound()</a>, <a class="el" href="../../d5/d96/a02642_source.html#l00062">rocksdb::Status::ok()</a>, <a class="el" href="../../d8/ddd/a00380.html#aedefaa4497eb584a45a818c0f05aff9b">rocksdb::DB::ReleaseSnapshot()</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00663">rocksdb::ReadOptions::snapshot</a>, <a class="el" href="../../dd/d75/a02639_source.html#l00072">rocksdb::Slice::ToString()</a>, <a class="el" href="../../de/d8e/a02762_source.html#l00041">rocksdb::Status::ToString()</a>, and <a class="el" href="../../d6/dfc/a02612_source.html#l00288">value</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01042">OperateDb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                                                      {</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    std::string keys[10] = {<span class="stringliteral">&quot;0&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>, <span class="stringliteral">&quot;3&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>, <span class="stringliteral">&quot;6&quot;</span>, <span class="stringliteral">&quot;7&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>, <span class="stringliteral">&quot;9&quot;</span>};</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    Slice key_slices[10];</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    std::string values[10];</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    ReadOptions readoptionscopy = readoptions;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    readoptionscopy.snapshot = <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#a09ad7c62dfe7e8739732d37041d058f9">GetSnapshot</a>();</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <a class="code" href="../../d9/d2c/a03421.html#af127c2e4fc73b5d35647147ef45b350c">Status</a> s;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      keys[i] += key.ToString();</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      key_slices[i] = keys[i];</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      s = <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#ae6350a924ad1ac1129726e384a487da3">Get</a>(readoptionscopy, key_slices[i], <a class="code" href="../../d6/dfc/a02612.html#a38c8b88c432e666ad10b0c5573e1160a">value</a>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <span class="keywordflow">if</span> (!s.ok() &amp;&amp; !s.IsNotFound()) {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;get error: %s\n&quot;</span>, s.ToString().c_str());</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        values[i] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        thread-&gt;stats.AddErrors(1);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="comment">// we continue after error rather than exiting so that we can</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="comment">// find more errors if any</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (s.IsNotFound()) {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        values[i] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        thread-&gt;stats.AddGets(1, 0);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        values[i] = *<a class="code" href="../../d6/dfc/a02612.html#a38c8b88c432e666ad10b0c5573e1160a">value</a>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordtype">char</span> expected_prefix = (keys[i])[0];</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keywordtype">char</span> actual_prefix = (values[i])[0];</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">if</span> (actual_prefix != expected_prefix) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;error expected prefix = %c actual = %c\n&quot;</span>,</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                  expected_prefix, actual_prefix);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        (values[i])[0] = <span class="charliteral">&#39; &#39;</span>; <span class="comment">// blank out the differing character</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        thread-&gt;stats.AddGets(1, 1);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#aedefaa4497eb584a45a818c0f05aff9b">ReleaseSnapshot</a>(readoptionscopy.snapshot);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">// Now that we retrieved all values, check that they all match</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; 10; i++) {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keywordflow">if</span> (values[i] != values[0]) {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;error : inconsistent values for key %s: %s, %s\n&quot;</span>,</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                key.ToString().c_str(), values[0].c_str(),</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                values[i].c_str());</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="comment">// we continue after error rather than exiting so that we can</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="comment">// find more errors if any</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">return</span> s;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a0b6a25d452fda380f8ece74068bdcf76_cgraph.png" border="0" usemap="#d3/daa/a01577_a0b6a25d452fda380f8ece74068bdcf76_cgraph" alt=""/></div>
<map name="d3/daa/a01577_a0b6a25d452fda380f8ece74068bdcf76_cgraph" id="d3/daa/a01577_a0b6a25d452fda380f8ece74068bdcf76_cgraph">
<area shape="rect" id="node3" href="../../d8/ddd/a00380.html#ae6350a924ad1ac1129726e384a487da3" title="rocksdb::DB::Get" alt="" coords="237,5,360,35"/><area shape="rect" id="node5" href="../../d8/ddd/a00380.html#a09ad7c62dfe7e8739732d37041d058f9" title="rocksdb::DB::GetSnapshot" alt="" coords="209,59,388,88"/><area shape="rect" id="node7" href="../../d0/db9/a01552.html#ac6c469e9064f786f2adcc0a9ad328d8b" title="rocksdb::Status::IsNotFound" alt="" coords="204,112,393,141"/><area shape="rect" id="node11" href="../../d0/db9/a01552.html#a63cba37f62403ccc2f3e8b0b8ee04425" title="rocksdb::Status::ok" alt="" coords="231,165,367,195"/><area shape="rect" id="node13" href="../../d8/ddd/a00380.html#aedefaa4497eb584a45a818c0f05aff9b" title="rocksdb::DB::ReleaseSnapshot" alt="" coords="196,219,401,248"/><area shape="rect" id="node15" href="../../de/daf/a01417.html#ac5faa24d39a613c0ce7965d2bd9cf958" title="rocksdb::Slice::ToString" alt="" coords="217,272,380,301"/><area shape="rect" id="node17" href="../../d0/db9/a01552.html#ac02bdc6723705072a10111a99b4ca17c" title="rocksdb::Status::ToString" alt="" coords="213,325,384,355"/><area shape="rect" id="node9" href="../../d0/db9/a01552.html#a6679d2e36279094844a67acbb3cc3e5c" title="rocksdb::Status::code" alt="" coords="452,219,601,248"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a0b6a25d452fda380f8ece74068bdcf76_icgraph.png" border="0" usemap="#d3/daa/a01577_a0b6a25d452fda380f8ece74068bdcf76_icgraph" alt=""/></div>
<map name="d3/daa/a01577_a0b6a25d452fda380f8ece74068bdcf76_icgraph" id="d3/daa/a01577_a0b6a25d452fda380f8ece74068bdcf76_icgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#af55a36a036e7348d3442400c050df2ee" title="rocksdb::StressTest\l::OperateDb" alt="" coords="196,5,335,51"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adc885688cb75cceb53fcf6c0eccfa956"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db9/a01552.html">Status</a> rocksdb::StressTest::MultiIterate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *&#160;</td>
          <td class="paramname"><em>thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d3f/a01215.html">ReadOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>readoptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/daf/a01417.html">Slice</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01013">1013</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../d6/d50/a02694_source.html#l01493">db_</a>, <a class="el" href="../../d8/ddd/a00380.html#a09ad7c62dfe7e8739732d37041d058f9">rocksdb::DB::GetSnapshot()</a>, <a class="el" href="../../d8/ddd/a00380.html#a4aaff1029d25cb3717189d841746ad54">rocksdb::DB::NewIterator()</a>, <a class="el" href="../../d5/d96/a02642_source.html#l00062">rocksdb::Status::ok()</a>, <a class="el" href="../../d8/ddd/a00380.html#aedefaa4497eb584a45a818c0f05aff9b">rocksdb::DB::ReleaseSnapshot()</a>, and <a class="el" href="../../d2/de3/a02637_source.html#l00663">rocksdb::ReadOptions::snapshot</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01042">OperateDb()</a>.</p>
<div class="fragment"><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                                        {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <a class="code" href="../../d9/d2c/a03421.html#af127c2e4fc73b5d35647147ef45b350c">Status</a> s;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keyword">const</span> Snapshot* snapshot = <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#a09ad7c62dfe7e8739732d37041d058f9">GetSnapshot</a>();</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    ReadOptions readoptionscopy = readoptions;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    readoptionscopy.snapshot = snapshot;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    unique_ptr&lt;Iterator&gt; iter(<a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#a4aaff1029d25cb3717189d841746ad54">NewIterator</a>(readoptionscopy));</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    iter-&gt;Seek(key);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../db/d86/a02663.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a> i = 0; i &lt; FLAGS_num_iterations &amp;&amp; iter-&gt;Valid(); i++) {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <span class="keywordflow">if</span> (thread-&gt;rand.OneIn(2)) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        iter-&gt;Next();</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        iter-&gt;Prev();</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      thread-&gt;stats.AddIterations(1);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      thread-&gt;stats.AddErrors(1);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#aedefaa4497eb584a45a818c0f05aff9b">ReleaseSnapshot</a>(snapshot);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">return</span> s;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_adc885688cb75cceb53fcf6c0eccfa956_cgraph.png" border="0" usemap="#d3/daa/a01577_adc885688cb75cceb53fcf6c0eccfa956_cgraph" alt=""/></div>
<map name="d3/daa/a01577_adc885688cb75cceb53fcf6c0eccfa956_cgraph" id="d3/daa/a01577_adc885688cb75cceb53fcf6c0eccfa956_cgraph">
<area shape="rect" id="node3" href="../../d8/ddd/a00380.html#a09ad7c62dfe7e8739732d37041d058f9" title="rocksdb::DB::GetSnapshot" alt="" coords="209,5,388,35"/><area shape="rect" id="node5" href="../../d8/ddd/a00380.html#a4aaff1029d25cb3717189d841746ad54" title="rocksdb::DB::NewIterator" alt="" coords="213,59,384,88"/><area shape="rect" id="node7" href="../../d0/db9/a01552.html#a63cba37f62403ccc2f3e8b0b8ee04425" title="rocksdb::Status::ok" alt="" coords="231,112,367,141"/><area shape="rect" id="node9" href="../../d8/ddd/a00380.html#aedefaa4497eb584a45a818c0f05aff9b" title="rocksdb::DB::ReleaseSnapshot" alt="" coords="196,165,401,195"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_adc885688cb75cceb53fcf6c0eccfa956_icgraph.png" border="0" usemap="#d3/daa/a01577_adc885688cb75cceb53fcf6c0eccfa956_icgraph" alt=""/></div>
<map name="d3/daa/a01577_adc885688cb75cceb53fcf6c0eccfa956_icgraph" id="d3/daa/a01577_adc885688cb75cceb53fcf6c0eccfa956_icgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#af55a36a036e7348d3442400c050df2ee" title="rocksdb::StressTest\l::OperateDb" alt="" coords="196,5,335,51"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2ef3595857efa0c84b56dd69ac220abe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db9/a01552.html">Status</a> rocksdb::StressTest::MultiPrefixScan </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *&#160;</td>
          <td class="paramname"><em>thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d3f/a01215.html">ReadOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>readoptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/daf/a01417.html">Slice</a> &amp;&#160;</td>
          <td class="paramname"><em>prefix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l00941">941</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../d6/d50/a02694_source.html#l01493">db_</a>, <a class="el" href="../../d8/ddd/a00380.html#a09ad7c62dfe7e8739732d37041d058f9">rocksdb::DB::GetSnapshot()</a>, <a class="el" href="../../d8/ddd/a00380.html#a4aaff1029d25cb3717189d841746ad54">rocksdb::DB::NewIterator()</a>, <a class="el" href="../../d2/d02/a00777.html#a06da095e0c88cc65ac23e4ec88d0a390">rocksdb::Iterator::Next()</a>, <a class="el" href="../../d3/d09/a02539_source.html#l00030">ripple::Resource::ok</a>, <a class="el" href="../../d5/d96/a02642_source.html#l00036">rocksdb::Status::OK()</a>, <a class="el" href="../../d5/d96/a02642_source.html#l00062">rocksdb::Status::ok()</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00676">rocksdb::ReadOptions::prefix</a>, <a class="el" href="../../d8/ddd/a00380.html#aedefaa4497eb584a45a818c0f05aff9b">rocksdb::DB::ReleaseSnapshot()</a>, <a class="el" href="../../d2/d02/a00777.html#a99d2e05c952cecb0f4a0fa60412bafc2">rocksdb::Iterator::SeekToFirst()</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00663">rocksdb::ReadOptions::snapshot</a>, <a class="el" href="../../dd/d75/a02639_source.html#l00072">rocksdb::Slice::ToString()</a>, and <a class="el" href="../../d2/d02/a00777.html#a1a503134af26025486d5c640e49cdf54">rocksdb::Iterator::value()</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01042">OperateDb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                                              {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    std::string prefixes[10] = {<span class="stringliteral">&quot;0&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>, <span class="stringliteral">&quot;3&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>,</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                <span class="stringliteral">&quot;5&quot;</span>, <span class="stringliteral">&quot;6&quot;</span>, <span class="stringliteral">&quot;7&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>, <span class="stringliteral">&quot;9&quot;</span>};</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    Slice prefix_slices[10];</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    ReadOptions readoptionscopy[10];</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keyword">const</span> Snapshot* snapshot = <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#a09ad7c62dfe7e8739732d37041d058f9">GetSnapshot</a>();</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    Iterator* iters[10];</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="../../d9/d2c/a03421.html#af127c2e4fc73b5d35647147ef45b350c">Status</a> s = <a class="code" href="../../d0/db9/a01552.html#aceb84d55ae3b6bccf2a925433ca1ae00">Status::OK</a>();</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      prefixes[i] += <a class="code" href="../../d7/da0/a03474.html#a1976d8d4b21b2ffdc54122cc7b7ef4bca6d103da959e06d5ded60252ed0fd8a9a">prefix</a>.ToString();</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      prefix_slices[i] = prefixes[i];</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      readoptionscopy[i] = readoptions;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      readoptionscopy[i].prefix = &amp;prefix_slices[i];</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      readoptionscopy[i].snapshot = snapshot;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      iters[i] = <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#a4aaff1029d25cb3717189d841746ad54">NewIterator</a>(readoptionscopy[i]);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      iters[i]-&gt;<a class="code" href="../../d2/d02/a00777.html#a99d2e05c952cecb0f4a0fa60412bafc2">SeekToFirst</a>();</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">while</span> (iters[0]-&gt;Valid()) {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      count++;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      std::string values[10];</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="comment">// get list of all values for this iteration</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="comment">// no iterator should finish before the first one</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        assert(iters[i]-&gt;Valid());</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        values[i] = iters[i]-&gt;value().ToString();</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keywordtype">char</span> expected_first = (prefixes[i])[0];</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordtype">char</span> actual_first = (values[i])[0];</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="keywordflow">if</span> (actual_first != expected_first) {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;error expected first = %c actual = %c\n&quot;</span>,</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                  expected_first, actual_first);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        }</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        (values[i])[0] = <span class="charliteral">&#39; &#39;</span>; <span class="comment">// blank out the differing character</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="comment">// make sure all values are equivalent</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keywordflow">if</span> (values[i] != values[0]) {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;error : inconsistent values for prefix %s: %s, %s\n&quot;</span>,</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                  <a class="code" href="../../d7/da0/a03474.html#a1976d8d4b21b2ffdc54122cc7b7ef4bca6d103da959e06d5ded60252ed0fd8a9a">prefix</a>.ToString().c_str(), values[0].c_str(),</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                  values[i].c_str());</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;          <span class="comment">// we continue after error rather than exiting so that we can</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;          <span class="comment">// find more errors if any</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        }</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        iters[i]-&gt;Next();</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="comment">// cleanup iterators and snapshot</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <span class="comment">// if the first iterator finished, they should have all finished</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      assert(!iters[i]-&gt;Valid());</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      assert(iters[i]-&gt;status().<a class="code" href="../../d5/d6b/a03428.html#ae12997de115c1cf0032794aa5ea1b15daadeb01a5ff7ccf891ad10c735db17661">ok</a>());</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <span class="keyword">delete</span> iters[i];</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#aedefaa4497eb584a45a818c0f05aff9b">ReleaseSnapshot</a>(snapshot);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      thread-&gt;stats.AddPrefixes(1, count);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      thread-&gt;stats.AddErrors(1);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordflow">return</span> s;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a2ef3595857efa0c84b56dd69ac220abe_cgraph.png" border="0" usemap="#d3/daa/a01577_a2ef3595857efa0c84b56dd69ac220abe_cgraph" alt=""/></div>
<map name="d3/daa/a01577_a2ef3595857efa0c84b56dd69ac220abe_cgraph" id="d3/daa/a01577_a2ef3595857efa0c84b56dd69ac220abe_cgraph">
<area shape="rect" id="node3" href="../../d8/ddd/a00380.html#a09ad7c62dfe7e8739732d37041d058f9" title="rocksdb::DB::GetSnapshot" alt="" coords="209,5,388,35"/><area shape="rect" id="node5" href="../../d8/ddd/a00380.html#a4aaff1029d25cb3717189d841746ad54" title="rocksdb::DB::NewIterator" alt="" coords="213,59,384,88"/><area shape="rect" id="node7" href="../../d2/d02/a00777.html#a06da095e0c88cc65ac23e4ec88d0a390" title="rocksdb::Iterator::Next" alt="" coords="223,112,375,141"/><area shape="rect" id="node9" href="../../d0/db9/a01552.html#aceb84d55ae3b6bccf2a925433ca1ae00" title="rocksdb::Status::OK" alt="" coords="228,165,369,195"/><area shape="rect" id="node13" href="../../d0/db9/a01552.html#a63cba37f62403ccc2f3e8b0b8ee04425" title="rocksdb::Status::ok" alt="" coords="231,219,367,248"/><area shape="rect" id="node15" href="../../d8/ddd/a00380.html#aedefaa4497eb584a45a818c0f05aff9b" title="rocksdb::DB::ReleaseSnapshot" alt="" coords="196,272,401,301"/><area shape="rect" id="node17" href="../../d2/d02/a00777.html#a99d2e05c952cecb0f4a0fa60412bafc2" title="rocksdb::Iterator::\lSeekToFirst" alt="" coords="236,325,361,371"/><area shape="rect" id="node19" href="../../de/daf/a01417.html#ac5faa24d39a613c0ce7965d2bd9cf958" title="rocksdb::Slice::ToString" alt="" coords="217,395,380,424"/><area shape="rect" id="node21" href="../../d2/d02/a00777.html#a1a503134af26025486d5c640e49cdf54" title="rocksdb::Iterator::\lvalue" alt="" coords="236,447,361,494"/><area shape="rect" id="node11" href="../../d0/db9/a01552.html#afcc875b53756534a635212b3d8f43864" title="rocksdb::Status::Status" alt="" coords="451,165,611,195"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a2ef3595857efa0c84b56dd69ac220abe_icgraph.png" border="0" usemap="#d3/daa/a01577_a2ef3595857efa0c84b56dd69ac220abe_icgraph" alt=""/></div>
<map name="d3/daa/a01577_a2ef3595857efa0c84b56dd69ac220abe_icgraph" id="d3/daa/a01577_a2ef3595857efa0c84b56dd69ac220abe_icgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#af55a36a036e7348d3442400c050df2ee" title="rocksdb::StressTest\l::OperateDb" alt="" coords="196,5,335,51"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2bdd8a9595b621c43bb200a88383ce14"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db9/a01552.html">Status</a> rocksdb::StressTest::MultiPut </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *&#160;</td>
          <td class="paramname"><em>thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d4b/a01848.html">WriteOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>writeoptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/daf/a01417.html">Slice</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/daf/a01417.html">Slice</a> &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l00821">821</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../d6/d50/a02694_source.html#l01493">db_</a>, <a class="el" href="../../d6/dca/a02616_source.html#l00162">rocksdb::WriteBatch::Merge()</a>, <a class="el" href="../../d5/d96/a02642_source.html#l00062">rocksdb::Status::ok()</a>, <a class="el" href="../../d6/dca/a02616_source.html#l00142">rocksdb::WriteBatch::Put()</a>, <a class="el" href="../../dd/d75/a02639_source.html#l00072">rocksdb::Slice::ToString()</a>, <a class="el" href="../../de/d8e/a02762_source.html#l00041">rocksdb::Status::ToString()</a>, and <a class="el" href="../../d8/ddd/a00380.html#ad5d37a09e90d0c22c9a0adca87267ebc">rocksdb::DB::Write()</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01042">OperateDb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                                                                   {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    std::string keys[10] = {<span class="stringliteral">&quot;9&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>, <span class="stringliteral">&quot;7&quot;</span>, <span class="stringliteral">&quot;6&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>,</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                            <span class="stringliteral">&quot;4&quot;</span>, <span class="stringliteral">&quot;3&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>};</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    std::string values[10] = {<span class="stringliteral">&quot;9&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>, <span class="stringliteral">&quot;7&quot;</span>, <span class="stringliteral">&quot;6&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>,</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                              <span class="stringliteral">&quot;4&quot;</span>, <span class="stringliteral">&quot;3&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>};</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    Slice value_slices[10];</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    WriteBatch batch;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <a class="code" href="../../d9/d2c/a03421.html#af127c2e4fc73b5d35647147ef45b350c">Status</a> s;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      keys[i] += key.ToString();</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      values[i] += <a class="code" href="../../d6/dfc/a02612.html#a38c8b88c432e666ad10b0c5573e1160a">value</a>.ToString();</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      value_slices[i] = values[i];</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      <span class="keywordflow">if</span> (FLAGS_use_merge) {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        batch.Merge(keys[i], value_slices[i]);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        batch.Put(keys[i], value_slices[i]);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    s = <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#ad5d37a09e90d0c22c9a0adca87267ebc">Write</a>(writeoptions, &amp;batch);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">if</span> (!s.ok()) {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;multiput error: %s\n&quot;</span>, s.ToString().c_str());</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      thread-&gt;stats.AddErrors(1);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="comment">// we did 10 writes each of size sz + 1</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      thread-&gt;stats.AddBytesForWrites(10, (sz + 1) * 10);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">return</span> s;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a2bdd8a9595b621c43bb200a88383ce14_cgraph.png" border="0" usemap="#d3/daa/a01577_a2bdd8a9595b621c43bb200a88383ce14_cgraph" alt=""/></div>
<map name="d3/daa/a01577_a2bdd8a9595b621c43bb200a88383ce14_cgraph" id="d3/daa/a01577_a2bdd8a9595b621c43bb200a88383ce14_cgraph">
<area shape="rect" id="node3" href="../../d2/dbd/a01844.html#ab2c611e4e5d774ecd115082bce617e7a" title="rocksdb::WriteBatch\l::Merge" alt="" coords="209,73,351,119"/><area shape="rect" id="node23" href="../../d0/db9/a01552.html#a63cba37f62403ccc2f3e8b0b8ee04425" title="rocksdb::Status::ok" alt="" coords="212,196,348,225"/><area shape="rect" id="node25" href="../../d2/dbd/a01844.html#ade37e4f14b7b0d1471365e5a7d85b678" title="rocksdb::WriteBatch::Put" alt="" coords="196,143,364,172"/><area shape="rect" id="node30" href="../../de/daf/a01417.html#ac5faa24d39a613c0ce7965d2bd9cf958" title="rocksdb::Slice::ToString" alt="" coords="199,249,361,279"/><area shape="rect" id="node32" href="../../d0/db9/a01552.html#ac02bdc6723705072a10111a99b4ca17c" title="rocksdb::Status::ToString" alt="" coords="195,303,365,332"/><area shape="rect" id="node36" href="../../d8/ddd/a00380.html#ad5d37a09e90d0c22c9a0adca87267ebc" title="rocksdb::DB::Write" alt="" coords="213,356,347,385"/><area shape="rect" id="node5" href="../../da/d8c/a01845.html#a3a404e8b1f29c53fc2d3b2a70dfb8478" title="rocksdb::WriteBatchInternal\l::Count" alt="" coords="413,34,597,81"/><area shape="rect" id="node9" href="../../d4/d87/a03436.html#af1cdcde94bcaeced42cd5925a5827232" title="rocksdb::PutLengthPrefixed\lSlice" alt="" coords="415,103,596,150"/><area shape="rect" id="node19" href="../../da/d8c/a01845.html#a5d61953d919f082c48c4d4aada512004" title="rocksdb::WriteBatchInternal\l::SetCount" alt="" coords="413,173,597,219"/><area shape="rect" id="node7" href="../../d4/d87/a03436.html#a5eb46c01bbc65cc301b2648e655dbe15" title="rocksdb::DecodeFixed32" alt="" coords="647,5,812,35"/><area shape="rect" id="node11" href="../../de/daf/a01417.html#abed770f35075076510897c3fbbc10923" title="rocksdb::Slice::data" alt="" coords="660,112,799,141"/><area shape="rect" id="node13" href="../../d4/d87/a03436.html#afe24fa7da1cd551af92134aa66f96183" title="rocksdb::PutVarint32" alt="" coords="657,165,801,195"/><area shape="rect" id="node17" href="../../de/daf/a01417.html#aeb3a4a3ede98a163cc3796ef0d4a759d" title="rocksdb::Slice::size" alt="" coords="661,59,797,88"/><area shape="rect" id="node15" href="../../d4/d87/a03436.html#a94c48680211f25845f5c35acd4b54ebb" title="rocksdb::EncodeVarint32" alt="" coords="861,165,1029,195"/><area shape="rect" id="node21" href="../../d4/d87/a03436.html#aabc7ce45ae48e15b24a6756f9b4fd694" title="rocksdb::EncodeFixed32" alt="" coords="647,219,812,248"/><area shape="rect" id="node34" href="../../d0/db9/a01552.html#a6679d2e36279094844a67acbb3cc3e5c" title="rocksdb::Status::code" alt="" coords="431,303,580,332"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a2bdd8a9595b621c43bb200a88383ce14_icgraph.png" border="0" usemap="#d3/daa/a01577_a2bdd8a9595b621c43bb200a88383ce14_icgraph" alt=""/></div>
<map name="d3/daa/a01577_a2bdd8a9595b621c43bb200a88383ce14_icgraph" id="d3/daa/a01577_a2bdd8a9595b621c43bb200a88383ce14_icgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#af55a36a036e7348d3442400c050df2ee" title="rocksdb::StressTest\l::OperateDb" alt="" coords="196,5,335,51"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abd8a7f61f0b14b85acd87a4d77a6e394"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rocksdb::StressTest::Open </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01357">1357</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../d2/de3/a02637_source.html#l00527">rocksdb::Options::allow_mmap_reads</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00182">rocksdb::Options::block_cache</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00187">rocksdb::Options::block_cache_compressed</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00195">rocksdb::Options::block_size</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01489">cache_</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00579">rocksdb::Options::compaction_options_universal</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00576">rocksdb::Options::compaction_style</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01490">compressed_cache_</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00219">rocksdb::Options::compression</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00110">rocksdb::Options::create_if_missing</a>, <a class="el" href="../../df/d91/a02774_source.html#l00050">rocksdb::MergeOperators::CreatePutOperator()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01493">db_</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00186">dbstats</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00396">rocksdb::Options::delete_obsolete_files_period_micros</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00390">rocksdb::Options::disable_seek_compaction</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00356">rocksdb::Options::disableDataSync</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00130">rocksdb::Options::env</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00586">rocksdb::Options::filter_deletes</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00243">rocksdb::Options::filter_policy</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01491">filter_policy_</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00280">FLAGS_compression_type_e</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00285">FLAGS_env</a>, <a class="el" href="../../db/d8b/a02594_source.html#l00022">FLAGS_max_write_buffer_number</a>, <a class="el" href="../../db/d8b/a02594_source.html#l00023">FLAGS_min_write_buffer_number_to_merge</a>, <a class="el" href="../../db/d8b/a02594_source.html#l00021">FLAGS_write_buffer_size</a>, <a class="el" href="../../d9/d66/a02562_source.html#l00438">kPrefixHash</a>, <a class="el" href="../../d9/d66/a02562_source.html#l00437">kSkipList</a>, <a class="el" href="../../d9/d66/a02562_source.html#l00439">kUnsorted</a>, <a class="el" href="../../d9/d66/a02562_source.html#l00440">kVectorRep</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00272">rocksdb::Options::level0_file_num_compaction_trigger</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00277">rocksdb::Options::level0_slowdown_writes_trigger</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00280">rocksdb::Options::level0_stop_writes_trigger</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00401">rocksdb::Options::max_background_compactions</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00316">rocksdb::Options::max_bytes_for_level_base</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00318">rocksdb::Options::max_bytes_for_level_multiplier</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00452">rocksdb::Options::max_manifest_file_size</a>, <a class="el" href="../../d2/d11/a02647_source.html#l00041">rocksdb::CompactionOptionsUniversal::max_merge_width</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00174">rocksdb::Options::max_open_files</a>, <a class="el" href="../../d2/d11/a02647_source.html#l00053">rocksdb::CompactionOptionsUniversal::max_size_amplification_percent</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00158">rocksdb::Options::max_write_buffer_number</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00598">rocksdb::Options::memtable_factory</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00096">rocksdb::Options::merge_operator</a>, <a class="el" href="../../d2/d11/a02647_source.html#l00038">rocksdb::CompactionOptionsUniversal::min_merge_width</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00167">rocksdb::Options::min_write_buffer_number_to_merge</a>, <a class="el" href="../../d2/d93/a02758_source.html#l00065">rocksdb::NewFixedPrefixTransform()</a>, <a class="el" href="../../db/d44/a02564_source.html#l03452">rocksdb::DB::Open()</a>, <a class="el" href="../../de/d69/a02786_source.html#l00049">rocksdb::UtilityDB::OpenTtlDB()</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00259">rocksdb::Options::prefix_extractor</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01492">prefix_extractor_</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00520">rocksdb::Options::purge_redundant_kvs_while_flush</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01494">sdb_</a>, <a class="el" href="../../d2/d11/a02647_source.html#l00035">rocksdb::CompactionOptionsUniversal::size_ratio</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00348">rocksdb::Options::statistics</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00300">rocksdb::Options::target_file_size_base</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00303">rocksdb::Options::target_file_size_multiplier</a>, <a class="el" href="../../df/d02/a02755_source.html#l00047">rocksdb::Random::Uniform()</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00363">rocksdb::Options::use_fsync</a>, and <a class="el" href="../../d2/de3/a02637_source.html#l00152">rocksdb::Options::write_buffer_size</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01464">Reopen()</a>, and <a class="el" href="../../d6/d50/a02694_source.html#l00711">Run()</a>.</p>
<div class="fragment"><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;              {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    assert(<a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a> == <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    Options options;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    options.block_cache = <a class="code" href="../../d3/daa/a01577.html#aaf65c1865167c51f2243f5db7afbeac2">cache_</a>;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    options.block_cache_compressed = <a class="code" href="../../d3/daa/a01577.html#ad11df1e28fafa7a1c8a83eb3a0ac8430">compressed_cache_</a>;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    options.write_buffer_size = <a class="code" href="../../db/d8b/a02594.html#a95316c02ec448a6a8a0e169cdec69ab7">FLAGS_write_buffer_size</a>;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    options.max_write_buffer_number = <a class="code" href="../../db/d8b/a02594.html#a020946e1f10895bf44a2469cbfbb5740">FLAGS_max_write_buffer_number</a>;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    options.min_write_buffer_number_to_merge =</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      <a class="code" href="../../db/d8b/a02594.html#a549411da8136c6d8e29b63acc0458a02">FLAGS_min_write_buffer_number_to_merge</a>;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    options.max_background_compactions = FLAGS_max_background_compactions;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    options.compaction_style =</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="keyword">static_cast&lt;</span><a class="code" href="../../d4/d87/a03436.html#a5f567c14ba4b080c175765f51c9e63c3">rocksdb::CompactionStyle</a><span class="keyword">&gt;</span>(FLAGS_compaction_style);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    options.block_size = FLAGS_block_size;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    options.filter_policy = <a class="code" href="../../d3/daa/a01577.html#af2fa51ee1d1aeee82f60d94773decf5d">filter_policy_</a>;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    options.prefix_extractor = <a class="code" href="../../d3/daa/a01577.html#a997c0fe78e2af6cbb86f71a3c2b0a3ae">prefix_extractor_</a>;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    options.max_open_files = FLAGS_open_files;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    options.statistics = <a class="code" href="../../d6/d50/a02694.html#a213985cd230b559ca8411792c3aed1d0">dbstats</a>;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    options.env = <a class="code" href="../../d6/d50/a02694.html#a1217d1ecddbf658a860dcc8d313b2381">FLAGS_env</a>;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    options.disableDataSync = FLAGS_disable_data_sync;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    options.use_fsync = FLAGS_use_fsync;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    options.allow_mmap_reads = FLAGS_mmap_read;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <a class="code" href="../../d6/d50/a02694.html#a6d68099927710fe238835e71cd9009fb">rocksdb_kill_odds</a> = FLAGS_kill_random_test;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    options.target_file_size_base = FLAGS_target_file_size_base;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    options.target_file_size_multiplier = FLAGS_target_file_size_multiplier;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    options.max_bytes_for_level_base = FLAGS_max_bytes_for_level_base;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    options.max_bytes_for_level_multiplier =</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        FLAGS_max_bytes_for_level_multiplier;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    options.level0_stop_writes_trigger = FLAGS_level0_stop_writes_trigger;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    options.level0_slowdown_writes_trigger =</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      FLAGS_level0_slowdown_writes_trigger;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    options.level0_file_num_compaction_trigger =</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      FLAGS_level0_file_num_compaction_trigger;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    options.compression = <a class="code" href="../../d6/d50/a02694.html#af71ac2e6eff51c7589ef372955e75f91">FLAGS_compression_type_e</a>;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    options.create_if_missing = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    options.disable_seek_compaction = FLAGS_disable_seek_compaction;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    options.delete_obsolete_files_period_micros =</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      FLAGS_delete_obsolete_files_period_micros;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    options.max_manifest_file_size = 1024;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    options.filter_deletes = FLAGS_filter_deletes;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keywordflow">if</span> ((FLAGS_prefix_size == 0) == (<a class="code" href="../../d6/d50/a02694.html#ade812172c8bea7e0dd8e1828d05ea07d">FLAGS_rep_factory</a> == <a class="code" href="../../d9/d66/a02562.html#a91adbbf592c06b8b3ff605b27753bb40a4b3f7e848c89862fc673288d68b2e690">kPrefixHash</a>)) {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      fprintf(stderr,</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            <span class="stringliteral">&quot;prefix_size should be non-zero iff memtablerep == prefix_hash\n&quot;</span>);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      exit(1);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d6/d50/a02694.html#ade812172c8bea7e0dd8e1828d05ea07d">FLAGS_rep_factory</a>) {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d66/a02562.html#a91adbbf592c06b8b3ff605b27753bb40a4b3f7e848c89862fc673288d68b2e690">kPrefixHash</a>:</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        options.memtable_factory.reset(</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;          <span class="keyword">new</span> PrefixHashRepFactory(<a class="code" href="../../d4/d87/a03436.html#a827f732f23df3c1faf2427a0288b40a4">NewFixedPrefixTransform</a>(FLAGS_prefix_size))</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        );</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d66/a02562.html#a91adbbf592c06b8b3ff605b27753bb40a77be1648a52aa05e537113e790091ace">kUnsorted</a>:</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        options.memtable_factory.reset(</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;          <span class="keyword">new</span> UnsortedRepFactory()</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        );</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d66/a02562.html#a91adbbf592c06b8b3ff605b27753bb40adfe39d8993d004cc2c2a22526b81e92f">kSkipList</a>:</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        <span class="comment">// no need to do anything</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d66/a02562.html#a91adbbf592c06b8b3ff605b27753bb40aa80dc44e28e3edb21643bd749df435c5">kVectorRep</a>:</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        options.memtable_factory.reset(</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;          <span class="keyword">new</span> VectorRepFactory()</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        );</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keyword">static</span> Random purge_percent(1000); <span class="comment">// no benefit from non-determinism here</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordflow">if</span> (static_cast&lt;int32_t&gt;(purge_percent.Uniform(100)) &lt;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        FLAGS_purge_redundant_percent - 1) {</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      options.purge_redundant_kvs_while_flush = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">if</span> (FLAGS_use_merge) {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      options.merge_operator = <a class="code" href="../../db/dbf/a00975.html#ad9603085b9c846fef61b60aa0c465484">MergeOperators::CreatePutOperator</a>();</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="comment">// set universal style compaction configurations, if applicable</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="keywordflow">if</span> (FLAGS_universal_size_ratio != 0) {</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      options.compaction_options_universal.size_ratio =</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        FLAGS_universal_size_ratio;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keywordflow">if</span> (FLAGS_universal_min_merge_width != 0) {</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      options.compaction_options_universal.min_merge_width =</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        FLAGS_universal_min_merge_width;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    }</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="keywordflow">if</span> (FLAGS_universal_max_merge_width != 0) {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      options.compaction_options_universal.max_merge_width =</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        FLAGS_universal_max_merge_width;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    }</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordflow">if</span> (FLAGS_universal_max_size_amplification_percent != 0) {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      options.compaction_options_universal.max_size_amplification_percent =</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        FLAGS_universal_max_size_amplification_percent;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    }</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;DB path: [%s]\n&quot;</span>, FLAGS_db.c_str());</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <a class="code" href="../../d9/d2c/a03421.html#af127c2e4fc73b5d35647147ef45b350c">Status</a> s;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="keywordflow">if</span> (FLAGS_ttl == -1) {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      s = <a class="code" href="../../d8/ddd/a00380.html#a898ece06bdc8a5ec59e5996a01f2650d">DB::Open</a>(options, FLAGS_db, &amp;<a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      s = <a class="code" href="../../d9/d02/a01774.html#a79510d4196fd7a17b72e30ca82749de9">UtilityDB::OpenTtlDB</a>(options, FLAGS_db, &amp;<a class="code" href="../../d3/daa/a01577.html#a8bc0db0055b9a7059c2c42ac478e2713">sdb_</a>, FLAGS_ttl);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a> = <a class="code" href="../../d3/daa/a01577.html#a8bc0db0055b9a7059c2c42ac478e2713">sdb_</a>;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    }</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordflow">if</span> (!s.ok()) {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;open error: %s\n&quot;</span>, s.ToString().c_str());</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      exit(1);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    }</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_abd8a7f61f0b14b85acd87a4d77a6e394_cgraph.png" border="0" usemap="#d3/daa/a01577_abd8a7f61f0b14b85acd87a4d77a6e394_cgraph" alt=""/></div>
<map name="d3/daa/a01577_abd8a7f61f0b14b85acd87a4d77a6e394_cgraph" id="d3/daa/a01577_abd8a7f61f0b14b85acd87a4d77a6e394_cgraph">
<area shape="rect" id="node3" href="../../db/dbf/a00975.html#ad9603085b9c846fef61b60aa0c465484" title="rocksdb::MergeOperators\l::CreatePutOperator" alt="" coords="225,649,393,695"/><area shape="rect" id="node5" href="../../d4/d87/a03436.html#a827f732f23df3c1faf2427a0288b40a4" title="rocksdb::NewFixedPrefixTransform" alt="" coords="196,719,423,748"/><area shape="rect" id="node7" href="../../d8/ddd/a00380.html#a898ece06bdc8a5ec59e5996a01f2650d" title="rocksdb::DB::Open" alt="" coords="243,772,376,801"/><area shape="rect" id="node122" href="../../d9/d02/a01774.html#a79510d4196fd7a17b72e30ca82749de9" title="rocksdb::UtilityDB\l::OpenTtlDB" alt="" coords="245,1090,373,1137"/><area shape="rect" id="node125" href="../../d9/d25/a01157.html#a71e653793b2f7189d61dcbc263ece2ed" title="rocksdb::Random::Uniform" alt="" coords="220,1691,399,1720"/><area shape="rect" id="node9" href="../../dd/df5/a00386.html#acef475ae9fa32c7caf0ba839f056d89c" title="rocksdb::DBImpl::CreateArchival\lDirectory" alt="" coords="476,199,689,246"/><area shape="rect" id="node13" href="../../db/db1/a00460.html#a52a10880d70d77d1dcad9f2fb20ce171" title="rocksdb::Env::CreateDirIf\lMissing" alt="" coords="780,229,951,275"/><area shape="rect" id="node20" href="../../dd/df5/a00386.html#a4406b5ed5487f7562bd0fe1696c6092f" title="rocksdb::DBImpl::DeleteObsolete\lFiles" alt="" coords="473,505,692,551"/><area shape="rect" id="node35" href="../../d4/d87/a03436.html#ad2e1157820fce4ccbfc1846e12be2477" title="rocksdb::LogFileName" alt="" coords="1068,524,1220,553"/><area shape="rect" id="node39" href="../../d0/db9/a01552.html#a63cba37f62403ccc2f3e8b0b8ee04425" title="rocksdb::Status::ok" alt="" coords="1076,1521,1212,1551"/><area shape="rect" id="node43" href="../../d0/db9/a01552.html#a5afec51a3f306b6f188a5af0c5d003ba" title="rocksdb::Status::Invalid\lArgument" alt="" coords="785,1962,945,2009"/><area shape="rect" id="node46" href="../../d9/d9a/a00998.html#a5d2f9be842f9982681ca8ff36f935596" title="rocksdb::port::Mutex\l::Lock" alt="" coords="512,331,653,378"/><area shape="rect" id="node51" href="../../dd/df5/a00386.html#a6f3ccd58266e8fd7a1b513ebef01928a" title="rocksdb::DBImpl::MaybeSchedule\lFlushOrCompaction" alt="" coords="472,698,693,745"/><area shape="rect" id="node64" href="../../dd/df5/a00386.html#a4ab5900a7770dcb2a687bfd41269f2df" title="rocksdb::DBImpl::MaybeSchedule\lLogDBDeployStats" alt="" coords="472,859,693,906"/><area shape="rect" id="node73" href="../../db/db1/a00460.html#a2415186e0a399d70edabef9f477e4c47" title="rocksdb::Env::NewWritableFile" alt="" coords="1043,1152,1245,1181"/><area shape="rect" id="node75" href="../../dd/df5/a00386.html#aaecfe0733c5634343143bf3e9f705880" title="rocksdb::DBImpl::NumberLevels" alt="" coords="1039,1336,1249,1365"/><area shape="rect" id="node78" href="../../dd/df5/a00386.html#afe079cf353957e6c79ed794cbc0bb9fc" title="rocksdb::DBImpl::Recover" alt="" coords="495,1440,671,1469"/><area shape="rect" id="node117" href="../../d3/dcd/a00965.html#a81f80d2b6674d454e4b65f238281d716" title="rocksdb::MemTable::\lSetLogNumber" alt="" coords="511,5,655,51"/><area shape="rect" id="node119" href="../../d9/d9a/a00998.html#a73a5db74971add43b1762259a8e171f1" title="rocksdb::port::Mutex\l::Unlock" alt="" coords="512,418,653,465"/><area shape="rect" id="node11" href="../../d4/d87/a03436.html#a546d3e2e5c3b4aa8ee9828c7b519d501" title="rocksdb::ArchivalDirectory" alt="" coords="777,125,953,155"/><area shape="rect" id="node15" href="../../d0/db9/a01552.html#aceb84d55ae3b6bccf2a925433ca1ae00" title="rocksdb::Status::OK" alt="" coords="1073,212,1215,241"/><area shape="rect" id="node17" href="../../d0/db9/a01552.html#afcc875b53756534a635212b3d8f43864" title="rocksdb::Status::Status" alt="" coords="1301,1244,1461,1273"/><area shape="rect" id="node22" href="../../d9/d9a/a00998.html#adc55e4555301d02ced0ec883bc6cd4f6" title="rocksdb::port::Mutex\l::AssertHeld" alt="" coords="1073,577,1215,623"/><area shape="rect" id="node24" href="../../dd/df5/a00386.html#a3683f24e767a6e83d03acab509c64ba8" title="rocksdb::DBImpl::FindObsolete\lFiles" alt="" coords="763,351,968,398"/><area shape="rect" id="node33" href="../../dd/df5/a00386.html#a9b3b0cce1e70a97d4d797ba7d5511dd5" title="rocksdb::DBImpl::PurgeObsolete\lFiles" alt="" coords="759,522,972,569"/><area shape="rect" id="node27" href="../../db/db1/a00460.html#aebd6a4aac30704da29fecf45a9da21d6" title="rocksdb::Env::GetChildren" alt="" coords="1056,443,1232,472"/><area shape="rect" id="node29" href="../../dd/dea/a00408.html#aebc2e02a27eedb603b0455badcb0a1c7" title="rocksdb::DBImpl::Deletion\lState::HaveSomethingToDelete" alt="" coords="1041,359,1247,406"/><area shape="rect" id="node31" href="../../db/db1/a00460.html#a20e69bbefe7d92b92a2f33100cf251b7" title="rocksdb::Env::NowMicros" alt="" coords="1057,307,1231,336"/><area shape="rect" id="node41" href="../../d4/d87/a03436.html#ad3fcb7354969b5ea357d56b2d02362fc" title="rocksdb::ParseFileName" alt="" coords="1061,872,1227,901"/><area shape="rect" id="node37" href="../../d4/d87/a03436.html#a645cac7eafed2fae5df45e8483f8fbaf" title="rocksdb::MakeFileName" alt="" coords="1300,524,1463,553"/><area shape="rect" id="node48" href="../../d8/df7/a03469.html#aceefae455e28f4218993e00e08321dff" title="rocksdb::port::PthreadCall" alt="" coords="779,299,952,328"/><area shape="rect" id="node53" href="../../de/d76/a00134.html#a3df03b47d7c561143fd1ac591207e2cf" title="rocksdb::port::AtomicPointer\l::Acquire_Load" alt="" coords="772,767,959,814"/><area shape="rect" id="node56" href="../../dd/df5/a00386.html#a0f92fd02fffbe404bbdffc1bd24195d7" title="rocksdb::DBImpl::BGWorkCompaction" alt="" coords="741,592,989,621"/><area shape="rect" id="node58" href="../../dd/df5/a00386.html#a7f35702e61b4f7ec3eb12e91432dca47" title="rocksdb::DBImpl::BGWorkFlush" alt="" coords="760,645,971,675"/><area shape="rect" id="node60" href="../../d7/dd4/a00968.html#a95a7b2d65fbe38706615b07eafd3cb36" title="rocksdb::MemTableList\l::IsFlushPending" alt="" coords="787,698,944,745"/><area shape="rect" id="node62" href="../../db/db1/a00460.html#a4367e6868093755a80234295a1c21867" title="rocksdb::Env::Schedule" alt="" coords="785,837,945,867"/><area shape="rect" id="node67" href="../../dd/df5/a00386.html#a3b86ec3494acbb6dbb8f2fdace967183" title="rocksdb::DBImpl::BGLogDBDeploy\lStats" alt="" coords="752,890,979,937"/><area shape="rect" id="node69" href="../../db/db1/a00460.html#a70ed14df4e067de0f2a8a09010eaf31b" title="rocksdb::Env::GetCurrentTime" alt="" coords="765,960,965,989"/><area shape="rect" id="node81" href="../../d0/db9/a01552.html#a585d7fbcadd8858734f534519290035d" title="rocksdb::Status::Corruption" alt="" coords="1053,1244,1235,1273"/><area shape="rect" id="node85" href="../../d4/d87/a03436.html#a112e8c44dec6475699006a7f68830b1a" title="rocksdb::CurrentFileName" alt="" coords="779,1704,952,1733"/><area shape="rect" id="node87" href="../../db/db1/a00460.html#a8b523020a36e640a4820edc5535a8808" title="rocksdb::Env::FileExists" alt="" coords="783,1440,948,1469"/><area shape="rect" id="node90" href="../../d4/d87/a03436.html#ae569241bbac7237a7c1bdb1d2ebff31e" title="rocksdb::IdentityFileName" alt="" coords="1057,1833,1231,1863"/><area shape="rect" id="node93" href="../../db/db1/a00460.html#a680d05d86580d65e4c1cfe16dd099385" title="rocksdb::Env::LockFile" alt="" coords="788,1493,943,1523"/><area shape="rect" id="node95" href="../../d4/d87/a03436.html#a820e85c65a3dad99ec67d4414c1b8ccb" title="rocksdb::LockFileName" alt="" coords="785,1547,945,1576"/><area shape="rect" id="node97" href="../../dd/df5/a00386.html#adca3cc37d179c0402363d4cae6529d72" title="rocksdb::DBImpl::NewDB" alt="" coords="779,1336,952,1365"/><area shape="rect" id="node104" href="../../dd/df5/a00386.html#adb8cf2e0f98f8368db32bea16bcf3cb7" title="rocksdb::DBImpl::Recover\lLogFile" alt="" coords="777,1266,953,1313"/><area shape="rect" id="node111" href="../../d4/d87/a03436.html#a27807ffab7c639e7f7615cd5456efcb1" title="rocksdb::SetIdentityFile" alt="" coords="785,1808,945,1837"/><area shape="rect" id="node115" href="../../d4/d87/a03436.html#a9231fa7580b3932152d6f3bd39907320" title="rocksdb::SetTickerCount" alt="" coords="783,1600,948,1629"/><area shape="rect" id="node127" href="../../d9/d25/a01157.html#a520efcab691df60bc48d1fe7251f1cd5" title="rocksdb::Random::Next" alt="" coords="503,2083,663,2112"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_abd8a7f61f0b14b85acd87a4d77a6e394_icgraph.png" border="0" usemap="#d3/daa/a01577_abd8a7f61f0b14b85acd87a4d77a6e394_icgraph" alt=""/></div>
<map name="d3/daa/a01577_abd8a7f61f0b14b85acd87a4d77a6e394_icgraph" id="d3/daa/a01577_abd8a7f61f0b14b85acd87a4d77a6e394_icgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#aeac9f55bde5a11da0fcc2c88465de0c6" title="rocksdb::StressTest\l::Reopen" alt="" coords="212,5,351,51"/><area shape="rect" id="node5" href="../../d3/daa/a01577.html#af7e726bf27e216787e7c331834ec6075" title="rocksdb::StressTest::Run" alt="" coords="196,75,367,104"/><area shape="rect" id="node7" href="../../d6/d50/a02694.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="416,75,467,104"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af55a36a036e7348d3442400c050df2ee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rocksdb::StressTest::OperateDb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *&#160;</td>
          <td class="paramname"><em>thread</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01042">1042</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../dd/d75/a02639_source.html#l00046">rocksdb::Slice::data()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01493">db_</a>, <a class="el" href="../../db/d44/a02564_source.html#l03437">rocksdb::DB::Delete()</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00721">rocksdb::WriteOptions::disableWAL</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01271">GenerateValue()</a>, <a class="el" href="../../d8/ddd/a00380.html#ae6350a924ad1ac1129726e384a487da3">rocksdb::DB::Get()</a>, <a class="el" href="../../d5/d96/a02642_source.html#l00065">rocksdb::Status::IsNotFound()</a>, <a class="el" href="../../d2/d02/a00777.html#a34cfd17f7b64652774de76cbc0e5b202">rocksdb::Iterator::key()</a>, <a class="el" href="../../db/d44/a02564_source.html#l03443">rocksdb::DB::Merge()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00856">MultiDelete()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00884">MultiGet()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01013">MultiIterate()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00941">MultiPrefixScan()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00821">MultiPut()</a>, <a class="el" href="../../d8/ddd/a00380.html#a4aaff1029d25cb3717189d841746ad54">rocksdb::DB::NewIterator()</a>, <a class="el" href="../../d2/d02/a00777.html#a06da095e0c88cc65ac23e4ec88d0a390">rocksdb::Iterator::Next()</a>, <a class="el" href="../../d5/d96/a02642_source.html#l00062">rocksdb::Status::ok()</a>, <a class="el" href="../../df/d11/a01915_source.html#l00188">std::chrono::prefix</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00676">rocksdb::ReadOptions::prefix</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01262">PrintKeyValue()</a>, <a class="el" href="../../db/d44/a02564_source.html#l03431">rocksdb::DB::Put()</a>, <a class="el" href="../../d2/d02/a00777.html#a99d2e05c952cecb0f4a0fa60412bafc2">rocksdb::Iterator::SeekToFirst()</a>, <a class="el" href="../../dd/d75/a02639_source.html#l00049">rocksdb::Slice::size()</a>, <a class="el" href="../../dd/d75/a02639_source.html#l00093">rocksdb::Slice::starts_with()</a>, <a class="el" href="../../d2/d02/a00777.html#a5435c832490b19d4c3aebf7c4877098d">rocksdb::Iterator::status()</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00717">rocksdb::WriteOptions::sync</a>, <a class="el" href="../../d2/d02/a00777.html#a866c8627787b3a768273ae4893f27f8f">rocksdb::Iterator::Valid()</a>, <a class="el" href="../../d6/dfc/a02612_source.html#l00288">value</a>, and <a class="el" href="../../d6/d50/a02694_source.html#l01231">VerifyValue()</a>.</p>
<div class="fragment"><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                                      {</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    ReadOptions read_opts(FLAGS_verify_checksum, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    WriteOptions write_opts;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="../../d6/dfc/a02612.html#a38c8b88c432e666ad10b0c5573e1160a">value</a>[100];</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordtype">long</span> max_key = thread-&gt;shared-&gt;GetMaxKey();</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    std::string from_db;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">if</span> (FLAGS_sync) {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      write_opts.sync = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    }</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    write_opts.disableWAL = FLAGS_disable_wal;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> prefixBound = (int)FLAGS_readpercent + (<span class="keywordtype">int</span>)FLAGS_prefixpercent;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> writeBound = prefixBound + (int)FLAGS_writepercent;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> delBound = writeBound + (int)FLAGS_delpercent;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    thread-&gt;stats.Start();</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../db/d86/a02663.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a> i = 0; i &lt; FLAGS_ops_per_thread; i++) {</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="keywordflow">if</span>(i != 0 &amp;&amp; (i % (FLAGS_ops_per_thread / (FLAGS_reopen + 1))) == 0) {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        {</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;          thread-&gt;stats.FinishedSingleOp();</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;          MutexLock l(thread-&gt;shared-&gt;GetMutex());</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;          thread-&gt;shared-&gt;IncVotedReopen();</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;          <span class="keywordflow">if</span> (thread-&gt;shared-&gt;AllVotedReopen()) {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            thread-&gt;shared-&gt;GetStressTest()-&gt;Reopen();</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            thread-&gt;shared-&gt;GetCondVar()-&gt;SignalAll();</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;          }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            thread-&gt;shared-&gt;GetCondVar()-&gt;Wait();</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;          }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;          <span class="comment">// Commenting this out as we don&#39;t want to reset stats on each open.</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;          <span class="comment">// thread-&gt;stats.Start();</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="keywordtype">long</span> rand_key = thread-&gt;rand.Next() % max_key;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      std::string keystr = <a class="code" href="../../d4/d87/a03436.html#a9d8a21180881a482389bfe3baefa105a">Key</a>(rand_key);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      Slice key = keystr;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <span class="keywordtype">int</span> prob_op = thread-&gt;rand.Uniform(100);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keywordflow">if</span> (prob_op &gt;= 0 &amp;&amp; prob_op &lt; (<span class="keywordtype">int</span>)FLAGS_readpercent) {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="comment">// OPERATION read</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keywordflow">if</span> (!FLAGS_test_batches_snapshots) {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;          <a class="code" href="../../d9/d2c/a03421.html#af127c2e4fc73b5d35647147ef45b350c">Status</a> s = <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#ae6350a924ad1ac1129726e384a487da3">Get</a>(read_opts, key, &amp;from_db);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;          <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            <span class="comment">// found case</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            thread-&gt;stats.AddGets(1, 1);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (s.IsNotFound()) {</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            <span class="comment">// not found case</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            thread-&gt;stats.AddGets(1, 0);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            <span class="comment">// errors case</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            thread-&gt;stats.AddErrors(1);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;          }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;          <a class="code" href="../../d3/daa/a01577.html#a0b6a25d452fda380f8ece74068bdcf76">MultiGet</a>(thread, read_opts, key, &amp;from_db);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)FLAGS_readpercent &lt;= prob_op &amp;&amp; prob_op &lt; prefixBound) {</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="comment">// OPERATION prefix scan</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="comment">// keys are longs (e.g., 8 bytes), so we let prefixes be</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="comment">// everything except the last byte.  So there will be 2^8=256</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="comment">// keys per prefix.</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        Slice <a class="code" href="../../d7/da0/a03474.html#a1976d8d4b21b2ffdc54122cc7b7ef4bca6d103da959e06d5ded60252ed0fd8a9a">prefix</a> = Slice(key.data(), key.size() - 1);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="keywordflow">if</span> (!FLAGS_test_batches_snapshots) {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;          read_opts.prefix = &amp;<a class="code" href="../../d7/da0/a03474.html#a1976d8d4b21b2ffdc54122cc7b7ef4bca6d103da959e06d5ded60252ed0fd8a9a">prefix</a>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;          Iterator* iter = <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#a4aaff1029d25cb3717189d841746ad54">NewIterator</a>(read_opts);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;          <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;          <span class="keywordflow">for</span> (iter-&gt;SeekToFirst(); iter-&gt;Valid(); iter-&gt;Next()) {</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            assert(iter-&gt;key().starts_with(prefix));</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            count++;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;          }</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;          assert(count &lt;= 256);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;          <span class="keywordflow">if</span> (iter-&gt;status().ok()) {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            thread-&gt;stats.AddPrefixes(1, count);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            thread-&gt;stats.AddErrors(1);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;          }</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;          <span class="keyword">delete</span> iter;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;          <a class="code" href="../../d3/daa/a01577.html#a2ef3595857efa0c84b56dd69ac220abe">MultiPrefixScan</a>(thread, read_opts, prefix);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        read_opts.prefix = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (prefixBound &lt;= prob_op &amp;&amp; prob_op &lt; writeBound) {</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="comment">// OPERATION write</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        <a class="code" href="../../db/d86/a02663.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> value_base = thread-&gt;rand.Next();</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <span class="keywordtype">size_t</span> sz = <a class="code" href="../../d3/daa/a01577.html#a3a1d745ffde52899ed449cfc8eb5c177">GenerateValue</a>(value_base, value, <span class="keyword">sizeof</span>(value));</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        Slice v(value, sz);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="keywordflow">if</span> (!FLAGS_test_batches_snapshots) {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;          MutexLock l(thread-&gt;shared-&gt;GetMutexForKey(rand_key));</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;          <span class="keywordflow">if</span> (FLAGS_verify_before_write) {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            std::string keystr2 = <a class="code" href="../../d4/d87/a03436.html#a9d8a21180881a482389bfe3baefa105a">Key</a>(rand_key);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            Slice k = keystr2;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            <a class="code" href="../../d9/d2c/a03421.html#af127c2e4fc73b5d35647147ef45b350c">Status</a> s = <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#ae6350a924ad1ac1129726e384a487da3">Get</a>(read_opts, k, &amp;from_db);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            <a class="code" href="../../d3/daa/a01577.html#aa92ae3301b0fccf66dfc272634c09a4d">VerifyValue</a>(rand_key,</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                        read_opts,</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                        *(thread-&gt;shared),</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                        from_db,</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                        s,</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                        <span class="keyword">true</span>);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;          }</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;          thread-&gt;shared-&gt;Put(rand_key, value_base);</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;          <span class="keywordflow">if</span> (FLAGS_use_merge) {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#af6702472d68f092ade92c1eb8a6c0300">Merge</a>(write_opts, key, v);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#a981f3dc15e13dd3cf31435ea2608414f">Put</a>(write_opts, key, v);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;          }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;          thread-&gt;stats.AddBytesForWrites(1, sz);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;          <a class="code" href="../../d3/daa/a01577.html#a2bdd8a9595b621c43bb200a88383ce14">MultiPut</a>(thread, write_opts, key, v, sz);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <a class="code" href="../../d3/daa/a01577.html#a2f06d21c3db820737ee52e79cc320896">PrintKeyValue</a>(rand_key, value, sz);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (writeBound &lt;= prob_op &amp;&amp; prob_op &lt; delBound) {</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <span class="comment">// OPERATION delete</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <span class="keywordflow">if</span> (!FLAGS_test_batches_snapshots) {</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;          MutexLock l(thread-&gt;shared-&gt;GetMutexForKey(rand_key));</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;          thread-&gt;shared-&gt;Delete(rand_key);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;          <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#a6571e7ad4dfe25184e076fc3a937007a">Delete</a>(write_opts, key);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;          thread-&gt;stats.AddDeletes(1);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;          <a class="code" href="../../d3/daa/a01577.html#a66ead39d0fcb2a275ade836e56c3f7f1">MultiDelete</a>(thread, write_opts, key);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="comment">// OPERATION iterate</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        <a class="code" href="../../d3/daa/a01577.html#adc885688cb75cceb53fcf6c0eccfa956">MultiIterate</a>(thread, read_opts, key);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      thread-&gt;stats.FinishedSingleOp();</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    thread-&gt;stats.Stop();</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_af55a36a036e7348d3442400c050df2ee_cgraph.png" border="0" usemap="#d3/daa/a01577_af55a36a036e7348d3442400c050df2ee_cgraph" alt=""/></div>
<map name="d3/daa/a01577_af55a36a036e7348d3442400c050df2ee_cgraph" id="d3/daa/a01577_af55a36a036e7348d3442400c050df2ee_cgraph">
<area shape="rect" id="node3" href="../../de/daf/a01417.html#abed770f35075076510897c3fbbc10923" title="rocksdb::Slice::data" alt="" coords="924,64,1063,94"/><area shape="rect" id="node5" href="../../d8/ddd/a00380.html#a6571e7ad4dfe25184e076fc3a937007a" title="rocksdb::DB::Delete" alt="" coords="213,294,355,323"/><area shape="rect" id="node20" href="../../de/daf/a01417.html#aeb3a4a3ede98a163cc3796ef0d4a759d" title="rocksdb::Slice::size" alt="" coords="925,119,1061,148"/><area shape="rect" id="node28" href="../../d3/daa/a01577.html#a3a1d745ffde52899ed449cfc8eb5c177" title="rocksdb::StressTest\l::GenerateValue" alt="" coords="456,1152,595,1198"/><area shape="rect" id="node30" href="../../d8/ddd/a00380.html#ae6350a924ad1ac1129726e384a487da3" title="rocksdb::DB::Get" alt="" coords="464,571,587,600"/><area shape="rect" id="node32" href="../../d0/db9/a01552.html#ac6c469e9064f786f2adcc0a9ad328d8b" title="rocksdb::Status::IsNotFound" alt="" coords="431,518,620,547"/><area shape="rect" id="node36" href="../../d2/d02/a00777.html#a34cfd17f7b64652774de76cbc0e5b202" title="rocksdb::Iterator::key" alt="" coords="211,1118,357,1147"/><area shape="rect" id="node38" href="../../d8/ddd/a00380.html#af6702472d68f092ade92c1eb8a6c0300" title="rocksdb::DB::Merge" alt="" coords="215,187,353,216"/><area shape="rect" id="node46" href="../../d3/daa/a01577.html#a66ead39d0fcb2a275ade836e56c3f7f1" title="rocksdb::StressTest\l::MultiDelete" alt="" coords="215,416,353,462"/><area shape="rect" id="node49" href="../../d0/db9/a01552.html#a63cba37f62403ccc2f3e8b0b8ee04425" title="rocksdb::Status::ok" alt="" coords="457,624,593,654"/><area shape="rect" id="node57" href="../../d3/daa/a01577.html#a0b6a25d452fda380f8ece74068bdcf76" title="rocksdb::StressTest\l::MultiGet" alt="" coords="215,536,353,582"/><area shape="rect" id="node68" href="../../d3/daa/a01577.html#adc885688cb75cceb53fcf6c0eccfa956" title="rocksdb::StressTest\l::MultiIterate" alt="" coords="215,706,353,753"/><area shape="rect" id="node71" href="../../d8/ddd/a00380.html#a4aaff1029d25cb3717189d841746ad54" title="rocksdb::DB::NewIterator" alt="" coords="440,838,611,867"/><area shape="rect" id="node75" href="../../d3/daa/a01577.html#a2ef3595857efa0c84b56dd69ac220abe" title="rocksdb::StressTest\l::MultiPrefixScan" alt="" coords="215,776,353,822"/><area shape="rect" id="node79" href="../../d2/d02/a00777.html#a06da095e0c88cc65ac23e4ec88d0a390" title="rocksdb::Iterator::Next" alt="" coords="449,960,601,990"/><area shape="rect" id="node87" href="../../d2/d02/a00777.html#a99d2e05c952cecb0f4a0fa60412bafc2" title="rocksdb::Iterator::\lSeekToFirst" alt="" coords="463,1013,588,1060"/><area shape="rect" id="node92" href="../../d3/daa/a01577.html#a2bdd8a9595b621c43bb200a88383ce14" title="rocksdb::StressTest\l::MultiPut" alt="" coords="215,346,353,393"/><area shape="rect" id="node107" href="../../d3/daa/a01577.html#a2f06d21c3db820737ee52e79cc320896" title="rocksdb::StressTest\l::PrintKeyValue" alt="" coords="215,1170,353,1217"/><area shape="rect" id="node109" href="../../d8/ddd/a00380.html#a981f3dc15e13dd3cf31435ea2608414f" title="rocksdb::DB::Put" alt="" coords="223,240,345,270"/><area shape="rect" id="node115" href="../../de/daf/a01417.html#a5b27053d7804f8ba4a6430e001ce1c22" title="rocksdb::Slice::starts_with" alt="" coords="196,1240,372,1270"/><area shape="rect" id="node117" href="../../d2/d02/a00777.html#a5435c832490b19d4c3aebf7c4877098d" title="rocksdb::Iterator::\lstatus" alt="" coords="221,1293,347,1340"/><area shape="rect" id="node119" href="../../d2/d02/a00777.html#a866c8627787b3a768273ae4893f27f8f" title="rocksdb::Iterator::\lValid" alt="" coords="221,1362,347,1409"/><area shape="rect" id="node121" href="../../d3/daa/a01577.html#aa92ae3301b0fccf66dfc272634c09a4d" title="rocksdb::StressTest\l::VerifyValue" alt="" coords="215,997,353,1044"/><area shape="rect" id="node7" href="../../d2/dbd/a01844.html#a17803ddbf9875d6b0bbac1b310ae3846" title="rocksdb::WriteBatch\l::Delete" alt="" coords="455,341,596,388"/><area shape="rect" id="node26" href="../../d8/ddd/a00380.html#ad5d37a09e90d0c22c9a0adca87267ebc" title="rocksdb::DB::Write" alt="" coords="459,235,592,264"/><area shape="rect" id="node9" href="../../da/d8c/a01845.html#a3a404e8b1f29c53fc2d3b2a70dfb8478" title="rocksdb::WriteBatchInternal\l::Count" alt="" coords="677,253,861,300"/><area shape="rect" id="node13" href="../../d4/d87/a03436.html#af1cdcde94bcaeced42cd5925a5827232" title="rocksdb::PutLengthPrefixed\lSlice" alt="" coords="679,165,860,212"/><area shape="rect" id="node22" href="../../da/d8c/a01845.html#a5d61953d919f082c48c4d4aada512004" title="rocksdb::WriteBatchInternal\l::SetCount" alt="" coords="677,322,861,369"/><area shape="rect" id="node11" href="../../d4/d87/a03436.html#a5eb46c01bbc65cc301b2648e655dbe15" title="rocksdb::DecodeFixed32" alt="" coords="911,262,1076,291"/><area shape="rect" id="node16" href="../../d4/d87/a03436.html#afe24fa7da1cd551af92134aa66f96183" title="rocksdb::PutVarint32" alt="" coords="921,174,1065,203"/><area shape="rect" id="node18" href="../../d4/d87/a03436.html#a94c48680211f25845f5c35acd4b54ebb" title="rocksdb::EncodeVarint32" alt="" coords="1125,174,1293,203"/><area shape="rect" id="node24" href="../../d4/d87/a03436.html#aabc7ce45ae48e15b24a6756f9b4fd694" title="rocksdb::EncodeFixed32" alt="" coords="911,331,1076,360"/><area shape="rect" id="node34" href="../../d0/db9/a01552.html#a6679d2e36279094844a67acbb3cc3e5c" title="rocksdb::Status::code" alt="" coords="695,464,844,494"/><area shape="rect" id="node40" href="../../d2/dbd/a01844.html#ab2c611e4e5d774ecd115082bce617e7a" title="rocksdb::WriteBatch\l::Merge" alt="" coords="455,165,596,212"/><area shape="rect" id="node51" href="../../de/daf/a01417.html#ac5faa24d39a613c0ce7965d2bd9cf958" title="rocksdb::Slice::ToString" alt="" coords="444,464,607,494"/><area shape="rect" id="node53" href="../../d0/db9/a01552.html#ac02bdc6723705072a10111a99b4ca17c" title="rocksdb::Status::ToString" alt="" coords="440,411,611,440"/><area shape="rect" id="node60" href="../../d8/ddd/a00380.html#a09ad7c62dfe7e8739732d37041d058f9" title="rocksdb::DB::GetSnapshot" alt="" coords="436,731,615,760"/><area shape="rect" id="node64" href="../../d8/ddd/a00380.html#aedefaa4497eb584a45a818c0f05aff9b" title="rocksdb::DB::ReleaseSnapshot" alt="" coords="423,678,628,707"/><area shape="rect" id="node81" href="../../d0/db9/a01552.html#aceb84d55ae3b6bccf2a925433ca1ae00" title="rocksdb::Status::OK" alt="" coords="455,784,596,814"/><area shape="rect" id="node90" href="../../d2/d02/a00777.html#a1a503134af26025486d5c640e49cdf54" title="rocksdb::Iterator::\lvalue" alt="" coords="463,890,588,937"/><area shape="rect" id="node83" href="../../d0/db9/a01552.html#afcc875b53756534a635212b3d8f43864" title="rocksdb::Status::Status" alt="" coords="689,784,849,814"/><area shape="rect" id="node96" href="../../d2/dbd/a01844.html#ade37e4f14b7b0d1471365e5a7d85b678" title="rocksdb::WriteBatch::Put" alt="" coords="441,288,609,318"/><area shape="rect" id="node124" href="../../d3/daa/a01577.html#a7de186dfcaa8d7d09adc0661a9d685e7" title="rocksdb::StressTest\l::VerificationAbort" alt="" coords="456,1082,595,1129"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9e528c3bd9f2a38f3e3e83e51d1cb9ea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rocksdb::StressTest::PrintEnv </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01282">1282</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../db/d8b/a02594_source.html#l00021">FLAGS_write_buffer_size</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00052">rocksdb::kBZip2Compression</a>, <a class="el" href="../../d8/d70/a02629_source.html#l00026">rocksdb::kMajorVersion</a>, <a class="el" href="../../d8/d70/a02629_source.html#l00027">rocksdb::kMinorVersion</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00049">rocksdb::kNoCompression</a>, <a class="el" href="../../d9/d66/a02562_source.html#l00438">kPrefixHash</a>, <a class="el" href="../../d9/d66/a02562_source.html#l00437">kSkipList</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00050">rocksdb::kSnappyCompression</a>, <a class="el" href="../../d9/d66/a02562_source.html#l00439">kUnsorted</a>, <a class="el" href="../../d9/d66/a02562_source.html#l00440">kVectorRep</a>, <a class="el" href="../../d2/de3/a02637_source.html#l00051">rocksdb::kZlibCompression</a>, and <a class="el" href="../../db/d00/a02745_source.html#l00041">rocksdb::NumberToString()</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l00711">Run()</a>.</p>
<div class="fragment"><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                        {</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;LevelDB version     : %d.%d\n&quot;</span>,</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            <a class="code" href="../../d4/d87/a03436.html#ad1766a6dff1a323f457f2a1fcb826311">kMajorVersion</a>, <a class="code" href="../../d4/d87/a03436.html#a5dadfd46d8951a668f565ef65bb2837f">kMinorVersion</a>);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Number of threads   : %d\n&quot;</span>, FLAGS_threads);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    fprintf(stdout,</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;            <span class="stringliteral">&quot;Ops per thread      : %lu\n&quot;</span>,</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)FLAGS_ops_per_thread);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    std::string ttl_state(<span class="stringliteral">&quot;unused&quot;</span>);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordflow">if</span> (FLAGS_ttl &gt; 0) {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      ttl_state = <a class="code" href="../../d4/d87/a03436.html#af1a05c1be22f8139a04feb501896516e">NumberToString</a>(FLAGS_ttl);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Time to live(sec)   : %s\n&quot;</span>, ttl_state.c_str());</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Read percentage     : %d%%\n&quot;</span>, FLAGS_readpercent);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Prefix percentage   : %d%%\n&quot;</span>, FLAGS_prefixpercent);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Write percentage    : %d%%\n&quot;</span>, FLAGS_writepercent);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Delete percentage   : %d%%\n&quot;</span>, FLAGS_delpercent);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Iterate percentage  : %d%%\n&quot;</span>, FLAGS_iterpercent);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Write-buffer-size   : %d\n&quot;</span>, <a class="code" href="../../db/d8b/a02594.html#a95316c02ec448a6a8a0e169cdec69ab7">FLAGS_write_buffer_size</a>);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    fprintf(stdout,</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;            <span class="stringliteral">&quot;Iterations          : %lu\n&quot;</span>,</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;            (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)FLAGS_num_iterations);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    fprintf(stdout,</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            <span class="stringliteral">&quot;Max key             : %lu\n&quot;</span>,</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)FLAGS_max_key);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Ratio #ops/#keys    : %f\n&quot;</span>,</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            (1.0 * FLAGS_ops_per_thread * FLAGS_threads)/FLAGS_max_key);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Num times DB reopens: %d\n&quot;</span>, FLAGS_reopen);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Batches/snapshots   : %d\n&quot;</span>,</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            FLAGS_test_batches_snapshots);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Purge redundant %%   : %d\n&quot;</span>,</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            FLAGS_purge_redundant_percent);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Deletes use filter  : %d\n&quot;</span>,</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            FLAGS_filter_deletes);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Num keys per lock   : %d\n&quot;</span>,</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            1 &lt;&lt; FLAGS_log2_keys_per_lock);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* compression = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d6/d50/a02694.html#af71ac2e6eff51c7589ef372955e75f91">FLAGS_compression_type_e</a>) {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d4/d87/a03436.html#a8c3484ddfcf7ef9be3a93db6d37a997fad92180d74b867a024dfb04673e45d16e">rocksdb::kNoCompression</a>:</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        compression = <span class="stringliteral">&quot;none&quot;</span>;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d4/d87/a03436.html#a8c3484ddfcf7ef9be3a93db6d37a997fa1d91227622b08178bf3a93bc0ae08795">rocksdb::kSnappyCompression</a>:</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        compression = <span class="stringliteral">&quot;snappy&quot;</span>;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d4/d87/a03436.html#a8c3484ddfcf7ef9be3a93db6d37a997fa414b5a481db5bf9090586cb260bca67f">rocksdb::kZlibCompression</a>:</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        compression = <span class="stringliteral">&quot;zlib&quot;</span>;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d4/d87/a03436.html#a8c3484ddfcf7ef9be3a93db6d37a997fac2d8cc80946d825216035fc417b35bf0">rocksdb::kBZip2Compression</a>:</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        compression = <span class="stringliteral">&quot;bzip2&quot;</span>;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    }</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Compression         : %s\n&quot;</span>, compression);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* memtablerep = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d6/d50/a02694.html#ade812172c8bea7e0dd8e1828d05ea07d">FLAGS_rep_factory</a>) {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d66/a02562.html#a91adbbf592c06b8b3ff605b27753bb40adfe39d8993d004cc2c2a22526b81e92f">kSkipList</a>:</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        memtablerep = <span class="stringliteral">&quot;skip_list&quot;</span>;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d66/a02562.html#a91adbbf592c06b8b3ff605b27753bb40a4b3f7e848c89862fc673288d68b2e690">kPrefixHash</a>:</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        memtablerep = <span class="stringliteral">&quot;prefix_hash&quot;</span>;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d66/a02562.html#a91adbbf592c06b8b3ff605b27753bb40a77be1648a52aa05e537113e790091ace">kUnsorted</a>:</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        memtablerep = <span class="stringliteral">&quot;unsorted&quot;</span>;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d66/a02562.html#a91adbbf592c06b8b3ff605b27753bb40aa80dc44e28e3edb21643bd749df435c5">kVectorRep</a>:</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        memtablerep = <span class="stringliteral">&quot;vector&quot;</span>;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Memtablerep         : %s\n&quot;</span>, memtablerep);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;------------------------------------------------\n&quot;</span>);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a9e528c3bd9f2a38f3e3e83e51d1cb9ea_cgraph.png" border="0" usemap="#d3/daa/a01577_a9e528c3bd9f2a38f3e3e83e51d1cb9ea_cgraph" alt=""/></div>
<map name="d3/daa/a01577_a9e528c3bd9f2a38f3e3e83e51d1cb9ea_cgraph" id="d3/daa/a01577_a9e528c3bd9f2a38f3e3e83e51d1cb9ea_cgraph">
<area shape="rect" id="node3" href="../../d4/d87/a03436.html#af1a05c1be22f8139a04feb501896516e" title="rocksdb::NumberToString" alt="" coords="195,13,365,43"/><area shape="rect" id="node5" href="../../d4/d87/a03436.html#a6046b2d705859a672e4e63320133ee8e" title="rocksdb::AppendNumberTo" alt="" coords="413,13,595,43"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a9e528c3bd9f2a38f3e3e83e51d1cb9ea_icgraph.png" border="0" usemap="#d3/daa/a01577_a9e528c3bd9f2a38f3e3e83e51d1cb9ea_icgraph" alt=""/></div>
<map name="d3/daa/a01577_a9e528c3bd9f2a38f3e3e83e51d1cb9ea_icgraph" id="d3/daa/a01577_a9e528c3bd9f2a38f3e3e83e51d1cb9ea_icgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#af7e726bf27e216787e7c331834ec6075" title="rocksdb::StressTest::Run" alt="" coords="196,13,367,43"/><area shape="rect" id="node5" href="../../d6/d50/a02694.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="416,13,467,43"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2f06d21c3db820737ee52e79cc320896"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void rocksdb::StressTest::PrintKeyValue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d86/a02663.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01262">1262</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01042">OperateDb()</a>, and <a class="el" href="../../d6/d50/a02694_source.html#l01171">VerifyDb()</a>.</p>
<div class="fragment"><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                                                                        {</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="keywordflow">if</span> (!FLAGS_verbose) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;%u ==&gt; (%u) &quot;</span>, key, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)sz);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;sz; i++) {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      fprintf(stdout, <span class="stringliteral">&quot;%X&quot;</span>, <a class="code" href="../../d6/dfc/a02612.html#a38c8b88c432e666ad10b0c5573e1160a">value</a>[i]);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    }</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a2f06d21c3db820737ee52e79cc320896_icgraph.png" border="0" usemap="#d3/daa/a01577_a2f06d21c3db820737ee52e79cc320896_icgraph" alt=""/></div>
<map name="d3/daa/a01577_a2f06d21c3db820737ee52e79cc320896_icgraph" id="d3/daa/a01577_a2f06d21c3db820737ee52e79cc320896_icgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#af55a36a036e7348d3442400c050df2ee" title="rocksdb::StressTest\l::OperateDb" alt="" coords="196,5,335,51"/><area shape="rect" id="node5" href="../../d3/daa/a01577.html#a6de00ffdf29abe06157c824d53060f84" title="rocksdb::StressTest\l::VerifyDb" alt="" coords="196,74,335,121"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a84f4aa2eb69053e5e7332d3d27fa9742"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rocksdb::StressTest::PrintStatistics </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01482">1482</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l00711">Run()</a>.</p>
<div class="fragment"><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                         {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/d50/a02694.html#a213985cd230b559ca8411792c3aed1d0">dbstats</a>) {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      fprintf(stdout, <span class="stringliteral">&quot;STATISTICS:\n%s\n&quot;</span>, <a class="code" href="../../d6/d50/a02694.html#a213985cd230b559ca8411792c3aed1d0">dbstats</a>-&gt;ToString().c_str());</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    }</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a84f4aa2eb69053e5e7332d3d27fa9742_icgraph.png" border="0" usemap="#d3/daa/a01577_a84f4aa2eb69053e5e7332d3d27fa9742_icgraph" alt=""/></div>
<map name="d3/daa/a01577_a84f4aa2eb69053e5e7332d3d27fa9742_icgraph" id="d3/daa/a01577_a84f4aa2eb69053e5e7332d3d27fa9742_icgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#af7e726bf27e216787e7c331834ec6075" title="rocksdb::StressTest::Run" alt="" coords="196,13,367,43"/><area shape="rect" id="node5" href="../../d6/d50/a02694.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="416,13,467,43"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeac9f55bde5a11da0fcc2c88465de0c6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rocksdb::StressTest::Reopen </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01464">1464</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../d6/d50/a02694_source.html#l01493">db_</a>, <a class="el" href="../../db/db1/a00460.html#a20e69bbefe7d92b92a2f33100cf251b7">rocksdb::Env::NowMicros()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01495">num_times_reopened_</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01357">Open()</a>, and <a class="el" href="../../db/db1/a00460.html#ade1259f3f43b344b56b69b5b007d979b">rocksdb::Env::TimeToString()</a>.</p>
<div class="fragment"><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                {</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="comment">// do not close the db. Just delete the lock file. This</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="comment">// simulates a crash-recovery kind of situation.</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keywordflow">if</span> (FLAGS_ttl != -1) {</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      ((DBWithTTL*) <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>)-&gt;TEST_Destroy_DBWithTtl();</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      ((DBImpl*) <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>)-&gt;TEST_Destroy_DBImpl();</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    }</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <a class="code" href="../../d3/daa/a01577.html#a92d72a91fe1e5e44c9914d60d6318719">num_times_reopened_</a>++;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="keywordtype">double</span> now = <a class="code" href="../../d6/d50/a02694.html#a1217d1ecddbf658a860dcc8d313b2381">FLAGS_env</a>-&gt;<a class="code" href="../../db/db1/a00460.html#a20e69bbefe7d92b92a2f33100cf251b7">NowMicros</a>();</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;%s Reopening database for the %dth time\n&quot;</span>,</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            <a class="code" href="../../d6/d50/a02694.html#a1217d1ecddbf658a860dcc8d313b2381">FLAGS_env</a>-&gt;<a class="code" href="../../db/db1/a00460.html#ade1259f3f43b344b56b69b5b007d979b">TimeToString</a>((<a class="code" href="../../db/d86/a02663.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a>) now/1000000).c_str(),</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            <a class="code" href="../../d3/daa/a01577.html#a92d72a91fe1e5e44c9914d60d6318719">num_times_reopened_</a>);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <a class="code" href="../../d3/daa/a01577.html#abd8a7f61f0b14b85acd87a4d77a6e394">Open</a>();</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_aeac9f55bde5a11da0fcc2c88465de0c6_cgraph.png" border="0" usemap="#d3/daa/a01577_aeac9f55bde5a11da0fcc2c88465de0c6_cgraph" alt=""/></div>
<map name="d3/daa/a01577_aeac9f55bde5a11da0fcc2c88465de0c6_cgraph" id="d3/daa/a01577_aeac9f55bde5a11da0fcc2c88465de0c6_cgraph">
<area shape="rect" id="node3" href="../../db/db1/a00460.html#a20e69bbefe7d92b92a2f33100cf251b7" title="rocksdb::Env::NowMicros" alt="" coords="1292,271,1465,301"/><area shape="rect" id="node5" href="../../d3/daa/a01577.html#abd8a7f61f0b14b85acd87a4d77a6e394" title="rocksdb::StressTest\l::Open" alt="" coords="219,536,357,583"/><area shape="rect" id="node128" href="../../db/db1/a00460.html#ade1259f3f43b344b56b69b5b007d979b" title="rocksdb::Env::TimeToString" alt="" coords="196,606,380,635"/><area shape="rect" id="node7" href="../../db/dbf/a00975.html#ad9603085b9c846fef61b60aa0c465484" title="rocksdb::MergeOperators\l::CreatePutOperator" alt="" coords="460,567,628,613"/><area shape="rect" id="node9" href="../../d4/d87/a03436.html#a827f732f23df3c1faf2427a0288b40a4" title="rocksdb::NewFixedPrefixTransform" alt="" coords="431,637,657,666"/><area shape="rect" id="node11" href="../../d8/ddd/a00380.html#a898ece06bdc8a5ec59e5996a01f2650d" title="rocksdb::DB::Open" alt="" coords="477,514,611,543"/><area shape="rect" id="node121" href="../../d9/d02/a01774.html#a79510d4196fd7a17b72e30ca82749de9" title="rocksdb::UtilityDB\l::OpenTtlDB" alt="" coords="480,1347,608,1393"/><area shape="rect" id="node124" href="../../d9/d25/a01157.html#a71e653793b2f7189d61dcbc263ece2ed" title="rocksdb::Random::Uniform" alt="" coords="455,259,633,289"/><area shape="rect" id="node13" href="../../dd/df5/a00386.html#acef475ae9fa32c7caf0ba839f056d89c" title="rocksdb::DBImpl::CreateArchival\lDirectory" alt="" coords="711,164,924,211"/><area shape="rect" id="node17" href="../../db/db1/a00460.html#a52a10880d70d77d1dcad9f2fb20ce171" title="rocksdb::Env::CreateDirIf\lMissing" alt="" coords="1015,219,1185,265"/><area shape="rect" id="node24" href="../../dd/df5/a00386.html#a4406b5ed5487f7562bd0fe1696c6092f" title="rocksdb::DBImpl::DeleteObsolete\lFiles" alt="" coords="708,505,927,552"/><area shape="rect" id="node36" href="../../d4/d87/a03436.html#ad2e1157820fce4ccbfc1846e12be2477" title="rocksdb::LogFileName" alt="" coords="1303,522,1455,551"/><area shape="rect" id="node40" href="../../d0/db9/a01552.html#a63cba37f62403ccc2f3e8b0b8ee04425" title="rocksdb::Status::ok" alt="" coords="1311,1581,1447,1610"/><area shape="rect" id="node44" href="../../d0/db9/a01552.html#a5afec51a3f306b6f188a5af0c5d003ba" title="rocksdb::Status::Invalid\lArgument" alt="" coords="1020,1104,1180,1151"/><area shape="rect" id="node47" href="../../d9/d9a/a00998.html#a5d2f9be842f9982681ca8ff36f935596" title="rocksdb::port::Mutex\l::Lock" alt="" coords="747,289,888,336"/><area shape="rect" id="node52" href="../../dd/df5/a00386.html#a6f3ccd58266e8fd7a1b513ebef01928a" title="rocksdb::DBImpl::MaybeSchedule\lFlushOrCompaction" alt="" coords="707,643,928,689"/><area shape="rect" id="node65" href="../../dd/df5/a00386.html#a4ab5900a7770dcb2a687bfd41269f2df" title="rocksdb::DBImpl::MaybeSchedule\lLogDBDeployStats" alt="" coords="707,845,928,892"/><area shape="rect" id="node74" href="../../db/db1/a00460.html#a2415186e0a399d70edabef9f477e4c47" title="rocksdb::Env::NewWritableFile" alt="" coords="1277,1942,1480,1971"/><area shape="rect" id="node76" href="../../dd/df5/a00386.html#aaecfe0733c5634343143bf3e9f705880" title="rocksdb::DBImpl::NumberLevels" alt="" coords="1273,1865,1484,1894"/><area shape="rect" id="node79" href="../../dd/df5/a00386.html#afe079cf353957e6c79ed794cbc0bb9fc" title="rocksdb::DBImpl::Recover" alt="" coords="729,1339,905,1369"/><area shape="rect" id="node116" href="../../d3/dcd/a00965.html#a81f80d2b6674d454e4b65f238281d716" title="rocksdb::MemTable::\lSetLogNumber" alt="" coords="745,367,889,413"/><area shape="rect" id="node118" href="../../d9/d9a/a00998.html#a73a5db74971add43b1762259a8e171f1" title="rocksdb::port::Mutex\l::Unlock" alt="" coords="747,436,888,483"/><area shape="rect" id="node15" href="../../d4/d87/a03436.html#a546d3e2e5c3b4aa8ee9828c7b519d501" title="rocksdb::ArchivalDirectory" alt="" coords="1012,115,1188,145"/><area shape="rect" id="node19" href="../../d0/db9/a01552.html#aceb84d55ae3b6bccf2a925433ca1ae00" title="rocksdb::Status::OK" alt="" coords="1308,193,1449,222"/><area shape="rect" id="node21" href="../../d0/db9/a01552.html#afcc875b53756534a635212b3d8f43864" title="rocksdb::Status::Status" alt="" coords="1536,1113,1696,1142"/><area shape="rect" id="node26" href="../../d9/d9a/a00998.html#adc55e4555301d02ced0ec883bc6cd4f6" title="rocksdb::port::Mutex\l::AssertHeld" alt="" coords="1308,452,1449,499"/><area shape="rect" id="node28" href="../../dd/df5/a00386.html#a3683f24e767a6e83d03acab509c64ba8" title="rocksdb::DBImpl::FindObsolete\lFiles" alt="" coords="997,341,1203,388"/><area shape="rect" id="node34" href="../../dd/df5/a00386.html#a9b3b0cce1e70a97d4d797ba7d5511dd5" title="rocksdb::DBImpl::PurgeObsolete\lFiles" alt="" coords="993,512,1207,559"/><area shape="rect" id="node31" href="../../db/db1/a00460.html#aebd6a4aac30704da29fecf45a9da21d6" title="rocksdb::Env::GetChildren" alt="" coords="1291,375,1467,405"/><area shape="rect" id="node42" href="../../d4/d87/a03436.html#ad3fcb7354969b5ea357d56b2d02362fc" title="rocksdb::ParseFileName" alt="" coords="1296,1167,1461,1197"/><area shape="rect" id="node38" href="../../d4/d87/a03436.html#a645cac7eafed2fae5df45e8483f8fbaf" title="rocksdb::MakeFileName" alt="" coords="1535,522,1697,551"/><area shape="rect" id="node49" href="../../d8/df7/a03469.html#aceefae455e28f4218993e00e08321dff" title="rocksdb::port::PthreadCall" alt="" coords="1013,289,1187,318"/><area shape="rect" id="node54" href="../../de/d76/a00134.html#a3df03b47d7c561143fd1ac591207e2cf" title="rocksdb::port::AtomicPointer\l::Acquire_Load" alt="" coords="1007,811,1193,857"/><area shape="rect" id="node57" href="../../dd/df5/a00386.html#a0f92fd02fffbe404bbdffc1bd24195d7" title="rocksdb::DBImpl::BGWorkCompaction" alt="" coords="976,651,1224,681"/><area shape="rect" id="node59" href="../../dd/df5/a00386.html#a7f35702e61b4f7ec3eb12e91432dca47" title="rocksdb::DBImpl::BGWorkFlush" alt="" coords="995,705,1205,734"/><area shape="rect" id="node61" href="../../d7/dd4/a00968.html#a95a7b2d65fbe38706615b07eafd3cb36" title="rocksdb::MemTableList\l::IsFlushPending" alt="" coords="1021,581,1179,628"/><area shape="rect" id="node63" href="../../db/db1/a00460.html#a4367e6868093755a80234295a1c21867" title="rocksdb::Env::Schedule" alt="" coords="1020,758,1180,787"/><area shape="rect" id="node68" href="../../dd/df5/a00386.html#a3b86ec3494acbb6dbb8f2fdace967183" title="rocksdb::DBImpl::BGLogDBDeploy\lStats" alt="" coords="987,880,1213,927"/><area shape="rect" id="node70" href="../../db/db1/a00460.html#a70ed14df4e067de0f2a8a09010eaf31b" title="rocksdb::Env::GetCurrentTime" alt="" coords="1000,950,1200,979"/><area shape="rect" id="node82" href="../../d0/db9/a01552.html#a585d7fbcadd8858734f534519290035d" title="rocksdb::Status::Corruption" alt="" coords="1288,1223,1469,1253"/><area shape="rect" id="node86" href="../../d4/d87/a03436.html#a112e8c44dec6475699006a7f68830b1a" title="rocksdb::CurrentFileName" alt="" coords="1013,1659,1187,1689"/><area shape="rect" id="node88" href="../../db/db1/a00460.html#a8b523020a36e640a4820edc5535a8808" title="rocksdb::Env::FileExists" alt="" coords="1017,1395,1183,1425"/><area shape="rect" id="node91" href="../../d4/d87/a03436.html#ae569241bbac7237a7c1bdb1d2ebff31e" title="rocksdb::IdentityFileName" alt="" coords="1292,1710,1465,1739"/><area shape="rect" id="node94" href="../../db/db1/a00460.html#a680d05d86580d65e4c1cfe16dd099385" title="rocksdb::Env::LockFile" alt="" coords="1023,1449,1177,1478"/><area shape="rect" id="node96" href="../../d4/d87/a03436.html#a820e85c65a3dad99ec67d4414c1b8ccb" title="rocksdb::LockFileName" alt="" coords="1020,1502,1180,1531"/><area shape="rect" id="node98" href="../../dd/df5/a00386.html#adca3cc37d179c0402363d4cae6529d72" title="rocksdb::DBImpl::NewDB" alt="" coords="1013,1865,1187,1894"/><area shape="rect" id="node105" href="../../dd/df5/a00386.html#adb8cf2e0f98f8368db32bea16bcf3cb7" title="rocksdb::DBImpl::Recover\lLogFile" alt="" coords="1012,1275,1188,1321"/><area shape="rect" id="node112" href="../../d4/d87/a03436.html#a27807ffab7c639e7f7615cd5456efcb1" title="rocksdb::SetIdentityFile" alt="" coords="1020,1606,1180,1635"/><area shape="rect" id="node126" href="../../d9/d25/a01157.html#a520efcab691df60bc48d1fe7251f1cd5" title="rocksdb::Random::Next" alt="" coords="737,59,897,89"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af7e726bf27e216787e7c331834ec6075"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rocksdb::StressTest::Run </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l00711">711</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../db/db1/a00460.html#a20e69bbefe7d92b92a2f33100cf251b7">rocksdb::Env::NowMicros()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01357">Open()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01282">PrintEnv()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01482">PrintStatistics()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00666">shared</a>, <a class="el" href="../../db/db1/a00460.html#a1f316d7bbe5cc3e9d833bd57e34c62aa">rocksdb::Env::StartThread()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00667">stats</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00777">ThreadBody()</a>, and <a class="el" href="../../db/db1/a00460.html#ade1259f3f43b344b56b69b5b007d979b">rocksdb::Env::TimeToString()</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01502">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;             {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="../../d3/daa/a01577.html#a9e528c3bd9f2a38f3e3e83e51d1cb9ea">PrintEnv</a>();</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="../../d3/daa/a01577.html#abd8a7f61f0b14b85acd87a4d77a6e394">Open</a>();</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    SharedState <a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <a class="code" href="../../db/d86/a02663.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> n = <a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>.GetNumThreads();</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    std::vector&lt;ThreadState*&gt; threads(n);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../db/d86/a02663.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> i = 0; i &lt; n; i++) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      threads[i] = <span class="keyword">new</span> ThreadState(i, &amp;<a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <a class="code" href="../../d6/d50/a02694.html#a1217d1ecddbf658a860dcc8d313b2381">FLAGS_env</a>-&gt;<a class="code" href="../../db/db1/a00460.html#a1f316d7bbe5cc3e9d833bd57e34c62aa">StartThread</a>(<a class="code" href="../../d3/daa/a01577.html#ad15a841e44071e594e280bebb7045d08">ThreadBody</a>, threads[i]);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="comment">// Each thread goes through the following states:</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="comment">// initializing -&gt; wait for others to init -&gt; read/populate/depopulate</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">// wait for others to operate -&gt; verify -&gt; done</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      MutexLock l(<a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>.GetMutex());</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      <span class="keywordflow">while</span> (!<a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>.AllInitialized()) {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>.GetCondVar()-&gt;Wait();</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="keywordtype">double</span> now = <a class="code" href="../../d6/d50/a02694.html#a1217d1ecddbf658a860dcc8d313b2381">FLAGS_env</a>-&gt;<a class="code" href="../../db/db1/a00460.html#a20e69bbefe7d92b92a2f33100cf251b7">NowMicros</a>();</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      fprintf(stdout, <span class="stringliteral">&quot;%s Starting database operations\n&quot;</span>,</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;              <a class="code" href="../../d6/d50/a02694.html#a1217d1ecddbf658a860dcc8d313b2381">FLAGS_env</a>-&gt;<a class="code" href="../../db/db1/a00460.html#ade1259f3f43b344b56b69b5b007d979b">TimeToString</a>((<a class="code" href="../../db/d86/a02663.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a>) now/1000000).c_str());</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>.SetStart();</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>.GetCondVar()-&gt;SignalAll();</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <span class="keywordflow">while</span> (!<a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>.AllOperated()) {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>.GetCondVar()-&gt;Wait();</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      now = <a class="code" href="../../d6/d50/a02694.html#a1217d1ecddbf658a860dcc8d313b2381">FLAGS_env</a>-&gt;<a class="code" href="../../db/db1/a00460.html#a20e69bbefe7d92b92a2f33100cf251b7">NowMicros</a>();</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="keywordflow">if</span> (FLAGS_test_batches_snapshots) {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        fprintf(stdout, <span class="stringliteral">&quot;%s Limited verification already done during gets\n&quot;</span>,</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                <a class="code" href="../../d6/d50/a02694.html#a1217d1ecddbf658a860dcc8d313b2381">FLAGS_env</a>-&gt;<a class="code" href="../../db/db1/a00460.html#ade1259f3f43b344b56b69b5b007d979b">TimeToString</a>((<a class="code" href="../../db/d86/a02663.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a>) now/1000000).c_str());</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        fprintf(stdout, <span class="stringliteral">&quot;%s Starting verification\n&quot;</span>,</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                <a class="code" href="../../d6/d50/a02694.html#a1217d1ecddbf658a860dcc8d313b2381">FLAGS_env</a>-&gt;<a class="code" href="../../db/db1/a00460.html#ade1259f3f43b344b56b69b5b007d979b">TimeToString</a>((<a class="code" href="../../db/d86/a02663.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a>) now/1000000).c_str());</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>.SetStartVerify();</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>.GetCondVar()-&gt;SignalAll();</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="keywordflow">while</span> (!<a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>.AllDone()) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>.GetCondVar()-&gt;Wait();</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; n; i++) {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      threads[0]-&gt;stats.Merge(threads[i]-&gt;<a class="code" href="../../d6/d50/a02694.html#a5925d216740c89f43482df806fd14e8c">stats</a>);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    threads[0]-&gt;stats.Report(<span class="stringliteral">&quot;Stress Test&quot;</span>);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n; i++) {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <span class="keyword">delete</span> threads[i];</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      threads[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordtype">double</span> now = <a class="code" href="../../d6/d50/a02694.html#a1217d1ecddbf658a860dcc8d313b2381">FLAGS_env</a>-&gt;<a class="code" href="../../db/db1/a00460.html#a20e69bbefe7d92b92a2f33100cf251b7">NowMicros</a>();</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">if</span> (!FLAGS_test_batches_snapshots) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      fprintf(stdout, <span class="stringliteral">&quot;%s Verification successful\n&quot;</span>,</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;              <a class="code" href="../../d6/d50/a02694.html#a1217d1ecddbf658a860dcc8d313b2381">FLAGS_env</a>-&gt;<a class="code" href="../../db/db1/a00460.html#ade1259f3f43b344b56b69b5b007d979b">TimeToString</a>((<a class="code" href="../../db/d86/a02663.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a>) now/1000000).c_str());</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <a class="code" href="../../d3/daa/a01577.html#a84f4aa2eb69053e5e7332d3d27fa9742">PrintStatistics</a>();</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_af7e726bf27e216787e7c331834ec6075_cgraph.png" border="0" usemap="#d3/daa/a01577_af7e726bf27e216787e7c331834ec6075_cgraph" alt=""/></div>
<map name="d3/daa/a01577_af7e726bf27e216787e7c331834ec6075_cgraph" id="d3/daa/a01577_af7e726bf27e216787e7c331834ec6075_cgraph">
<area shape="rect" id="node3" href="../../db/db1/a00460.html#a20e69bbefe7d92b92a2f33100cf251b7" title="rocksdb::Env::NowMicros" alt="" coords="1305,297,1479,326"/><area shape="rect" id="node5" href="../../d3/daa/a01577.html#abd8a7f61f0b14b85acd87a4d77a6e394" title="rocksdb::StressTest\l::Open" alt="" coords="251,194,389,240"/><area shape="rect" id="node105" href="../../d3/daa/a01577.html#a9e528c3bd9f2a38f3e3e83e51d1cb9ea" title="rocksdb::StressTest\l::PrintEnv" alt="" coords="251,263,389,310"/><area shape="rect" id="node111" href="../../d3/daa/a01577.html#a84f4aa2eb69053e5e7332d3d27fa9742" title="rocksdb::StressTest\l::PrintStatistics" alt="" coords="251,332,389,379"/><area shape="rect" id="node113" href="../../db/db1/a00460.html#a1f316d7bbe5cc3e9d833bd57e34c62aa" title="rocksdb::Env::StartThread" alt="" coords="233,402,407,432"/><area shape="rect" id="node115" href="../../d3/daa/a01577.html#ad15a841e44071e594e280bebb7045d08" title="rocksdb::StressTest\l::ThreadBody" alt="" coords="251,455,389,502"/><area shape="rect" id="node117" href="../../db/db1/a00460.html#ade1259f3f43b344b56b69b5b007d979b" title="rocksdb::Env::TimeToString" alt="" coords="228,525,412,554"/><area shape="rect" id="node7" href="../../db/dbf/a00975.html#ad9603085b9c846fef61b60aa0c465484" title="rocksdb::MergeOperators\l::CreatePutOperator" alt="" coords="492,132,660,179"/><area shape="rect" id="node9" href="../../d4/d87/a03436.html#a827f732f23df3c1faf2427a0288b40a4" title="rocksdb::NewFixedPrefixTransform" alt="" coords="463,202,689,232"/><area shape="rect" id="node11" href="../../d8/ddd/a00380.html#a898ece06bdc8a5ec59e5996a01f2650d" title="rocksdb::DB::Open" alt="" coords="509,1085,643,1114"/><area shape="rect" id="node98" href="../../d9/d02/a01774.html#a79510d4196fd7a17b72e30ca82749de9" title="rocksdb::UtilityDB\l::OpenTtlDB" alt="" coords="512,63,640,110"/><area shape="rect" id="node101" href="../../d9/d25/a01157.html#a71e653793b2f7189d61dcbc263ece2ed" title="rocksdb::Random::Uniform" alt="" coords="487,256,665,285"/><area shape="rect" id="node13" href="../../dd/df5/a00386.html#acef475ae9fa32c7caf0ba839f056d89c" title="rocksdb::DBImpl::CreateArchival\lDirectory" alt="" coords="743,1391,956,1438"/><area shape="rect" id="node17" href="../../db/db1/a00460.html#a52a10880d70d77d1dcad9f2fb20ce171" title="rocksdb::Env::CreateDirIf\lMissing" alt="" coords="1047,1362,1217,1408"/><area shape="rect" id="node24" href="../../dd/df5/a00386.html#a4406b5ed5487f7562bd0fe1696c6092f" title="rocksdb::DBImpl::DeleteObsolete\lFiles" alt="" coords="740,816,959,863"/><area shape="rect" id="node36" href="../../d4/d87/a03436.html#ad2e1157820fce4ccbfc1846e12be2477" title="rocksdb::LogFileName" alt="" coords="1316,1094,1468,1124"/><area shape="rect" id="node40" href="../../d0/db9/a01552.html#a63cba37f62403ccc2f3e8b0b8ee04425" title="rocksdb::Status::ok" alt="" coords="1324,636,1460,665"/><area shape="rect" id="node42" href="../../d0/db9/a01552.html#a5afec51a3f306b6f188a5af0c5d003ba" title="rocksdb::Status::Invalid\lArgument" alt="" coords="1052,1292,1212,1339"/><area shape="rect" id="node45" href="../../d9/d9a/a00998.html#a5d2f9be842f9982681ca8ff36f935596" title="rocksdb::port::Mutex\l::Lock" alt="" coords="779,1460,920,1507"/><area shape="rect" id="node50" href="../../dd/df5/a00386.html#a6f3ccd58266e8fd7a1b513ebef01928a" title="rocksdb::DBImpl::MaybeSchedule\lFlushOrCompaction" alt="" coords="739,295,960,342"/><area shape="rect" id="node63" href="../../dd/df5/a00386.html#a4ab5900a7770dcb2a687bfd41269f2df" title="rocksdb::DBImpl::MaybeSchedule\lLogDBDeployStats" alt="" coords="739,480,960,527"/><area shape="rect" id="node72" href="../../db/db1/a00460.html#a2415186e0a399d70edabef9f477e4c47" title="rocksdb::Env::NewWritableFile" alt="" coords="748,584,951,613"/><area shape="rect" id="node74" href="../../dd/df5/a00386.html#aaecfe0733c5634343143bf3e9f705880" title="rocksdb::DBImpl::NumberLevels" alt="" coords="744,764,955,793"/><area shape="rect" id="node77" href="../../dd/df5/a00386.html#afe079cf353957e6c79ed794cbc0bb9fc" title="rocksdb::DBImpl::Recover" alt="" coords="761,1085,937,1114"/><area shape="rect" id="node93" href="../../d3/dcd/a00965.html#a81f80d2b6674d454e4b65f238281d716" title="rocksdb::MemTable::\lSetLogNumber" alt="" coords="777,1220,921,1267"/><area shape="rect" id="node95" href="../../d9/d9a/a00998.html#a73a5db74971add43b1762259a8e171f1" title="rocksdb::port::Mutex\l::Unlock" alt="" coords="779,1530,920,1576"/><area shape="rect" id="node15" href="../../d4/d87/a03436.html#a546d3e2e5c3b4aa8ee9828c7b519d501" title="rocksdb::ArchivalDirectory" alt="" coords="1044,1432,1220,1461"/><area shape="rect" id="node19" href="../../d0/db9/a01552.html#aceb84d55ae3b6bccf2a925433ca1ae00" title="rocksdb::Status::OK" alt="" coords="1061,1485,1203,1514"/><area shape="rect" id="node21" href="../../d0/db9/a01552.html#afcc875b53756534a635212b3d8f43864" title="rocksdb::Status::Status" alt="" coords="1312,1301,1472,1330"/><area shape="rect" id="node26" href="../../d9/d9a/a00998.html#adc55e4555301d02ced0ec883bc6cd4f6" title="rocksdb::port::Mutex\l::AssertHeld" alt="" coords="1321,752,1463,799"/><area shape="rect" id="node28" href="../../dd/df5/a00386.html#a3683f24e767a6e83d03acab509c64ba8" title="rocksdb::DBImpl::FindObsolete\lFiles" alt="" coords="1029,687,1235,734"/><area shape="rect" id="node34" href="../../dd/df5/a00386.html#a9b3b0cce1e70a97d4d797ba7d5511dd5" title="rocksdb::DBImpl::PurgeObsolete\lFiles" alt="" coords="1025,756,1239,803"/><area shape="rect" id="node31" href="../../db/db1/a00460.html#aebd6a4aac30704da29fecf45a9da21d6" title="rocksdb::Env::GetChildren" alt="" coords="1304,946,1480,976"/><area shape="rect" id="node38" href="../../d4/d87/a03436.html#a645cac7eafed2fae5df45e8483f8fbaf" title="rocksdb::MakeFileName" alt="" coords="1529,1094,1692,1124"/><area shape="rect" id="node47" href="../../d8/df7/a03469.html#aceefae455e28f4218993e00e08321dff" title="rocksdb::port::PthreadCall" alt="" coords="1045,1538,1219,1568"/><area shape="rect" id="node52" href="../../de/d76/a00134.html#a3df03b47d7c561143fd1ac591207e2cf" title="rocksdb::port::AtomicPointer\l::Acquire_Load" alt="" coords="1039,340,1225,387"/><area shape="rect" id="node55" href="../../dd/df5/a00386.html#a0f92fd02fffbe404bbdffc1bd24195d7" title="rocksdb::DBImpl::BGWorkCompaction" alt="" coords="1008,114,1256,144"/><area shape="rect" id="node57" href="../../dd/df5/a00386.html#a7f35702e61b4f7ec3eb12e91432dca47" title="rocksdb::DBImpl::BGWorkFlush" alt="" coords="1027,168,1237,197"/><area shape="rect" id="node59" href="../../d7/dd4/a00968.html#a95a7b2d65fbe38706615b07eafd3cb36" title="rocksdb::MemTableList\l::IsFlushPending" alt="" coords="1053,220,1211,267"/><area shape="rect" id="node61" href="../../db/db1/a00460.html#a4367e6868093755a80234295a1c21867" title="rocksdb::Env::Schedule" alt="" coords="1052,410,1212,440"/><area shape="rect" id="node66" href="../../dd/df5/a00386.html#a3b86ec3494acbb6dbb8f2fdace967183" title="rocksdb::DBImpl::BGLogDBDeploy\lStats" alt="" coords="1019,567,1245,614"/><area shape="rect" id="node68" href="../../db/db1/a00460.html#a70ed14df4e067de0f2a8a09010eaf31b" title="rocksdb::Env::GetCurrentTime" alt="" coords="1032,514,1232,544"/><area shape="rect" id="node80" href="../../d0/db9/a01552.html#a585d7fbcadd8858734f534519290035d" title="rocksdb::Status::Corruption" alt="" coords="1041,1240,1223,1269"/><area shape="rect" id="node84" href="../../d4/d87/a03436.html#a112e8c44dec6475699006a7f68830b1a" title="rocksdb::CurrentFileName" alt="" coords="1045,1032,1219,1061"/><area shape="rect" id="node86" href="../../db/db1/a00460.html#a8b523020a36e640a4820edc5535a8808" title="rocksdb::Env::FileExists" alt="" coords="1049,1085,1215,1114"/><area shape="rect" id="node89" href="../../d4/d87/a03436.html#ae569241bbac7237a7c1bdb1d2ebff31e" title="rocksdb::IdentityFileName" alt="" coords="1045,978,1219,1008"/><area shape="rect" id="node103" href="../../d9/d25/a01157.html#a520efcab691df60bc48d1fe7251f1cd5" title="rocksdb::Random::Next" alt="" coords="769,242,929,272"/><area shape="rect" id="node107" href="../../d4/d87/a03436.html#af1a05c1be22f8139a04feb501896516e" title="rocksdb::NumberToString" alt="" coords="491,1369,661,1398"/><area shape="rect" id="node109" href="../../d4/d87/a03436.html#a6046b2d705859a672e4e63320133ee8e" title="rocksdb::AppendNumberTo" alt="" coords="759,1600,940,1629"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_af7e726bf27e216787e7c331834ec6075_icgraph.png" border="0" usemap="#d3/daa/a01577_af7e726bf27e216787e7c331834ec6075_icgraph" alt=""/></div>
<map name="d3/daa/a01577_af7e726bf27e216787e7c331834ec6075_icgraph" id="d3/daa/a01577_af7e726bf27e216787e7c331834ec6075_icgraph">
<area shape="rect" id="node3" href="../../d6/d50/a02694.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="227,5,277,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad15a841e44071e594e280bebb7045d08"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void rocksdb::StressTest::ThreadBody </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>v</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l00777">777</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../d6/d50/a02694_source.html#l00666">shared</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l00711">Run()</a>.</p>
<div class="fragment"><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                                  {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    ThreadState* thread = <span class="keyword">reinterpret_cast&lt;</span>ThreadState*<span class="keyword">&gt;</span>(v);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    SharedState* <a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a> = thread-&gt;shared;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      MutexLock l(shared-&gt;GetMutex());</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      shared-&gt;IncInitialized();</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordflow">if</span> (shared-&gt;AllInitialized()) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        shared-&gt;GetCondVar()-&gt;SignalAll();</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordflow">while</span> (!shared-&gt;Started()) {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        shared-&gt;GetCondVar()-&gt;Wait();</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    thread-&gt;shared-&gt;GetStressTest()-&gt;OperateDb(thread);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      MutexLock l(shared-&gt;GetMutex());</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      shared-&gt;IncOperated();</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordflow">if</span> (shared-&gt;AllOperated()) {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        shared-&gt;GetCondVar()-&gt;SignalAll();</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keywordflow">while</span> (!shared-&gt;VerifyStarted()) {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        shared-&gt;GetCondVar()-&gt;Wait();</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">if</span> (!FLAGS_test_batches_snapshots) {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      thread-&gt;shared-&gt;GetStressTest()-&gt;VerifyDb(thread);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      MutexLock l(shared-&gt;GetMutex());</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      shared-&gt;IncDone();</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">if</span> (shared-&gt;AllDone()) {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        shared-&gt;GetCondVar()-&gt;SignalAll();</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_ad15a841e44071e594e280bebb7045d08_icgraph.png" border="0" usemap="#d3/daa/a01577_ad15a841e44071e594e280bebb7045d08_icgraph" alt=""/></div>
<map name="d3/daa/a01577_ad15a841e44071e594e280bebb7045d08_icgraph" id="d3/daa/a01577_ad15a841e44071e594e280bebb7045d08_icgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#af7e726bf27e216787e7c331834ec6075" title="rocksdb::StressTest::Run" alt="" coords="196,13,367,43"/><area shape="rect" id="node5" href="../../d6/d50/a02694.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="416,13,467,43"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7de186dfcaa8d7d09adc0661a9d685e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rocksdb::StressTest::VerificationAbort </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01225">1225</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01171">VerifyDb()</a>, and <a class="el" href="../../d6/d50/a02694_source.html#l01231">VerifyValue()</a>.</p>
<div class="fragment"><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                                        {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Verification failed for key %ld: %s\n&quot;</span>,</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            key, msg.c_str());</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    exit(1);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a7de186dfcaa8d7d09adc0661a9d685e7_icgraph.png" border="0" usemap="#d3/daa/a01577_a7de186dfcaa8d7d09adc0661a9d685e7_icgraph" alt=""/></div>
<map name="d3/daa/a01577_a7de186dfcaa8d7d09adc0661a9d685e7_icgraph" id="d3/daa/a01577_a7de186dfcaa8d7d09adc0661a9d685e7_icgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#a6de00ffdf29abe06157c824d53060f84" title="rocksdb::StressTest\l::VerifyDb" alt="" coords="385,5,524,51"/><area shape="rect" id="node5" href="../../d3/daa/a01577.html#aa92ae3301b0fccf66dfc272634c09a4d" title="rocksdb::StressTest\l::VerifyValue" alt="" coords="196,65,335,111"/><area shape="rect" id="node7" href="../../d3/daa/a01577.html#af55a36a036e7348d3442400c050df2ee" title="rocksdb::StressTest\l::OperateDb" alt="" coords="385,74,524,121"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6de00ffdf29abe06157c824d53060f84"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rocksdb::StressTest::VerifyDb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d54/a01691.html">ThreadState</a> *&#160;</td>
          <td class="paramname"><em>thread</em>)</td><td></td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01171">1171</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../d6/d50/a02694_source.html#l01493">db_</a>, <a class="el" href="../../d8/ddd/a00380.html#ae6350a924ad1ac1129726e384a487da3">rocksdb::DB::Get()</a>, <a class="el" href="../../d8/ddd/a00380.html#a4aaff1029d25cb3717189d841746ad54">rocksdb::DB::NewIterator()</a>, <a class="el" href="../../d5/d96/a02642_source.html#l00039">rocksdb::Status::NotFound()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01262">PrintKeyValue()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00666">shared</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01225">VerificationAbort()</a>, and <a class="el" href="../../d6/d50/a02694_source.html#l01231">VerifyValue()</a>.</p>
<div class="fragment"><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                                           {</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    ReadOptions options(FLAGS_verify_checksum, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keyword">const</span> SharedState&amp; <a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a> = *(thread-&gt;shared);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">long</span> max_key = shared.GetMaxKey();</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">long</span> keys_per_thread = max_key / shared.GetNumThreads();</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordtype">long</span> start = keys_per_thread * thread-&gt;tid;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordtype">long</span> end = start + keys_per_thread;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordflow">if</span> (thread-&gt;tid == shared.GetNumThreads() - 1) {</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      end = max_key;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    }</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">if</span> (!thread-&gt;rand.OneIn(2)) {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      <span class="comment">// Use iterator to verify this range</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      unique_ptr&lt;Iterator&gt; iter(<a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#a4aaff1029d25cb3717189d841746ad54">NewIterator</a>(options));</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      iter-&gt;Seek(<a class="code" href="../../d4/d87/a03436.html#a9d8a21180881a482389bfe3baefa105a">Key</a>(start));</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i = start; i &lt; end; i++) {</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        std::string from_db;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        std::string keystr = <a class="code" href="../../d4/d87/a03436.html#a9d8a21180881a482389bfe3baefa105a">Key</a>(i);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        Slice k = keystr;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <a class="code" href="../../d9/d2c/a03421.html#af127c2e4fc73b5d35647147ef45b350c">Status</a> s = iter-&gt;status();</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordflow">if</span> (iter-&gt;Valid()) {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;          <span class="keywordflow">if</span> (iter-&gt;key().compare(k) &gt; 0) {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            s = <a class="code" href="../../d0/db9/a01552.html#a415510a7cc15542538c80c790d2bb4af">Status::NotFound</a>(Slice());</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iter-&gt;key().compare(k) == 0) {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            from_db = iter-&gt;value().ToString();</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;            iter-&gt;Next();</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iter-&gt;key().compare(k) &lt; 0) {</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;            <a class="code" href="../../d3/daa/a01577.html#a7de186dfcaa8d7d09adc0661a9d685e7">VerificationAbort</a>(<span class="stringliteral">&quot;An out of range key was found&quot;</span>, i);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;          }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;          <span class="comment">// The iterator found no value for the key in question, so do not</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;          <span class="comment">// move to the next item in the iterator</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;          s = <a class="code" href="../../d0/db9/a01552.html#a415510a7cc15542538c80c790d2bb4af">Status::NotFound</a>(Slice());</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        }</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <a class="code" href="../../d3/daa/a01577.html#aa92ae3301b0fccf66dfc272634c09a4d">VerifyValue</a>(i, options, shared, from_db, s, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        <span class="keywordflow">if</span> (from_db.length()) {</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;          <a class="code" href="../../d3/daa/a01577.html#a2f06d21c3db820737ee52e79cc320896">PrintKeyValue</a>(i, from_db.data(), from_db.length());</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      }</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    }</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="comment">// Use Get to verify this range</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i = start; i &lt; end; i++) {</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        std::string from_db;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        std::string keystr = <a class="code" href="../../d4/d87/a03436.html#a9d8a21180881a482389bfe3baefa105a">Key</a>(i);</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        Slice k = keystr;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <a class="code" href="../../d9/d2c/a03421.html#af127c2e4fc73b5d35647147ef45b350c">Status</a> s = <a class="code" href="../../d3/daa/a01577.html#a2c94ae9cdf0828a5212a6949514eaf1e">db_</a>-&gt;<a class="code" href="../../d8/ddd/a00380.html#ae6350a924ad1ac1129726e384a487da3">Get</a>(options, k, &amp;from_db);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <a class="code" href="../../d3/daa/a01577.html#aa92ae3301b0fccf66dfc272634c09a4d">VerifyValue</a>(i, options, shared, from_db, s, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <span class="keywordflow">if</span> (from_db.length()) {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;          <a class="code" href="../../d3/daa/a01577.html#a2f06d21c3db820737ee52e79cc320896">PrintKeyValue</a>(i, from_db.data(), from_db.length());</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        }</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      }</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    }</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_a6de00ffdf29abe06157c824d53060f84_cgraph.png" border="0" usemap="#d3/daa/a01577_a6de00ffdf29abe06157c824d53060f84_cgraph" alt=""/></div>
<map name="d3/daa/a01577_a6de00ffdf29abe06157c824d53060f84_cgraph" id="d3/daa/a01577_a6de00ffdf29abe06157c824d53060f84_cgraph">
<area shape="rect" id="node3" href="../../d8/ddd/a00380.html#ae6350a924ad1ac1129726e384a487da3" title="rocksdb::DB::Get" alt="" coords="223,5,345,35"/><area shape="rect" id="node5" href="../../d8/ddd/a00380.html#a4aaff1029d25cb3717189d841746ad54" title="rocksdb::DB::NewIterator" alt="" coords="199,59,369,88"/><area shape="rect" id="node7" href="../../d0/db9/a01552.html#a415510a7cc15542538c80c790d2bb4af" title="rocksdb::Status::NotFound" alt="" coords="195,112,373,141"/><area shape="rect" id="node11" href="../../d3/daa/a01577.html#a2f06d21c3db820737ee52e79cc320896" title="rocksdb::StressTest\l::PrintKeyValue" alt="" coords="215,165,353,211"/><area shape="rect" id="node13" href="../../d3/daa/a01577.html#a7de186dfcaa8d7d09adc0661a9d685e7" title="rocksdb::StressTest\l::VerificationAbort" alt="" coords="432,223,571,270"/><area shape="rect" id="node15" href="../../d3/daa/a01577.html#aa92ae3301b0fccf66dfc272634c09a4d" title="rocksdb::StressTest\l::VerifyValue" alt="" coords="215,285,353,331"/><area shape="rect" id="node9" href="../../d0/db9/a01552.html#afcc875b53756534a635212b3d8f43864" title="rocksdb::Status::Status" alt="" coords="421,112,581,141"/><area shape="rect" id="node17" href="../../d0/db9/a01552.html#a63cba37f62403ccc2f3e8b0b8ee04425" title="rocksdb::Status::ok" alt="" coords="433,293,569,323"/><area shape="rect" id="node20" href="../../d3/daa/a01577.html#a3a1d745ffde52899ed449cfc8eb5c177" title="rocksdb::StressTest\l::GenerateValue" alt="" coords="432,346,571,393"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa92ae3301b0fccf66dfc272634c09a4d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rocksdb::StressTest::VerifyValue </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d3f/a01215.html">ReadOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/d8e/a01390.html">SharedState</a> &amp;&#160;</td>
          <td class="paramname"><em>shared</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>value_from_db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/db9/a01552.html">Status</a>&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>strict</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01231">1231</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>References <a class="el" href="../../d6/d50/a02694_source.html#l01271">GenerateValue()</a>, <a class="el" href="../../d5/d96/a02642_source.html#l00062">rocksdb::Status::ok()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00515">SENTINEL</a>, <a class="el" href="../../d6/dfc/a02612_source.html#l00288">value</a>, and <a class="el" href="../../d6/d50/a02694_source.html#l01225">VerificationAbort()</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01042">OperateDb()</a>, and <a class="el" href="../../d6/d50/a02694_source.html#l01171">VerifyDb()</a>.</p>
<div class="fragment"><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                                            {</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="comment">// compare value_from_db with the value in the shared state</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="../../d6/dfc/a02612.html#a38c8b88c432e666ad10b0c5573e1160a">value</a>[100];</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <a class="code" href="../../db/d86/a02663.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> value_base = <a class="code" href="../../d6/d50/a02694.html#af670cad03774a4316fb28a8634d33a56">shared</a>.Get(key);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordflow">if</span> (value_base == <a class="code" href="../../d6/d50/a02694.html#a62c6550720ea60ca1143442434e0281a">SharedState::SENTINEL</a> &amp;&amp; !strict) {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <span class="keywordflow">if</span> (value_base == <a class="code" href="../../d6/d50/a02694.html#a62c6550720ea60ca1143442434e0281a">SharedState::SENTINEL</a>) {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <a class="code" href="../../d3/daa/a01577.html#a7de186dfcaa8d7d09adc0661a9d685e7">VerificationAbort</a>(<span class="stringliteral">&quot;Unexpected value found&quot;</span>, key);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <span class="keywordtype">size_t</span> sz = <a class="code" href="../../d3/daa/a01577.html#a3a1d745ffde52899ed449cfc8eb5c177">GenerateValue</a>(value_base, value, <span class="keyword">sizeof</span>(value));</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      <span class="keywordflow">if</span> (value_from_db.length() != sz) {</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <a class="code" href="../../d3/daa/a01577.html#a7de186dfcaa8d7d09adc0661a9d685e7">VerificationAbort</a>(<span class="stringliteral">&quot;Length of value read is not equal&quot;</span>, key);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="keywordflow">if</span> (memcmp(value_from_db.data(), <a class="code" href="../../d6/dfc/a02612.html#a38c8b88c432e666ad10b0c5573e1160a">value</a>, sz) != 0) {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <a class="code" href="../../d3/daa/a01577.html#a7de186dfcaa8d7d09adc0661a9d685e7">VerificationAbort</a>(<span class="stringliteral">&quot;Contents of value read don&#39;t match&quot;</span>, key);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      }</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <span class="keywordflow">if</span> (value_base != <a class="code" href="../../d6/d50/a02694.html#a62c6550720ea60ca1143442434e0281a">SharedState::SENTINEL</a>) {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <a class="code" href="../../d3/daa/a01577.html#a7de186dfcaa8d7d09adc0661a9d685e7">VerificationAbort</a>(<span class="stringliteral">&quot;Value not found&quot;</span>, key);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      }</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_aa92ae3301b0fccf66dfc272634c09a4d_cgraph.png" border="0" usemap="#d3/daa/a01577_aa92ae3301b0fccf66dfc272634c09a4d_cgraph" alt=""/></div>
<map name="d3/daa/a01577_aa92ae3301b0fccf66dfc272634c09a4d_cgraph" id="d3/daa/a01577_aa92ae3301b0fccf66dfc272634c09a4d_cgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#a3a1d745ffde52899ed449cfc8eb5c177" title="rocksdb::StressTest\l::GenerateValue" alt="" coords="196,5,335,51"/><area shape="rect" id="node5" href="../../d0/db9/a01552.html#a63cba37f62403ccc2f3e8b0b8ee04425" title="rocksdb::Status::ok" alt="" coords="197,75,333,104"/><area shape="rect" id="node7" href="../../d3/daa/a01577.html#a7de186dfcaa8d7d09adc0661a9d685e7" title="rocksdb::StressTest\l::VerificationAbort" alt="" coords="196,127,335,174"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daa/a01577_aa92ae3301b0fccf66dfc272634c09a4d_icgraph.png" border="0" usemap="#d3/daa/a01577_aa92ae3301b0fccf66dfc272634c09a4d_icgraph" alt=""/></div>
<map name="d3/daa/a01577_aa92ae3301b0fccf66dfc272634c09a4d_icgraph" id="d3/daa/a01577_aa92ae3301b0fccf66dfc272634c09a4d_icgraph">
<area shape="rect" id="node3" href="../../d3/daa/a01577.html#af55a36a036e7348d3442400c050df2ee" title="rocksdb::StressTest\l::OperateDb" alt="" coords="196,5,335,51"/><area shape="rect" id="node5" href="../../d3/daa/a01577.html#a6de00ffdf29abe06157c824d53060f84" title="rocksdb::StressTest\l::VerifyDb" alt="" coords="196,74,335,121"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="aaf65c1865167c51f2243f5db7afbeac2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">shared_ptr&lt;<a class="el" href="../../d4/d9a/a00246.html">Cache</a>&gt; rocksdb::StressTest::cache_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01489">1489</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01357">Open()</a>.</p>

</div>
</div>
<a class="anchor" id="ad11df1e28fafa7a1c8a83eb3a0ac8430"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">shared_ptr&lt;<a class="el" href="../../d4/d9a/a00246.html">Cache</a>&gt; rocksdb::StressTest::compressed_cache_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01490">1490</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01357">Open()</a>.</p>

</div>
</div>
<a class="anchor" id="a2c94ae9cdf0828a5212a6949514eaf1e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/ddd/a00380.html">DB</a>* rocksdb::StressTest::db_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01493">1493</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l00856">MultiDelete()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00884">MultiGet()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01013">MultiIterate()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00941">MultiPrefixScan()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00821">MultiPut()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01357">Open()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01042">OperateDb()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01464">Reopen()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l01171">VerifyDb()</a>, and <a class="el" href="../../d6/d50/a02694_source.html#l00705">~StressTest()</a>.</p>

</div>
</div>
<a class="anchor" id="af2fa51ee1d1aeee82f60d94773decf5d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../dd/de9/a00552.html">FilterPolicy</a>* rocksdb::StressTest::filter_policy_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01491">1491</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01357">Open()</a>, and <a class="el" href="../../d6/d50/a02694_source.html#l00705">~StressTest()</a>.</p>

</div>
</div>
<a class="anchor" id="a92d72a91fe1e5e44c9914d60d6318719"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int rocksdb::StressTest::num_times_reopened_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01495">1495</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01464">Reopen()</a>.</p>

</div>
</div>
<a class="anchor" id="a997c0fe78e2af6cbb86f71a3c2b0a3ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d0/d7d/a01419.html">SliceTransform</a>* rocksdb::StressTest::prefix_extractor_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01492">1492</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01357">Open()</a>, and <a class="el" href="../../d6/d50/a02694_source.html#l00705">~StressTest()</a>.</p>

</div>
</div>
<a class="anchor" id="a8bc0db0055b9a7059c2c42ac478e2713"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d03/a01491.html">StackableDB</a>* rocksdb::StressTest::sdb_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d50/a02694_source.html#l01494">1494</a> of file <a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d50/a02694_source.html#l01357">Open()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>rippled/src/ripple/rocksdb/rocksdb/tools/<a class="el" href="../../d6/d50/a02694_source.html">db_stress.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d4/d87/a03436.html">rocksdb</a></li><li class="navelem"><a class="el" href="../../d3/daa/a01577.html">StressTest</a></li>
    <li class="footer">Generated on Fri May 2 2014 05:29:23 for rippled by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
