<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>rippled: ripple::SHAMapSync_test Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">rippled
   &#160;<span id="projectnumber">0.24.0-rc1</span>
   </div>
   <div id="projectbrief">Reference implementation of the Ripple Protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d2/dff/a01374.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="../../d6/dcc/a07596.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ripple::SHAMapSync_test Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for ripple::SHAMapSync_test:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/d12/a07597.png" border="0" usemap="#ripple_1_1_s_h_a_map_sync__test_inherit__map" alt="Inheritance graph"/></div>
<map name="ripple_1_1_s_h_a_map_sync__test_inherit__map" id="ripple_1_1_s_h_a_map_sync__test_inherit__map">
<area shape="rect" id="node2" href="../../db/dfd/a01608.html" title="beast::unit_test::suite" alt="" coords="19,5,165,35"/></map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for ripple::SHAMapSync_test:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/da8/a07598.png" border="0" usemap="#ripple_1_1_s_h_a_map_sync__test_coll__map" alt="Collaboration graph"/></div>
<map name="ripple_1_1_s_h_a_map_sync__test_coll__map" id="ripple_1_1_s_h_a_map_sync__test_coll__map">
<area shape="rect" id="node2" href="../../db/dfd/a01608.html" title="beast::unit_test::suite" alt="" coords="19,216,165,245"/><area shape="rect" id="node4" href="../../d5/dd3/a00902.html" title="beast::unit_test::suite\l::log_t" alt="" coords="19,102,165,149"/><area shape="rect" id="node6" href="../../d2/d4c/a01307.html" title="beast::unit_test::runner" alt="" coords="104,5,259,35"/><area shape="rect" id="node8" href="../../db/dfd/a01576.html" title="beast::unit_test::runner\l::stream_t" alt="" coords="192,102,347,149"/><area shape="rect" id="node10" href="../../d1/db7/a00157.html" title="abstract_ostream" alt="" coords="291,5,413,35"/></map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4980e73f9977797e9a455330fb52debe"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dff/a01374.html#a4980e73f9977797e9a455330fb52debe">confuseMap</a> (<a class="el" href="../../d6/dfe/a01366.html">SHAMap</a> &amp;map, int count)</td></tr>
<tr class="separator:a4980e73f9977797e9a455330fb52debe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ba8e3ec0d8dca936347a2d58b235116"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dff/a01374.html#a5ba8e3ec0d8dca936347a2d58b235116">run</a> ()</td></tr>
<tr class="separator:a5ba8e3ec0d8dca936347a2d58b235116"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_a01608"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_a01608')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../db/dfd/a01608.html">beast::unit_test::suite</a></td></tr>
<tr class="memitem:af6bf687768de255399aea05ca1f47e66 inherit pub_methods_a01608"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dfd/a01608.html#af6bf687768de255399aea05ca1f47e66">operator()</a> (<a class="el" href="../../d2/d4c/a01307.html">runner</a> &amp;r)</td></tr>
<tr class="separator:af6bf687768de255399aea05ca1f47e66 inherit pub_methods_a01608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02554fbd9200fc71efa03e2cf3430424 inherit pub_methods_a01608"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dfd/a01608.html#a02554fbd9200fc71efa03e2cf3430424">testcase</a> (std::string const &amp;<a class="el" href="../../dc/d40/a02767.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <a class="el" href="../../db/dfd/a01608.html#ad0c7d3bddd5fdbf959a5e5f18bb1ba9e">abort_t</a> abort=<a class="el" href="../../db/dfd/a01608.html#ad0c7d3bddd5fdbf959a5e5f18bb1ba9eaa0219c2c5644b3f15e7f3dfede350c9d">no_abort_on_fail</a>)</td></tr>
<tr class="separator:a02554fbd9200fc71efa03e2cf3430424 inherit pub_methods_a01608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b888660b6ebcdd2e0c0a9685051c05a inherit pub_methods_a01608"><td class="memTemplParams" colspan="2">template&lt;class Condition &gt; </td></tr>
<tr class="memitem:a1b888660b6ebcdd2e0c0a9685051c05a inherit pub_methods_a01608"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../db/dfd/a01608.html#a1b888660b6ebcdd2e0c0a9685051c05a">expect</a> (Condition shouldBeTrue, std::string const &amp;reason=&quot;&quot;)</td></tr>
<tr class="separator:a1b888660b6ebcdd2e0c0a9685051c05a inherit pub_methods_a01608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83dda01dd12e6a769717874095d928b4 inherit pub_methods_a01608"><td class="memTemplParams" colspan="2">template&lt;class Condition &gt; </td></tr>
<tr class="memitem:a83dda01dd12e6a769717874095d928b4 inherit pub_methods_a01608"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../db/dfd/a01608.html#a83dda01dd12e6a769717874095d928b4">unexpected</a> (Condition shouldBeFalse, std::string const &amp;reason=&quot;&quot;)</td></tr>
<tr class="separator:a83dda01dd12e6a769717874095d928b4 inherit pub_methods_a01608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9062ee09b5c077d08e6ab2ae4f72f83 inherit pub_methods_a01608"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dfd/a01608.html#ac9062ee09b5c077d08e6ab2ae4f72f83">pass</a> ()</td></tr>
<tr class="separator:ac9062ee09b5c077d08e6ab2ae4f72f83 inherit pub_methods_a01608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12ac06a598408212221270d1d8cbdd4e inherit pub_methods_a01608"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dfd/a01608.html#a12ac06a598408212221270d1d8cbdd4e">fail</a> (std::string const &amp;reason=&quot;&quot;)</td></tr>
<tr class="separator:a12ac06a598408212221270d1d8cbdd4e inherit pub_methods_a01608"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a42c4ced1602649a465695aaefccef24b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d8/dbe/a01370.html#a1005ad7946f0ee9bd4a1d932d80a4863">SHAMapItem::pointer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dff/a01374.html#a42c4ced1602649a465695aaefccef24b">makeRandomAS</a> ()</td></tr>
<tr class="separator:a42c4ced1602649a465695aaefccef24b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_a01608"><td colspan="2" onclick="javascript:toggleInherit('pub_types_a01608')"><img src="../../closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="../../db/dfd/a01608.html">beast::unit_test::suite</a></td></tr>
<tr class="memitem:ad0c7d3bddd5fdbf959a5e5f18bb1ba9e inherit pub_types_a01608"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dfd/a01608.html#ad0c7d3bddd5fdbf959a5e5f18bb1ba9e">abort_t</a> { <a class="el" href="../../db/dfd/a01608.html#ad0c7d3bddd5fdbf959a5e5f18bb1ba9eaa0219c2c5644b3f15e7f3dfede350c9d">no_abort_on_fail</a>, 
<a class="el" href="../../db/dfd/a01608.html#ad0c7d3bddd5fdbf959a5e5f18bb1ba9ea430169d3252104f8529f01d4a9ac3cf6">abort_on_fail</a>
 }</td></tr>
<tr class="separator:ad0c7d3bddd5fdbf959a5e5f18bb1ba9e inherit pub_types_a01608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eda4a0f28ecf4f873712b3addb8ba7d inherit pub_types_a01608"><td class="memItemLeft" align="right" valign="top">typedef <br class="typebreak"/>
<a class="el" href="../../d1/db7/a00157.html#a2035776b51feb87547c07ce230380e05">abstract_ostream::scoped_stream_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dfd/a01608.html#a5eda4a0f28ecf4f873712b3addb8ba7d">scoped_stream</a></td></tr>
<tr class="separator:a5eda4a0f28ecf4f873712b3addb8ba7d inherit pub_types_a01608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_a01608"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_a01608')"><img src="../../closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="../../db/dfd/a01608.html">beast::unit_test::suite</a></td></tr>
<tr class="memitem:a4fe23233b5c8ac9b426c0135a723d50e inherit pub_attribs_a01608"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd3/a00902.html">log_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dfd/a01608.html#a4fe23233b5c8ac9b426c0135a723d50e">log</a></td></tr>
<tr class="separator:a4fe23233b5c8ac9b426c0135a723d50e inherit pub_attribs_a01608"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="../../d5/d7f/a03036_source.html#l00738">738</a> of file <a class="el" href="../../d5/d7f/a03036_source.html">SHAMapSync.cpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a4980e73f9977797e9a455330fb52debe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ripple::SHAMapSync_test::confuseMap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/dfe/a01366.html">SHAMap</a> &amp;&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d7f/a03036_source.html#l00750">750</a> of file <a class="el" href="../../d5/d7f/a03036_source.html">SHAMapSync.cpp</a>.</p>

<p>References <a class="el" href="../../dd/da3/a03026_source.html#l00853">ripple::SHAMap::addItem()</a>, <a class="el" href="../../dd/da3/a03026_source.html#l00681">ripple::SHAMap::delItem()</a>, <a class="el" href="../../dd/da9/a03027_source.html#l00133">ripple::SHAMap::getHash()</a>, <a class="el" href="../../d0/d79/a02117_source.html#l00114">beast::unit_test::suite::log</a>, and <a class="el" href="../../d5/d7f/a03036_source.html#l00741">makeRandomAS()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d7f/a03036_source.html#l00791">run()</a>.</p>
<div class="fragment"><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="comment">// add a bunch of random states to a map, then remove them</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="comment">// map should be the same</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        uint256 beforeHash = map.getHash ();</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        std::list&lt;uint256&gt; items;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; ++i)</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <a class="code" href="../../d8/dbe/a01370.html#a1005ad7946f0ee9bd4a1d932d80a4863">SHAMapItem::pointer</a> item = <a class="code" href="../../d2/dff/a01374.html#a42c4ced1602649a465695aaefccef24b">makeRandomAS</a> ();</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            items.push_back (item-&gt;getTag ());</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <span class="keywordflow">if</span> (!map.addItem (*item, <span class="keyword">false</span>, <span class="keyword">false</span>))</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                <a class="code" href="../../db/dfd/a01608.html#a4fe23233b5c8ac9b426c0135a723d50e">log</a> &lt;&lt;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                    <span class="stringliteral">&quot;Unable to add item to map&quot;</span>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="keywordflow">for</span> (std::list&lt;uint256&gt;::iterator it = items.begin (); it != items.end (); ++it)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <span class="keywordflow">if</span> (!map.delItem (*it))</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                <a class="code" href="../../db/dfd/a01608.html#a4fe23233b5c8ac9b426c0135a723d50e">log</a> &lt;&lt;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                    <span class="stringliteral">&quot;Unable to remove item from map&quot;</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keywordflow">if</span> (beforeHash != map.getHash ())</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <a class="code" href="../../db/dfd/a01608.html#a4fe23233b5c8ac9b426c0135a723d50e">log</a> &lt;&lt;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                <span class="stringliteral">&quot;Hashes do not match&quot;</span>;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/dff/a01374_a4980e73f9977797e9a455330fb52debe_cgraph.png" border="0" usemap="#d2/dff/a01374_a4980e73f9977797e9a455330fb52debe_cgraph" alt=""/></div>
<map name="d2/dff/a01374_a4980e73f9977797e9a455330fb52debe_cgraph" id="d2/dff/a01374_a4980e73f9977797e9a455330fb52debe_cgraph">
<area shape="rect" id="node3" href="../../d6/dfe/a01366.html#a680c64ea3a24815047908a6838e68452" title="ripple::SHAMap::addItem" alt="" coords="199,5,367,35"/><area shape="rect" id="node5" href="../../d6/dfe/a01366.html#ad34b4b3f4c26154a0ad8e63ada075f88" title="ripple::SHAMap::delItem" alt="" coords="200,59,365,88"/><area shape="rect" id="node11" href="../../d6/dfe/a01366.html#aae2210273f3f0f8fb068ad523d600b86" title="ripple::SHAMap::getHash" alt="" coords="197,112,368,141"/><area shape="rect" id="node13" href="../../d2/dff/a01374.html#a42c4ced1602649a465695aaefccef24b" title="ripple::SHAMapSync\l_test::makeRandomAS" alt="" coords="204,177,361,223"/><area shape="rect" id="node7" href="../../d7/d9a/a00152.html#a3fa11a064a87fe4e970f00d661287dd2" title="ripple::base_uint::\lisNonZero" alt="" coords="425,38,551,85"/><area shape="rect" id="node9" href="../../d7/d9a/a00152.html#a25e873c7d069c6c2d44655736f2b6c21" title="ripple::base_uint::\lisZero" alt="" coords="620,38,745,85"/><area shape="rect" id="node15" href="../../da/d61/a01350.html#a4f09dcca07217744f793fa7473e845fe" title="ripple::Serializer\l::add32" alt="" coords="431,107,545,154"/><area shape="rect" id="node17" href="../../da/d61/a01350.html#a82d28c080fe71a0abcfde31015517222" title="ripple::Serializer\l::getRIPEMD160" alt="" coords="427,177,549,223"/><area shape="rect" id="node19" href="../../df/d2e/a01737.html#a4910213305fcb5b9f712e0e1706ffaac" title="ripple::uint160::to256" alt="" coords="417,247,559,276"/><area shape="rect" id="node27" href="../../da/d61/a01350.html#a460460eaf22f52170a4e451471f0c19c" title="ripple::Serializer\l::peekData" alt="" coords="431,299,545,346"/><area shape="rect" id="node21" href="../../d7/d9a/a00152.html#a05af5cdcc33627cb359debe028ab675d" title="ripple::base_uint::\lbegin" alt="" coords="620,207,745,254"/><area shape="rect" id="node25" href="../../d7/d9a/a00152.html#a463054abe1fe73a6f2d2dd9ecc9fb544" title="ripple::base_uint::size" alt="" coords="608,277,757,307"/><area shape="rect" id="node23" href="../../d7/d9a/a00152.html#af39117db8d26ecef7a570cd3448822a6" title="ripple::base_uint::data" alt="" coords="807,216,956,245"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/dff/a01374_a4980e73f9977797e9a455330fb52debe_icgraph.png" border="0" usemap="#d2/dff/a01374_a4980e73f9977797e9a455330fb52debe_icgraph" alt=""/></div>
<map name="d2/dff/a01374_a4980e73f9977797e9a455330fb52debe_icgraph" id="d2/dff/a01374_a4980e73f9977797e9a455330fb52debe_icgraph">
<area shape="rect" id="node3" href="../../d2/dff/a01374.html#a5ba8e3ec0d8dca936347a2d58b235116" title="ripple::SHAMapSync\l_test::run" alt="" coords="197,5,341,51"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a42c4ced1602649a465695aaefccef24b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d8/dbe/a01370.html#a1005ad7946f0ee9bd4a1d932d80a4863">SHAMapItem::pointer</a> ripple::SHAMapSync_test::makeRandomAS </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d7f/a03036_source.html#l00741">741</a> of file <a class="el" href="../../d5/d7f/a03036_source.html">SHAMapSync.cpp</a>.</p>

<p>References <a class="el" href="../../dc/ddd/a03196_source.html#l00044">ripple::Serializer::add32()</a>, <a class="el" href="../../dc/ddd/a03196_source.html#l00322">ripple::Serializer::getRIPEMD160()</a>, <a class="el" href="../../dd/d61/a03197_source.html#l00125">ripple::Serializer::peekData()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00665">rand</a>, and <a class="el" href="../../d0/de4/a02851_source.html#l00022">ripple::uint160::to256()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d7f/a03036_source.html#l00750">confuseMap()</a>, and <a class="el" href="../../d5/d7f/a03036_source.html#l00791">run()</a>.</p>
<div class="fragment"><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        Serializer s;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; 3; ++d) s.add32 (<a class="code" href="../../d6/d50/a02694.html#a2391b9dab13f09bae65ae349c8d4c271">rand</a> ());</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">return</span> boost::make_shared&lt;SHAMapItem&gt; (s.getRIPEMD160 ().to256 (), s.peekData ());</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/dff/a01374_a42c4ced1602649a465695aaefccef24b_cgraph.png" border="0" usemap="#d2/dff/a01374_a42c4ced1602649a465695aaefccef24b_cgraph" alt=""/></div>
<map name="d2/dff/a01374_a42c4ced1602649a465695aaefccef24b_cgraph" id="d2/dff/a01374_a42c4ced1602649a465695aaefccef24b_cgraph">
<area shape="rect" id="node3" href="../../da/d61/a01350.html#a4f09dcca07217744f793fa7473e845fe" title="ripple::Serializer\l::add32" alt="" coords="228,5,343,51"/><area shape="rect" id="node5" href="../../da/d61/a01350.html#a82d28c080fe71a0abcfde31015517222" title="ripple::Serializer\l::getRIPEMD160" alt="" coords="224,74,347,121"/><area shape="rect" id="node7" href="../../da/d61/a01350.html#a460460eaf22f52170a4e451471f0c19c" title="ripple::Serializer\l::peekData" alt="" coords="228,143,343,190"/><area shape="rect" id="node9" href="../../df/d2e/a01737.html#a4910213305fcb5b9f712e0e1706ffaac" title="ripple::uint160::to256" alt="" coords="215,213,356,243"/><area shape="rect" id="node11" href="../../d7/d9a/a00152.html#a05af5cdcc33627cb359debe028ab675d" title="ripple::base_uint::\lbegin" alt="" coords="417,174,543,221"/><area shape="rect" id="node15" href="../../d7/d9a/a00152.html#a463054abe1fe73a6f2d2dd9ecc9fb544" title="ripple::base_uint::size" alt="" coords="405,244,555,273"/><area shape="rect" id="node13" href="../../d7/d9a/a00152.html#af39117db8d26ecef7a570cd3448822a6" title="ripple::base_uint::data" alt="" coords="604,183,753,212"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/dff/a01374_a42c4ced1602649a465695aaefccef24b_icgraph.png" border="0" usemap="#d2/dff/a01374_a42c4ced1602649a465695aaefccef24b_icgraph" alt=""/></div>
<map name="d2/dff/a01374_a42c4ced1602649a465695aaefccef24b_icgraph" id="d2/dff/a01374_a42c4ced1602649a465695aaefccef24b_icgraph">
<area shape="rect" id="node3" href="../../d2/dff/a01374.html#a4980e73f9977797e9a455330fb52debe" title="ripple::SHAMapSync\l_test::confuseMap" alt="" coords="213,5,357,51"/><area shape="rect" id="node5" href="../../d2/dff/a01374.html#a5ba8e3ec0d8dca936347a2d58b235116" title="ripple::SHAMapSync\l_test::run" alt="" coords="405,35,549,82"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5ba8e3ec0d8dca936347a2d58b235116"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ripple::SHAMapSync_test::run </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Runs the suite. </p>

<p>Implements <a class="el" href="../../db/dfd/a01608.html#aea7ffa0eca5e015d21be62a18adb8393">beast::unit_test::suite</a>.</p>

<p>Definition at line <a class="el" href="../../d5/d7f/a03036_source.html#l00791">791</a> of file <a class="el" href="../../d5/d7f/a03036_source.html">SHAMapSync.cpp</a>.</p>

<p>References <a class="el" href="../../dd/da3/a03026_source.html#l00853">ripple::SHAMap::addItem()</a>, <a class="el" href="../../d5/d7f/a03036_source.html#l00419">ripple::SHAMap::addKnownNode()</a>, <a class="el" href="../../d5/d7f/a03036_source.html#l00383">ripple::SHAMap::addRootNode()</a>, <a class="el" href="../../dd/da9/a03027_source.html#l00196">ripple::SHAMap::clearSynching()</a>, <a class="el" href="../../d5/d7f/a03036_source.html#l00750">confuseMap()</a>, <a class="el" href="../../d5/d7f/a03036_source.html#l00491">ripple::SHAMap::deepCompare()</a>, <a class="el" href="../../d0/d79/a02117_source.html#l00207">beast::unit_test::suite::fail()</a>, <a class="el" href="../../d1/da0/a02416_source.html#l00037">ripple::get_seconds_clock()</a>, <a class="el" href="../../d5/d7f/a03036_source.html#l00118">ripple::SHAMap::getMissingNodes()</a>, <a class="el" href="../../d5/d7f/a03036_source.html#l00273">ripple::SHAMap::getNodeFat()</a>, <a class="el" href="../../de/dae/a03028_source.html#l00086">ripple::SHAMapAddNode::isGood()</a>, <a class="el" href="../../d8/d4b/a03093_source.html#l00033">ripple::lsFATAL</a>, <a class="el" href="../../d8/d4b/a03093_source.html#l00030">ripple::lsINFO</a>, <a class="el" href="../../d8/d4b/a03093_source.html#l00028">ripple::lsTRACE</a>, <a class="el" href="../../d5/d7f/a03036_source.html#l00741">makeRandomAS()</a>, <a class="el" href="../../d0/d79/a02117_source.html#l00200">beast::unit_test::suite::pass()</a>, <a class="el" href="../../d6/d50/a02694_source.html#l00665">rand</a>, <a class="el" href="../../dd/da9/a03027_source.html#l00175">ripple::SHAMap::setImmutable()</a>, <a class="el" href="../../dd/da9/a03027_source.html#l00188">ripple::SHAMap::setSynching()</a>, <a class="el" href="../../d6/def/a03033_source.html#l00029">ripple::smtFREE</a>, <a class="el" href="../../dc/d23/a03041_source.html#l00030">ripple::snfWIRE</a>, <a class="el" href="../../d0/d79/a02117_source.html#l00189">beast::unit_test::suite::unexpected()</a>, and <a class="el" href="../../dc/dc0/a03087_source.html#l00075">WriteLog</a>.</p>
<div class="fragment"><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> seed;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="comment">// VFALCO TODO Replace this with beast::Random</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        RAND_pseudo_bytes (reinterpret_cast&lt;unsigned char*&gt; (&amp;seed), <span class="keyword">sizeof</span> (seed));</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        srand (seed);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <a class="code" href="../../d9/d9d/a03417.html#a56425646d607792a762d96287c2a6e23">FullBelowCache</a> fullBelowCache (<span class="stringliteral">&quot;test.full_below&quot;</span>,</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <a class="code" href="../../d9/d9d/a03417.html#abf0dafb6d882fc70b9b0f2d33974ed97">get_seconds_clock</a> ());</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        SHAMap source (<a class="code" href="../../d9/d9d/a03417.html#a5d9fe757c37a7602a883d30b14e1bf3ca2c0e11eb7110dec9796c4129412fd4d9">smtFREE</a>, fullBelowCache);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        SHAMap destination (<a class="code" href="../../d9/d9d/a03417.html#a5d9fe757c37a7602a883d30b14e1bf3ca2c0e11eb7110dec9796c4129412fd4d9">smtFREE</a>, fullBelowCache);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keywordtype">int</span> items = 10000;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; items; ++i)</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            source.addItem (*<a class="code" href="../../d2/dff/a01374.html#a42c4ced1602649a465695aaefccef24b">makeRandomAS</a> (), <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <a class="code" href="../../db/dfd/a01608.html#a83dda01dd12e6a769717874095d928b4">unexpected</a> (!<a class="code" href="../../d2/dff/a01374.html#a4980e73f9977797e9a455330fb52debe">confuseMap</a> (source, 500), <span class="stringliteral">&quot;ConfuseMap&quot;</span>);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        source.setImmutable ();</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        std::vector&lt;SHAMapNode&gt; nodeIDs, gotNodeIDs;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        std::list&lt; Blob &gt; gotNodes;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        std::vector&lt;uint256&gt; hashes;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        std::vector&lt;SHAMapNode&gt;::iterator nodeIDIterator;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        std::list&lt; Blob &gt;::iterator rawNodeIterator;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="keywordtype">int</span> passes = 0;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="keywordtype">int</span> nodes = 0;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        destination.setSynching ();</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <a class="code" href="../../db/dfd/a01608.html#a83dda01dd12e6a769717874095d928b4">unexpected</a> (!source.getNodeFat (SHAMapNode (), nodeIDs, gotNodes, (<a class="code" href="../../d6/d50/a02694.html#a2391b9dab13f09bae65ae349c8d4c271">rand</a> () % 2) == 0, (<a class="code" href="../../d6/d50/a02694.html#a2391b9dab13f09bae65ae349c8d4c271">rand</a> () % 2) == 0),</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="stringliteral">&quot;GetNodeFat&quot;</span>);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <a class="code" href="../../db/dfd/a01608.html#a83dda01dd12e6a769717874095d928b4">unexpected</a> (gotNodes.size () &lt; 1, <span class="stringliteral">&quot;NodeSize&quot;</span>);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <a class="code" href="../../db/dfd/a01608.html#a83dda01dd12e6a769717874095d928b4">unexpected</a> (!destination.addRootNode (*gotNodes.begin (), <a class="code" href="../../d9/d9d/a03417.html#ac8683dfc227ea8c196fc4e4f2080e36da82251cdf5d561efb6b1838672e116253">snfWIRE</a>, <span class="keyword">nullptr</span>).isGood(), <span class="stringliteral">&quot;AddRootNode&quot;</span>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        nodeIDs.clear ();</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        gotNodes.clear ();</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="preprocessor">#ifdef SMS_DEBUG</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="preprocessor"></span>        <span class="keywordtype">int</span> bytes = 0;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">do</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            ++passes;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            hashes.clear ();</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="comment">// get the list of nodes we know we need</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            destination.getMissingNodes (nodeIDs, hashes, 2048, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="keywordflow">if</span> (nodeIDs.empty ()) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="comment">// get as many nodes as possible based on this information</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="keywordflow">for</span> (nodeIDIterator = nodeIDs.begin (); nodeIDIterator != nodeIDs.end (); ++nodeIDIterator)</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                <span class="keywordflow">if</span> (!source.getNodeFat (*nodeIDIterator, gotNodeIDs, gotNodes, (<a class="code" href="../../d6/d50/a02694.html#a2391b9dab13f09bae65ae349c8d4c271">rand</a> () % 2) == 0, (<a class="code" href="../../d6/d50/a02694.html#a2391b9dab13f09bae65ae349c8d4c271">rand</a> () % 2) == 0))</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    <a class="code" href="../../dc/dc0/a03087.html#a5308b5072b82addfc9132f3aa5d0e45f">WriteLog</a> (<a class="code" href="../../d9/d9d/a03417.html#afc7159a6877417e38472fbbd425f2244acb980b97f93585b5b1f20725a2256c23">lsFATAL</a>, SHAMap) &lt;&lt; <span class="stringliteral">&quot;GetNodeFat fails&quot;</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                    <a class="code" href="../../db/dfd/a01608.html#a12ac06a598408212221270d1d8cbdd4e">fail</a> (<span class="stringliteral">&quot;GetNodeFat&quot;</span>);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                    <a class="code" href="../../db/dfd/a01608.html#ac9062ee09b5c077d08e6ab2ae4f72f83">pass</a> ();</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            assert (gotNodeIDs.size () == gotNodes.size ());</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            nodeIDs.clear ();</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            hashes.clear ();</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            <span class="keywordflow">if</span> (gotNodeIDs.empty ())</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                <a class="code" href="../../db/dfd/a01608.html#a12ac06a598408212221270d1d8cbdd4e">fail</a> (<span class="stringliteral">&quot;Got Node ID&quot;</span>);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                <a class="code" href="../../db/dfd/a01608.html#ac9062ee09b5c077d08e6ab2ae4f72f83">pass</a> ();</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            <span class="keywordflow">for</span> (nodeIDIterator = gotNodeIDs.begin (), rawNodeIterator = gotNodes.begin ();</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                    nodeIDIterator != gotNodeIDs.end (); ++nodeIDIterator, ++rawNodeIterator)</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                ++nodes;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="preprocessor">#ifdef SMS_DEBUG</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="preprocessor"></span>                bytes += rawNodeIterator-&gt;size ();</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                <span class="keywordflow">if</span> (!destination.addKnownNode (*nodeIDIterator, *rawNodeIterator, <span class="keyword">nullptr</span>).isGood ())</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                    <a class="code" href="../../dc/dc0/a03087.html#a5308b5072b82addfc9132f3aa5d0e45f">WriteLog</a> (<a class="code" href="../../d9/d9d/a03417.html#afc7159a6877417e38472fbbd425f2244a994075b2b57b391e5ba833769ac13487">lsTRACE</a>, SHAMap) &lt;&lt; <span class="stringliteral">&quot;AddKnownNode fails&quot;</span>;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                    <a class="code" href="../../db/dfd/a01608.html#a12ac06a598408212221270d1d8cbdd4e">fail</a> (<span class="stringliteral">&quot;AddKnownNode&quot;</span>);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                }</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                    <a class="code" href="../../db/dfd/a01608.html#ac9062ee09b5c077d08e6ab2ae4f72f83">pass</a> ();</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                }</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            gotNodeIDs.clear ();</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            gotNodes.clear ();</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        destination.clearSynching ();</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="preprocessor">#ifdef SMS_DEBUG</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="preprocessor"></span>        <a class="code" href="../../dc/dc0/a03087.html#a5308b5072b82addfc9132f3aa5d0e45f">WriteLog</a> (<a class="code" href="../../d9/d9d/a03417.html#afc7159a6877417e38472fbbd425f2244a275905728c3e58efd16146a7e25c5df6">lsINFO</a>, SHAMap) &lt;&lt; <span class="stringliteral">&quot;SYNCHING COMPLETE &quot;</span> &lt;&lt; items &lt;&lt; <span class="stringliteral">&quot; items, &quot;</span> &lt;&lt; nodes &lt;&lt; <span class="stringliteral">&quot; nodes, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                  bytes / 1024 &lt;&lt; <span class="stringliteral">&quot; KB&quot;</span>;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordflow">if</span> (!source.deepCompare (destination))</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            <a class="code" href="../../db/dfd/a01608.html#a12ac06a598408212221270d1d8cbdd4e">fail</a> (<span class="stringliteral">&quot;Deep Compare&quot;</span>);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <a class="code" href="../../db/dfd/a01608.html#ac9062ee09b5c077d08e6ab2ae4f72f83">pass</a> ();</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="preprocessor">#ifdef SMS_DEBUG</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="preprocessor"></span>        <a class="code" href="../../dc/dc0/a03087.html#a5308b5072b82addfc9132f3aa5d0e45f">WriteLog</a> (<a class="code" href="../../d9/d9d/a03417.html#afc7159a6877417e38472fbbd425f2244a275905728c3e58efd16146a7e25c5df6">lsINFO</a>, SHAMap) &lt;&lt; <span class="stringliteral">&quot;SHAMapSync test passed: &quot;</span> &lt;&lt; items &lt;&lt; <span class="stringliteral">&quot; items, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                                  passes &lt;&lt; <span class="stringliteral">&quot; passes, &quot;</span> &lt;&lt; nodes &lt;&lt; <span class="stringliteral">&quot; nodes&quot;</span>;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="preprocessor"></span>    }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/dff/a01374_a5ba8e3ec0d8dca936347a2d58b235116_cgraph.png" border="0" usemap="#d2/dff/a01374_a5ba8e3ec0d8dca936347a2d58b235116_cgraph" alt=""/></div>
<map name="d2/dff/a01374_a5ba8e3ec0d8dca936347a2d58b235116_cgraph" id="d2/dff/a01374_a5ba8e3ec0d8dca936347a2d58b235116_cgraph">
<area shape="rect" id="node3" href="../../d6/dfe/a01366.html#a680c64ea3a24815047908a6838e68452" title="ripple::SHAMap::addItem" alt="" coords="493,1064,661,1093"/><area shape="rect" id="node5" href="../../d6/dfe/a01366.html#a2de227a899b0d7e060b00fae68c20f02" title="ripple::SHAMap::addKnownNode" alt="" coords="199,483,412,512"/><area shape="rect" id="node37" href="../../d6/dfe/a01366.html#a4f32a28743da6b0f9754355ee934e69b" title="ripple::SHAMap::addRootNode" alt="" coords="204,776,407,805"/><area shape="rect" id="node39" href="../../d6/dfe/a01366.html#a5ae13bc823d7e3cbdc4d784a04f29edb" title="ripple::SHAMap::clearSynching" alt="" coords="476,1011,679,1040"/><area shape="rect" id="node47" href="../../d2/dff/a01374.html#a4980e73f9977797e9a455330fb52debe" title="ripple::SHAMapSync\l_test::confuseMap" alt="" coords="233,1162,377,1209"/><area shape="rect" id="node54" href="../../d2/dff/a01374.html#a42c4ced1602649a465695aaefccef24b" title="ripple::SHAMapSync\l_test::makeRandomAS" alt="" coords="499,1223,656,1270"/><area shape="rect" id="node56" href="../../d6/dfe/a01366.html#a64f55321e12299c56e80486e17d8cf91" title="ripple::SHAMap::deepCompare" alt="" coords="204,205,407,235"/><area shape="rect" id="node61" href="../../db/dfd/a01608.html#a12ac06a598408212221270d1d8cbdd4e" title="beast::unit_test::suite\l::fail" alt="" coords="504,2293,651,2339"/><area shape="rect" id="node65" href="../../d9/d9d/a03417.html#abf0dafb6d882fc70b9b0f2d33974ed97" title="ripple::get_seconds\l_clock" alt="" coords="239,1658,372,1705"/><area shape="rect" id="node67" href="../../d6/dfe/a01366.html#a3115ce394446e0e2dc1edacb3fa43bc2" title="ripple::SHAMap::getMissing\lNodes" alt="" coords="213,1589,397,1635"/><area shape="rect" id="node102" href="../../d6/dfe/a01366.html#ada98c0e06bc5b129154a4968b2a94ca3" title="ripple::SHAMap::getNodeFat" alt="" coords="211,1941,400,1971"/><area shape="rect" id="node114" href="../../dd/d0c/a01368.html#aeea6bf66b2738ce49762b3b2cc381e35" title="ripple::SHAMapAddNode\l::isGood" alt="" coords="221,2045,389,2091"/><area shape="rect" id="node117" href="../../db/dfd/a01608.html#ac9062ee09b5c077d08e6ab2ae4f72f83" title="beast::unit_test::suite\l::pass" alt="" coords="504,2362,651,2409"/><area shape="rect" id="node119" href="../../d6/dfe/a01366.html#a5c233c58f744565df9d65b6189e42741" title="ripple::SHAMap::setImmutable" alt="" coords="205,2184,405,2213"/><area shape="rect" id="node121" href="../../d6/dfe/a01366.html#ac947f8afc3f3327f2ccef35be5e6f419" title="ripple::SHAMap::setSynching" alt="" coords="208,2237,403,2267"/><area shape="rect" id="node123" href="../../db/dfd/a01608.html#a83dda01dd12e6a769717874095d928b4" title="beast::unit_test::suite\l::unexpected" alt="" coords="232,2114,379,2161"/><area shape="rect" id="node7" href="../../da/d61/a01350.html#a8d8774ca938809be8323d3957a62af90" title="ripple::Serializer\l::addRaw" alt="" coords="771,1751,885,1798"/><area shape="rect" id="node9" href="../../d6/dfe/a01366.html#a0cbc90c0f285837e3bd46dc97ee4b3ad" title="ripple::SHAMap::canonicalize" alt="" coords="480,59,675,88"/><area shape="rect" id="node11" href="../../d6/dfe/a01366.html#a98e2166ebf9e9f07a511c74a00652a49" title="ripple::SHAMap::checkCacheNode" alt="" coords="464,112,691,141"/><area shape="rect" id="node13" href="../../dd/d0c/a01368.html#aaf82bb25d47056d0704304c70d79ec28" title="ripple::SHAMapAddNode\l::duplicate" alt="" coords="493,767,661,814"/><area shape="rect" id="node15" href="../../df/d0b/a01372.html#ae6c4d02a3c9cd7ae9363dafc13e74f59" title="ripple::SHAMapNode\l::getDepth" alt="" coords="505,266,649,313"/><area shape="rect" id="node17" href="../../df/d0b/a01372.html#a4f1066002c946341252cced06ad46ef3" title="ripple::SHAMapNode\l::getNodeID" alt="" coords="756,77,900,123"/><area shape="rect" id="node19" href="../../d6/dfe/a01366.html#ad90655d2e3a0623bf196e0bee9da8371" title="ripple::SHAMap::getNodePointerNT" alt="" coords="463,957,692,987"/><area shape="rect" id="node21" href="../../df/d0b/a01372.html#a59b0646070ce1e3cca5f01eda39da922" title="ripple::SHAMapNode\l::getParentNodeID" alt="" coords="505,335,649,382"/><area shape="rect" id="node23" href="../../d5/df5/a01375.html#a46f1e131e27721a7184b846f2b4ae677" title="ripple::SHAMapSyncFilter\l::gotNode" alt="" coords="741,827,915,874"/><area shape="rect" id="node25" href="../../dd/d0c/a01368.html#a3dc682b7185ec0834398b3aa2b2d0034" title="ripple::SHAMapAddNode\l::invalid" alt="" coords="493,559,661,606"/><area shape="rect" id="node27" href="../../df/d0b/a01372.html#a4b5400b19294466b4f910657b482e744" title="ripple::SHAMapNode\l::isRoot" alt="" coords="756,1345,900,1391"/><area shape="rect" id="node29" href="../../d6/dfe/a01366.html#a050a4f2f37af8082474d6f9c9555d59b" title="ripple::SHAMap::isSynching" alt="" coords="484,405,671,435"/><area shape="rect" id="node31" href="../../da/d61/a01350.html#a6d7436e5990cb278bd924cef9396df3c" title="ripple::Serializer\l::modData" alt="" coords="520,629,635,675"/><area shape="rect" id="node33" href="../../dc/de6/a00167.html#aff1d832db016f51e040b07a8a6dd3bbd" title="ripple::RadMap::BasicFull\lBelowCache::touch_if_exists" alt="" coords="481,887,673,934"/><area shape="rect" id="node35" href="../../dd/d0c/a01368.html#a180f6dbffb287cdafd5d36c43919af7d" title="ripple::SHAMapAddNode\l::useful" alt="" coords="493,698,661,745"/><area shape="rect" id="node50" href="../../d6/dfe/a01366.html#ad34b4b3f4c26154a0ad8e63ada075f88" title="ripple::SHAMap::delItem" alt="" coords="495,1117,660,1147"/><area shape="rect" id="node52" href="../../d6/dfe/a01366.html#aae2210273f3f0f8fb068ad523d600b86" title="ripple::SHAMap::getHash" alt="" coords="492,1171,663,1200"/><area shape="rect" id="node58" href="../../d6/dfe/a01366.html#ab44995f9dd91e5d24860ad9ccda98729" title="ripple::SHAMap::getNode" alt="" coords="492,5,663,35"/><area shape="rect" id="node63" href="../../d2/d4c/a01307.html#a03beb6cc1779c37cff6bceae09ed58c9" title="beast::unit_test::runner\l::fail" alt="" coords="751,2293,905,2339"/><area shape="rect" id="node70" href="../../d9/d9d/a03417.html#a41dc315618e2f1d4be04cf094a642d70" title="ripple::getApp" alt="" coords="777,1292,879,1321"/><area shape="rect" id="node72" href="../../d2/d29/a01376.html#a44658fad4f17cd9cdf0f53d494e94e2e" title="ripple::SHAMapTreeNode\l::getChildHash" alt="" coords="492,1933,663,1979"/><area shape="rect" id="node74" href="../../df/d0b/a01372.html#a8f51c844496d936607d65fe24f37e892" title="ripple::SHAMapNode\l::getChildNodeID" alt="" coords="505,2002,649,2049"/><area shape="rect" id="node76" href="../../dd/dcb/a00375.html#a0fb091e51bd36690e0652565a54802e9" title="ripple::NodeStore::\lDatabase::getDesiredAsyncRead\lCount" alt="" coords="469,1397,685,1461"/><area shape="rect" id="node78" href="../../d6/dfe/a01366.html#a1e6e846eeafeff5bb8ef776b8ce494d3" title="ripple::SHAMap::getNodeAsync" alt="" coords="473,1344,681,1373"/><area shape="rect" id="node81" href="../../da/d74/a00099.html#a25c5851322f6cb3762563fd1278c6143" title="ripple::Application\l::getNodeStore" alt="" coords="765,1583,891,1630"/><area shape="rect" id="node85" href="../../d2/d29/a01376.html#a1432806ab9b074343c59a198225abf8b" title="ripple::SHAMapTreeNode\l::getNodeHash" alt="" coords="743,2015,913,2062"/><area shape="rect" id="node89" href="../../dc/de6/a00167.html#a08d45dafebaf38918fe40d0fbf9af559" title="ripple::RadMap::BasicFull\lBelowCache::insert" alt="" coords="492,1485,663,1531"/><area shape="rect" id="node91" href="../../d2/d29/a01376.html#a93890c731f643c17964c498d9913dace" title="ripple::SHAMapTreeNode\l::isEmptyBranch" alt="" coords="743,2182,913,2229"/><area shape="rect" id="node93" href="../../d2/d29/a01376.html#a23f6e6db9f089ca8fda7ec78f0f69b21" title="ripple::SHAMapTreeNode\l::isFullBelow" alt="" coords="492,1554,663,1601"/><area shape="rect" id="node95" href="../../d2/d29/a01376.html#aa842f2f1377b1a2d7433b47beb04829f" title="ripple::SHAMapTreeNode\l::isInner" alt="" coords="492,1863,663,1910"/><area shape="rect" id="node97" href="../../d2/d29/a01376.html#a4718b7ddf70a7909ece8f915615191c9" title="ripple::SHAMapTreeNode\l::setFullBelow" alt="" coords="492,1623,663,1670"/><area shape="rect" id="node100" href="../../dd/dcb/a00375.html#a539d10a0f85deee16c500f4e57fa9648" title="ripple::NodeStore::\lDatabase::waitReads" alt="" coords="504,1693,651,1739"/><area shape="rect" id="node104" href="../../d2/d29/a01376.html#a23af11605070a49ab9e2f8460b43016f" title="ripple::SHAMapTreeNode\l::addRaw" alt="" coords="492,2122,663,2169"/></map>
</div>
</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>rippled/src/ripple_app/shamap/<a class="el" href="../../d5/d7f/a03036_source.html">SHAMapSync.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d9/d9d/a03417.html">ripple</a></li><li class="navelem"><a class="el" href="../../d2/dff/a01374.html">SHAMapSync_test</a></li>
    <li class="footer">Generated on Fri May 2 2014 05:29:13 for rippled by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
